!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Hackle={})}(this,(function(t){"use strict";var e=function(){function t(){}return t.isNotNullOrUndefined=function(t){return null!=t},t.isNullOrUndefined=function(t){return null==t},t.requiredNotNullOrUndefined=function(t,e){if(void 0===e&&(e=function(){return"Required value is null or undefined"}),this.isNullOrUndefined(t))throw new Error(e());return t},t.fromMap=function(t){var e={};return t.forEach((function(t,r){e[r]=t})),e},t}(),r=function(){function t(){}return t.mapNotNullOrUndefined=function(t,r){for(var n=Array(),i=0,o=t;i<o.length;i++){var s=r(o[i]);e.isNotNullOrUndefined(s)&&n.push(s)}return n},t.mapOrUndefined=function(t,r){for(var n=Array(),i=0,o=t;i<o.length;i++){var s=r(o[i]);if(e.isNullOrUndefined(s))return;n.push(s)}return n},t.associateTo=function(t,e,r){for(var n=0,i=t;n<i.length;n++){var o=r(i[n]);e.set(o[0],o[1])}return e},t.associate=function(t,e){return this.associateTo(t,new Map,e)},t.associateBy=function(t,e){return this.associate(t,(function(t){return[e(t),t]}))},t.chunked=function(t,e){for(var r=[],n=t.slice();n.length;)r.push(n.splice(0,e));return r},t}(),n={DISABLE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},i=function(){function t(){}return t.setLogLevel=function(t){void 0===t&&(t=n.INFO),this.logLevel=t},t.initCounter=function(t){this.counters=r.associate(Object.keys(n),(function(e){return[e,t(e)]}))},t._log=function(t,e){var r;switch(t){case"WARN":r="orange";break;case"ERROR":r="red";break;default:r="#AAAAAA"}if(e instanceof Error)o.log(t,r,e.message,e);else try{o.log(t,r,e)}catch(t){}},t.increment=function(e){var r,n;null===(n=null===(r=t.counters)||void 0===r?void 0:r.get(e))||void 0===n||n.increment()},t.logLevel=n.INFO,t.log={error:function(e){t.logLevel>=n.ERROR&&(t._log("ERROR",e),t.increment("ERROR"))},warn:function(e){t.logLevel>=n.WARN&&(t._log("WARN",e),t.increment("WARN"))},info:function(e){t.logLevel>=n.INFO&&(t._log("INFO",e),t.increment("INFO"))},debug:function(e){t.logLevel>=n.DEBUG&&(t._log("DEBUG",e),t.increment("DEBUG"))}},t}(),o=function(){function t(){}return t.log=function(t,e,r,n){try{console.log("%c[".concat(t,"] Hackle: ").concat(r),"color: ".concat(e))}catch(t){}},t}(),s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},s(t,e)};function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var a=function(){return a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},a.apply(this,arguments)};function c(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,u)}a((n=n.apply(t,e||[])).next())}))}function f(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function p(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var l=i.log,h=function(){function t(){}return t.isEqual=function(t,e){return t.type===e.type&&t.value===e.value},t.isEquals=function(t,e){if(null==e)return!1;var r=Object.keys(t);return r.length===Object.keys(e).length&&r.every((function(r){return t[r]===e[r]}))},t.sanitize=function(t){var r={};if(e.isNullOrUndefined(t))return r;for(var n=0,i=Object.entries(t);n<i.length;n++){var o=i[n],s=o[0],u=o[1];if(this.isValidType(s)){var a=this.sanitizeValue(u);e.isNullOrUndefined(a)?l.debug("Invalid identifier value. The identifier type value be a string of 512 characters or less. [".concat(s,"]")):r[s]=a}else l.debug("Invalid identifier type. The identifier type must be a string of 128 characters or less. [".concat(s,"]"))}return r},t.isValidType=function(t){return!e.isNullOrUndefined(t)&&("string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_TYPE_LENGTH)},t.sanitizeValue=function(t){return"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_VALUE_LENGTH?t:"number"==typeof t?t.toString():null},t.MAX_IDENTIFIER_TYPE_LENGTH=128,t.MAX_IDENTIFIER_VALUE_LENGTH=512,t}(),d=i.log,v=function(){function t(){}return t.sanitize=function(t){var r={};if(e.isNullOrUndefined(t))return r;for(var n=0,i=Object.entries(t);n<i.length;n++){var o=i[n],s=o[0],u=o[1];if(Object.keys(r).length>=this.MAX_PROPERTIES_COUNT){d.debug("The number of properties cannot exceed 128. Drops excess properties. [".concat(s,", ").concat(u,"]"));break}if(this.isValidKey(s)){var a=this.sanitizeValue(s,u);e.isNullOrUndefined(a)?d.debug("Invalid property value. The property value mus be 'string(..1024)', 'number', 'boolean', or 'array' type. [".concat(u,"]")):r[s]=a}else d.debug("Invalid property key. The property key must be a string of 128 characters or less. [".concat(s,"]"))}return r},t.isValidProperty=function(t,e){return this.isValidKey(t)&&this.isValidValue(e)},t.isValidKey=function(t){return e.isNotNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_PROPERTY_KEY_LENGTH},t.sanitizeValue=function(t,e){var r=this;return"string"==typeof t&&t.startsWith(this.SYSTEM_PROPERTY_KEY_PREFIX)?e:this.isValidValue(e)?Array.isArray(e)?e.filter((function(t){return r.isValidElement(t)})):e:null},t.isValidValue=function(t){return!e.isNullOrUndefined(t)&&("string"==typeof t?t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t?!isNaN(t)&&isFinite(t):"boolean"==typeof t||Array.isArray(t))},t.isValidElement=function(t){return!e.isNullOrUndefined(t)&&("string"==typeof t?t.length>0&&t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t)},t.truncateStringValue=function(t){return"string"==typeof t&&t.length>this.MAX_PROPERTY_VALUE_LENGTH?t.slice(0,this.MAX_PROPERTY_VALUE_LENGTH):t},t.SYSTEM_PROPERTY_KEY_PREFIX="$",t.MAX_PROPERTIES_COUNT=128,t.MAX_PROPERTY_KEY_LENGTH=128,t.MAX_PROPERTY_VALUE_LENGTH=1024,t}(),y=["nanoseconds","microseconds","milliseconds","seconds","minutes","hours","days"],g=function(){function t(){}return t.nanosToUnit=function(e,r){switch(r){case"nanoseconds":return e;case"microseconds":return e/(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C0);case"seconds":return e/(t.C3/t.C0);case"minutes":return e/(t.C4/t.C0);case"hours":return e/(t.C5/t.C0);case"days":return e/(t.C6/t.C0)}},t.microsToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C1);case"microseconds":return e;case"seconds":return e/(t.C3/t.C1);case"minutes":return e/(t.C4/t.C1);case"hours":return e/(t.C5/t.C1);case"days":return e/(t.C6/t.C1)}},t.millisToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C2/t.C0);case"microseconds":return e*(t.C2/t.C1);case"milliseconds":return e;case"seconds":return e/(t.C3/t.C2);case"minutes":return e/(t.C4/t.C2);case"hours":return e/(t.C5/t.C2);case"days":return e/(t.C6/t.C2)}},t.secondsToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C3/t.C0);case"microseconds":return e*(t.C3/t.C1);case"milliseconds":return e*(t.C3/t.C2);case"seconds":return e;case"minutes":return e/(t.C4/t.C3);case"hours":return e/(t.C5/t.C3);case"days":return e/(t.C6/t.C3)}},t.minutesToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C4/t.C0);case"microseconds":return e*(t.C4/t.C1);case"milliseconds":return e*(t.C4/t.C2);case"seconds":return e*(t.C4/t.C3);case"minutes":return e;case"hours":return e/(t.C5/t.C4);case"days":return e/(t.C6/t.C4)}},t.hoursToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C5/t.C0);case"microseconds":return e*(t.C5/t.C1);case"milliseconds":return e*(t.C5/t.C2);case"seconds":return e*(t.C5/t.C3);case"minutes":return e*(t.C5/t.C4);case"hours":return e;case"days":return e/(t.C6/t.C5)}},t.daysToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C6/t.C0);case"microseconds":return e*(t.C6/t.C1);case"milliseconds":return e*(t.C6/t.C2);case"seconds":return e*(t.C6/t.C3);case"minutes":return e*(t.C6/t.C4);case"hours":return e*(t.C6/t.C5);case"days":return e}},t.C0=1,t.C1=1e3*t.C0,t.C2=1e3*t.C1,t.C3=1e3*t.C2,t.C4=60*t.C3,t.C5=60*t.C4,t.C6=24*t.C5,t.converter={nanoseconds:t.nanosToUnit,microseconds:t.microsToUnit,milliseconds:t.millisToUnit,seconds:t.secondsToUnit,minutes:t.minutesToUnit,hours:t.hoursToUnit,days:t.daysToUnit},t}(),m=function(){function t(){}return t.prototype.tick=function(){return 1e3*Date.now()},t.prototype.currentMillis=function(){return Date.now()},t.instance=new t,t}(),E=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),w=function(){function t(t){this.parameters=t}return t.prototype.get=function(t,r){var n=this.parameters.get(t);return e.isNullOrUndefined(n)?r:e.isNullOrUndefined(r)||typeof n==typeof r?n:r},t}(),T=i.log;function I(t,e){var r=t.find((function(t){return t===e||t.toLowerCase()===e.toLowerCase()}));return r||T.debug("Unsupported type [".concat(e,"]. Please use the latest version of sdk.")),r}function _(t,r){if(!e.isNullOrUndefined(r)){for(var n=new Array,i=0,o=r;i<o.length;i++){var s=I(t,o[i]);if(e.isNullOrUndefined(s))return;n.push(s)}return n}}var A=function(){function t(t,e){this.value=t,this.reason=e}return t.of=function(e,r){return new t(e,r)},t}(),b=function(){function t(t,e,r,n){this.inAppMessage=t,this.message=e,this.reason=r,this.properties=n}return t.prototype.isShow=function(){return e.isNotNullOrUndefined(this.inAppMessage)&&e.isNotNullOrUndefined(this.message)},t.of=function(e,r,n,i){return void 0===i&&(i={}),new t(r,n,e,i)},t}(),N=function(){function t(t,e,r,n){this.variation=t,this.reason=e,this.config=r,this.experiment=n}return t.of=function(e,r,n,i){return void 0===n&&(n=new E),void 0===i&&(i=void 0),new t(e,r,n,i)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),O=function(){function t(t,e,r,n){this.isOn=t,this.reason=e,this.config=r,this.experiment=n}return t.on=function(e,r,n){return void 0===r&&(r=new E),void 0===n&&(n=void 0),new t(!0,e,r,n)},t.off=function(e,r,n){return void 0===r&&(r=new E),void 0===n&&(n=void 0),new t(!1,e,r,n)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),R=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),M=function(){function t(t,e){this.id=t,this.config=e}return t.fromJson=function(e){return new t(e.id,new w(r.associate(e.parameters,(function(t){return[t.key,t.value]}))))},t.prototype.get=function(t,e){switch(typeof e){case"string":case"number":case"boolean":return this.config.get(t,e);default:return e}},t}(),S=function(){function t(){}return t.SDK_NOT_READY="SDK_NOT_READY",t.EXCEPTION="EXCEPTION",t.INVALID_INPUT="INVALID_INPUT",t.UNSUPPORTED_PLATFORM="UNSUPPORTED_PLATFORM",t.TYPE_MISMATCH="TYPE_MISMATCH",t.EXPERIMENT_NOT_FOUND="EXPERIMENT_NOT_FOUND",t.EXPERIMENT_DRAFT="EXPERIMENT_DRAFT",t.EXPERIMENT_PAUSED="EXPERIMENT_PAUSED",t.EXPERIMENT_COMPLETED="EXPERIMENT_COMPLETED",t.OVERRIDDEN="OVERRIDDEN",t.TRAFFIC_NOT_ALLOCATED="TRAFFIC_NOT_ALLOCATED",t.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT="NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT",t.IDENTIFIER_NOT_FOUND="IDENTIFIER_NOT_FOUND",t.VARIATION_DROPPED="VARIATION_DROPPED",t.TRAFFIC_ALLOCATED="TRAFFIC_ALLOCATED",t.TRAFFIC_ALLOCATED_BY_TARGETING="TRAFFIC_ALLOCATED_BY_TARGETING",t.NOT_IN_EXPERIMENT_TARGET="NOT_IN_EXPERIMENT_TARGET",t.FEATURE_FLAG_NOT_FOUND="FEATURE_FLAG_NOT_FOUND",t.FEATURE_FLAG_INACTIVE="FEATURE_FLAG_INACTIVE",t.INDIVIDUAL_TARGET_MATCH="INDIVIDUAL_TARGET_MATCH",t.TARGET_RULE_MATCH="TARGET_RULE_MATCH",t.DEFAULT_RULE="DEFAULT_RULE",t.REMOTE_CONFIG_PARAMETER_NOT_FOUND="REMOTE_CONFIG_PARAMETER_NOT_FOUND",t.IN_APP_MESSAGE_NOT_FOUND="IN_APP_MESSAGE_NOT_FOUND",t.IN_APP_MESSAGE_DRAFT="IN_APP_MESSAGE_DRAFT",t.IN_APP_MESSAGE_PAUSED="IN_APP_MESSAGE_PAUSED",t.IN_APP_MESSAGE_HIDDEN="IN_APP_MESSAGE_HIDDEN",t.IN_APP_MESSAGE_TARGET="IN_APP_MESSAGE_TARGET",t.NOT_IN_IN_APP_MESSAGE_PERIOD="NOT_IN_IN_APP_MESSAGE_PERIOD",t.NOT_IN_IN_APP_MESSAGE_TARGET="NOT_IN_IN_APP_MESSAGE_TARGET",t}(),C=["DEFAULT","SPLIT_URL","IN_APP_MESSAGE"],x=function(){function t(t,e,r,n,i,o,s,u,a,c,f,p,l,h,d,v,y){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.status=i,this.version=o,this.executionVersion=s,this.variations=u,this.userOverrides=a,this.segmentOverrides=c,this.targetAudiences=f,this.splitUrlTargets=p,this.targetRules=l,this.defaultRule=h,this.containerId=d,this.implementationType=v,this.winnerVariationId=y}return t.fromJson=function(e,n){var i=t.experimentStatusOrNull(n.execution.status),o=n.variations.map((function(t){return new U(t.id,t.key,"DROPPED"===t.status,t.parameterConfigurationId)})),s=r.associate(n.execution.userOverrides,(function(t){return[t.userId,t.variationId]})),u=r.mapNotNullOrUndefined(n.execution.segmentOverrides,(function(t){return J.fromJson(t,ct.IDENTIFIER)})),a=r.mapNotNullOrUndefined(n.execution.targetAudiences,(function(t){return j.fromJson(t,ct.PROPERTY)})),c=Jt.fromJson(n.execution.targetUrls),f=I(C,n.implementationType),p=r.mapNotNullOrUndefined(n.execution.targetRules,(function(t){return J.fromJson(t,ct.PROPERTY)})),l=K.fromJson(n.execution.defaultRule);return i&&f&&l&&new t(n.id,n.key,e,n.identifierType,i,n.version,n.execution.version,o,s,u,a,c,p,l,n.containerId,f,n.winnerVariationId)},t.experimentStatusOrNull=function(t){switch(t){case"READY":return"DRAFT";case"RUNNING":return"RUNNING";case"PAUSED":return"PAUSED";case"STOPPED":return"COMPLETED";default:return void T.debug("Unsupported status [".concat(t,"]"))}},t.prototype._winnerVariationOrNull=function(){if(this.winnerVariationId)return this._getVariationByIdOrNull(this.winnerVariationId)},t.prototype._getVariationByIdOrNull=function(t){return this.variations.find((function(e){return e.id===t}))},t.prototype._getVariationByKeyOrNull=function(t){return this.variations.find((function(e){return e.key===t}))},t}(),U=function(t,e,r,n){this.id=t,this.key=e,this.isDropped=r,this.parameterConfigurationId=n},P=function(){function t(t,e,r,n){this.id=t,this.seed=e,this.slotSize=r,this.slots=n}return t.fromJson=function(e){return new t(e.id,e.seed,e.slotSize,e.slots.map((function(t){var e=t.startInclusive,r=t.endExclusive,n=t.variationId;return new k(e,r,n)})))},t}(),k=function(){function t(t,e,r){this.startInclusive=t,this.endExclusive=e,this.variationId=r}return t.prototype.contains=function(t){return this.startInclusive<=t&&t<this.endExclusive},t}(),D=function(){function t(t,e){this.id=t,this.key=e}return t.fromJson=function(e){return new t(e.id,e.key)},t}(),L=function(){function t(){}return t.ID="$id",t.USER="$userId",t.DEVICE="$deviceId",t.SESSION="$sessionId",t.HACKLE_DEVICE="$hackleDeviceId",t}(),F=function(t){var r=new V;return r.addIdentifiers(t.identifiers||{}),r.add(L.ID,t.id),r.add(L.DEVICE,t.deviceId),e.isNotNullOrUndefined(t.userId)&&r.add(L.USER,t.userId),r.build()},V=function(){function t(){this.identifiers={}}return t.prototype.addIdentifiers=function(t){for(var e in t)this.add(e,t[e]);return this},t.prototype.add=function(t,e){var r=h.sanitizeValue(e);return h.isValidType(t)&&r?this.identifiers[t]=e:T.warn("Invalid user identifier [type=".concat(t,", value=").concat(e,"]")),this},t.prototype.build=function(){return this.identifiers},t}(),G=function(t){var e,r,n,i={};return i.id=null!==(e=h.sanitizeValue(t.id))&&void 0!==e?e:void 0,i.userId=null!==(r=h.sanitizeValue(t.userId))&&void 0!==r?r:void 0,i.deviceId=null!==(n=h.sanitizeValue(t.deviceId))&&void 0!==n?n:void 0,"object"==typeof t.properties&&(i.properties=v.sanitize(t.properties)),"object"==typeof t.identifiers&&(i.identifiers=h.sanitize(t.identifiers)),function(t){return Boolean(t.id||t.userId||t.deviceId||t.identifiers&&Object.keys(t.identifiers).length>0)}(i)?i:null},j=function(){function t(t){this.conditions=t}return t.fromJson=function(e,n){return new t(r.mapNotNullOrUndefined(e.conditions,(function(t){return H.fromJson(t,n)})))},t.prototype.toJson=function(){return{conditions:this.conditions.map((function(t){return t.toJson()}))}},t}(),H=function(){function t(t,e){this.key=t,this.match=e}return t.fromJson=function(e,r){var n=B.fromJson(e.key);if(n&&r.supports(n.type)){var i=z.fromJson(e.match);return i&&new t(n,i)}},t.prototype.toJson=function(){return{key:this.key.toJson(),match:this.match.toJson()}},t}(),B=function(){function t(t,e){this.type=t,this.name=e}return t.fromJson=function(e){var r=I(ut,e.type);return r&&new t(r,e.name)},t.prototype.toJson=function(){return{type:this.type,name:this.name}},t}(),z=function(){function t(t,e,r,n){this.type=t,this.operator=e,this.valueType=r,this.values=n}return t.fromJson=function(e){var r=I(nt,e.type),n=I(ot,e.operator),i=I(it,e.valueType);return r&&n&&i&&new t(r,n,i,e.values)},t.prototype.toJson=function(){return{operator:this.operator,type:this.type,valueType:this.valueType,values:this.values}},t}(),K=function(){function t(t,e,r){this.type=t,this.variationId=e,this.bucketId=r}return t.fromJson=function(e){var r=I(st,e.type);return r&&new t(r,e.variationId,e.bucketId)},t}(),J=function(){function t(t,e){this.target=t,this.action=e}return t.fromJson=function(e,r){var n=j.fromJson(e.target,r),i=K.fromJson(e.action);return n&&i&&new t(n,i)},t}(),Y=function(){function t(t,e,r,n){this.id=t,this.key=e,this.type=r,this.targets=n}return t.fromJson=function(e){var n=I(at,e.type);return n&&new t(e.id,e.key,n,r.mapNotNullOrUndefined(e.targets,(function(t){return j.fromJson(t,ct.SEGMENT)})))},t}(),q=function(){function t(t,e,r){this.id=t,this.bucketId=e,this.groups=r}return t.fromJson=function(e){return new t(e.id,e.bucketId,e.groups.map((function(t){return X.fromJson(t)})))},t.prototype.getGroupOrNull=function(t){return this.groups.find((function(e){return e.id===t}))},t}(),X=function(){function t(t,e){this.id=t,this.experiments=e}return t.fromJson=function(e){return new t(e.id,e.experiments)},t}(),W=function(){function t(t,e,r,n,i,o){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.targetRules=i,this.defaultValue=o}return t.fromJson=function(e){var n=I(it,e.type),i=r.mapNotNullOrUndefined(e.targetRules,(function(t){return $.fromJson(t,ct.PROPERTY)})),o=Z.fromJson(e.defaultValue);return n&&new t(e.id,e.key,n,e.identifierType,i,o)},t}(),$=function(){function t(t,e,r,n,i){this.key=t,this.name=e,this.target=r,this.bucketId=n,this.value=i}return t.fromJson=function(e,r){var n=j.fromJson(e.target,r);return n&&new t(e.key,e.name,n,e.bucketId,Z.fromJson(e.value))},t}(),Z=function(){function t(t,e){this.id=t,this.rawValue=e}return t.fromJson=function(e){return new t(e.id,e.value)},t}();function Q(t,e){return t-e}var tt=function(){function t(t,e,r){this.coreVersion=t,this.prerelease=e,this.build=r}return t.tryParse=function(e){var r=t.regExp.exec(e);if(r){r[0];var n=r[1],i=r[2],o=void 0===i?"0":i,s=r[3],u=void 0===s?"0":s,a=r[4],c=r[5];return new t(new et(parseInt(n,10),parseInt(o,10),parseInt(u,10)),rt.parse(a),rt.parse(c))}},t.prototype.compareTo=function(t){return this.coreVersion.compareTo(t.coreVersion)||this.prerelease.compareTo(t.prerelease)},t.prototype.isEqualTo=function(t){return 0===this.compareTo(t)},t.prototype.isGreaterThan=function(t){return this.compareTo(t)>0},t.prototype.isGreaterThanOrEqualTo=function(t){return this.compareTo(t)>=0},t.prototype.isLessThan=function(t){return this.compareTo(t)<0},t.prototype.isLessThanOrEqualTo=function(t){return this.compareTo(t)<=0},t.regExp=/^(0|[1-9]\d*)(?:\.(0|[1-9]\d*))?(?:\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,t}(),et=function(){function t(t,e,r){this.major=t,this.minor=e,this.patch=r}return t.prototype.compareTo=function(t){return Q(this.major,t.major)||Q(this.minor,t.minor)||Q(this.patch,t.patch)},t}(),rt=function(){function t(t){this.identifiers=t}return t.parse=function(e){return e?new t(e.split(".")):t.EMPTY},t.prototype.isEmpty=function(){return 0===this.identifiers.length},t.prototype.isNotEmpty=function(){return!this.isEmpty()},t.prototype.compareTo=function(t){return this.isEmpty()&&t.isEmpty()?0:this.isEmpty()&&t.isNotEmpty()?1:this.isNotEmpty()&&t.isEmpty()?-1:this.compareIdentifiers(t)},t.prototype.compareIdentifiers=function(e){for(var r=Math.min(this.identifiers.length,e.identifiers.length),n=0;n<r;n++){var i=t.compareIdentifiers(this.identifiers[n],e.identifiers[n]);if(0!==i)return i}return Q(this.identifiers.length,e.identifiers.length)},t.compareIdentifiers=function(e,r){return t.numericIdentifierRegExp.test(e)&&t.numericIdentifierRegExp.test(r)?Q(+e,+r):e===r?0:e<r?-1:1},t.EMPTY=new t([]),t.numericIdentifierRegExp=/^(0|[1-9]\d*)$/,t}(),nt=["MATCH","NOT_MATCH"],it=["STRING","NUMBER","BOOLEAN","VERSION","JSON","URL","NULL","UNKNOWN"],ot=["IN","CONTAINS","STARTS_WITH","ENDS_WITH","GT","GTE","LT","LTE"],st=["VARIATION","BUCKET"],ut=["USER_ID","USER_PROPERTY","HACKLE_PROPERTY","SEGMENT","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY","COHORT"],at=["USER_ID","USER_PROPERTY"],ct=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.supportedKeyTypes=t}return t.prototype.supports=function(t){return this.supportedKeyTypes.includes(t)},t.IDENTIFIER=new t("SEGMENT"),t.PROPERTY=new t("SEGMENT","USER_PROPERTY","HACKLE_PROPERTY","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY","COHORT"),t.SEGMENT=new t("USER_ID","USER_PROPERTY","HACKLE_PROPERTY","COHORT"),t}(),ft=["ACTIVE","DRAFT","PAUSE"],pt=["WEB","ANDROID","IOS"],lt=["IMMEDIATE","CUSTOM"],ht=["MODAL","BANNER"],dt=["IMAGE_TEXT","IMAGE_ONLY","TEXT_ONLY","IMAGE"],vt=["VERTICAL","HORIZONTAL"],yt=["CLICK"],gt=["CLOSE","WEB_LINK","HIDDEN","LINK_AND_CLOSE","LINK_NEW_TAB","LINK_NEW_TAB_AND_CLOSE","LINK_NEW_WINDOW","LINK_NEW_WINDOW_AND_CLOSE"],mt=["TOP","MIDDLE","BOTTOM"],Et=["LEFT","CENTER","RIGHT"],wt=function(){function t(t,e,r,n,i,o,s){this.id=t,this.key=e,this.status=r,this.period=n,this.eventTrigger=i,this.targetContext=o,this.messageContext=s}return t.fromJson=function(r){var n=I(ft,r.status);if(!e.isNullOrUndefined(n)){var i;switch(I(lt,r.timeUnit)){case"IMMEDIATE":i=new Tt;break;case"CUSTOM":if(e.isNullOrUndefined(r.startEpochTimeMillis))return;if(e.isNullOrUndefined(r.endEpochTimeMillis))return;i=new It(r.startEpochTimeMillis,r.endEpochTimeMillis);break;default:return}var o=St.fromJson(r.messageContext);if(!e.isNullOrUndefined(o)){var s=r.eventTriggerRules.map(At.fromJson),u=bt.fromJson(r.eventFrequencyCap);return new t(r.id,r.key,n,i,new _t(s,u),Rt.fromJson(r.targetContext),o)}}},t.prototype.supports=function(t){return this.messageContext.platformTypes.includes(t)},t}(),Tt=function(){function t(){this.type="IMMEDIATE"}return t.prototype.within=function(t){return!0},t}(),It=function(){function t(t,e){this.startMillisInclusive=t,this.endMillisExclusive=e,this.type="CUSTOM"}return t.prototype.within=function(t){return this.startMillisInclusive<=t&&t<this.endMillisExclusive},t}(),_t=function(t,e){this.rules=t,this.frequencyCap=e},At=function(){function t(t,e){this.eventKey=t,this.targets=e}return t.fromJson=function(e){return new t(e.eventKey,r.mapNotNullOrUndefined(e.targets,(function(t){return j.fromJson(t,ct.PROPERTY)})))},t}(),bt=function(){function t(t,e){this.identifierCaps=t,this.durationCap=e}return t.fromJson=function(e){return e?new t(e.identifiers.map(Nt.fromJson),Ot.fromJson(e.duration)):null},t}(),Nt=function(){function t(t,e){this.identifierType=t,this.count=e}return t.fromJson=function(e){return new t(e.identifierType,e.countPerIdentifier)},t}(),Ot=function(){function t(t,e){this.durationMillis=t,this.count=e}return t.fromJson=function(e){if(!e)return null;var r=I(y,e.durationUnit.timeUnit);return r?new t(g.converter[r](e.durationUnit.amount,"milliseconds"),e.countPerDuration):null},t}(),Rt=function(){function t(t,e){this.overrides=t,this.targets=e}return t.fromJson=function(e){return new t(e.overrides.map(Mt.fromJson),r.mapNotNullOrUndefined(e.targets,(function(t){return j.fromJson(t,ct.PROPERTY)})))},t}(),Mt=function(){function t(t,e){this.identifierType=t,this.identifiers=e}return t.fromJson=function(e){return new t(e.identifierType,e.identifiers)},t}(),St=function(){function t(t,e,r,n,i){this.defaultLang=t,this.experimentContext=e,this.platformTypes=r,this.orientations=n,this.messages=i}return t.fromJson=function(n){var i=null;"AB_TEST"===n.exposure.type&&null!==n.exposure.key&&(i=new Ct(n.exposure.key));var o=_(pt,n.platformTypes);if(!e.isNullOrUndefined(o)){var s=_(vt,n.orientations);if(!e.isNullOrUndefined(s)){var u=r.mapOrUndefined(n.messages,xt.fromJson);if(!e.isNullOrUndefined(u))return new t(n.defaultLang,i,o,s,u)}}},t}(),Ct=function(t){this.key=t},xt=function(){function t(t,e,r,n,i,o,s,u,a,c){this.variationKey=t,this.lang=e,this.layout=r,this.images=n,this.text=i,this.buttons=o,this.closeButton=s,this.background=u,this.action=a,this.outerButtons=c}return t.fromJson=function(n){var i=Ut.fromJson(n.layout);if(!e.isNullOrUndefined(i)){var o=r.mapOrUndefined(n.images,kt.fromJson);if(!e.isNullOrUndefined(o)){var s=r.mapOrUndefined(n.buttons,Vt.fromJson);if(!e.isNullOrUndefined(s)){var u=void 0;if(!e.isNotNullOrUndefined(n.closeButton)||(u=Vt.fromJson2(n.closeButton),!e.isNullOrUndefined(u))){var a=r.mapOrUndefined(n.outerButtons,Gt.fromJson);if(!e.isNullOrUndefined(a))return new t(n.variationKey,n.lang,i,o,n.text?Dt.fromJson(n.text):void 0,s,u,new Ht(n.background.color),n.action?Bt.fromJson(n.action):void 0,a)}}}}},t.prototype.toJson=function(){var t,e,r,n,i,o,s,u;return{variationKey:this.variationKey,lang:this.lang,layout:{layoutType:this.layout.layoutType,alignment:null!==(e=null===(t=this.layout.alignment)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null,displayType:this.layout.displayType},images:this.images.map((function(t){return t.toJson()})),text:null!==(n=null===(r=this.text)||void 0===r?void 0:r.toJson())&&void 0!==n?n:null,closeButton:null!==(o=null===(i=this.closeButton)||void 0===i?void 0:i.toCloseButtonJson())&&void 0!==o?o:null,buttons:this.buttons.map((function(t){return t.toJson()})),background:{color:this.background.color},action:null!==(u=null===(s=this.action)||void 0===s?void 0:s.toJson())&&void 0!==u?u:null,outerButtons:this.outerButtons.map((function(t){return t.toJson()}))}},t}(),Ut=function(){function t(t,e,r){this.displayType=t,this.layoutType=e,this.alignment=r}return t.fromJson=function(r){var n=I(dt,r.layoutType),i=I(ht,r.displayType);if(!e.isNullOrUndefined(i)&&!e.isNullOrUndefined(n))return new t(i,n,r.alignment?Pt.fromJson(r.alignment):void 0)},t}(),Pt=function(){function t(t,e){this.horizontal=t,this.vertical=e}return t.fromJson=function(r){var n=I(Et,r.horizontal);if(!e.isNullOrUndefined(n)){var i=I(mt,r.vertical);if(!e.isNullOrUndefined(i))return new t(n,i)}},t.prototype.toJson=function(){return{horizontal:this.horizontal,vertical:this.vertical}},t}(),kt=function(){function t(t,e,r){this.orientation=t,this.imagePath=e,this.action=r}return t.fromJson=function(r){var n=I(vt,r.orientation);if(!e.isNullOrUndefined(n)){var i=void 0;if(!e.isNotNullOrUndefined(r.action)||(i=Bt.fromJson(r.action),!e.isNullOrUndefined(i)))return new t(n,r.imagePath,i)}},t.prototype.toJson=function(){var t,e;return{orientation:this.orientation,imagePath:this.imagePath,action:null!==(e=null===(t=this.action)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null}},t}(),Dt=function(){function t(t,e){this.title=t,this.body=e}return t.fromJson=function(e){return new t(Lt.fromJson(e.title),Lt.fromJson(e.body))},t.prototype.toJson=function(){return{title:{text:this.title.text,style:{textColor:this.title.style.color}},body:{text:this.body.text,style:{textColor:this.body.style.color}}}},t}(),Lt=function(){function t(t,e){this.text=t,this.style=e}return t.fromJson=function(e){return new t(e.text,new Ft(e.style.textColor))},t}(),Ft=function(t){this.color=t},Vt=function(){function t(t,e,r){this.text=t,this.style=e,this.action=r}return t.fromJson=function(r){var n=Bt.fromJson(r.action);if(!e.isNullOrUndefined(n))return new t(r.text,new jt(r.style.textColor,r.style.bgColor,r.style.borderColor),n)},t.fromJson2=function(r){var n=Bt.fromJson(r.action);if(!e.isNullOrUndefined(n))return new t("âœ•",new jt(r.style.color,"#FFFFFF","#FFFFFF"),n)},t.prototype.toJson=function(){return{text:this.text,action:this.action.toJson(),style:{textColor:this.style.textColor,bgColor:this.style.backgroundColor,borderColor:this.style.borderColor}}},t.prototype.toCloseButtonJson=function(){return{action:this.action.toJson(),style:{color:this.style.textColor}}},t}(),Gt=function(){function t(t,e){this.button=t,this.alignment=e}return t.fromJson=function(r){var n=Vt.fromJson(r.button);if(!e.isNullOrUndefined(n)){var i=Pt.fromJson(r.alignment);if(!e.isNullOrUndefined(i))return new t(n,i)}},t.prototype.toJson=function(){return{button:this.button.toJson(),alignment:this.alignment.toJson()}},t}(),jt=function(t,e,r){this.textColor=t,this.backgroundColor=e,this.borderColor=r},Ht=function(t){this.color=t},Bt=function(){function t(t,e,r){this.behavior=t,this.type=e,this.value=r}return t.fromJson=function(r){var n,i=I(yt,r.behavior);if(!e.isNullOrUndefined(i)){var o=I(gt,r.type);if(!e.isNullOrUndefined(o))return new t(i,o,null!==(n=r.value)&&void 0!==n?n:void 0)}},t.prototype.toJson=function(){var t;return{behavior:this.behavior,type:this.type,value:null!==(t=this.value)&&void 0!==t?t:null}},t}(),zt=function(t){this.id=t};t.SplitUrlRedirectType=void 0,(t.SplitUrlRedirectType||(t.SplitUrlRedirectType={})).MANUAL="MANUAL";var Kt=function(){function e(t,e,r){this.needRedirect=t,this.redirectType=e,this.redirectUrl=r}return e.fromDto=function(r){var n;return new e(r.needRedirect,(n=r.properties.type,Object.values(t.SplitUrlRedirectType).includes(n)?r.properties.type:null),r.properties.value)},e}(),Jt=function(){function t(t,e){this.includeTargets=t,this.excludeTargets=e}return t.fromJson=function(e){if(null!==e)return new t(r.mapNotNullOrUndefined(e.match,(function(t){return j.fromJson(t,ct.PROPERTY)})),r.mapNotNullOrUndefined(e.notMatch,(function(t){return j.fromJson(t,ct.PROPERTY)})))},t}(),Yt="X-HACKLE-SDK-KEY",qt="X-HACKLE-SDK-NAME",Xt="X-HACKLE-SDK-VERSION",Wt="X-HACKLE-SDK-TIME",$t="_hackle_hid",Zt="_hackle_id",Qt="_hackle_session_id",te="_hackle_last_event_ts",ee=-1,re=6e4,ne="_hackle_uid",ie="_hackle_did",oe="_hackle_mkt",se="hackle-workspace-config",ue=function(){function t(t){this.name=t,this._tags={},this.name=t}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var r=t[0],n=t[1];e._tags[r]=n})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerTimer({name:this.name,tags:this._tags,type:"TIMER"})},t}(),ae=function(){function t(t){this._clock=t,this.startTime=this._clock.tick()}return t.start=function(e){return void 0===e&&(e=t.defaultClock),new t(e)},t.prototype.stop=function(t){var e=this._clock.tick()-this.startTime;t.record(e,"microseconds")},t.defaultClock=new m,t}();var ce,fe=function(){function t(t){this.name=t,this._tags={}}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var r=t[0],n=t[1];e._tags[r]=n})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerCounter({name:this.name,tags:this._tags,type:"COUNTER"})},t}();var pe=new Uint8Array(16);function le(){if(!ce&&!(ce="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ce(pe)}var he=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function de(t){return"string"==typeof t&&he.test(t)}for(var ve=[],ye=0;ye<256;++ye)ve.push((ye+256).toString(16).substr(1));function ge(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(ve[t[e+0]]+ve[t[e+1]]+ve[t[e+2]]+ve[t[e+3]]+"-"+ve[t[e+4]]+ve[t[e+5]]+"-"+ve[t[e+6]]+ve[t[e+7]]+"-"+ve[t[e+8]]+ve[t[e+9]]+"-"+ve[t[e+10]]+ve[t[e+11]]+ve[t[e+12]]+ve[t[e+13]]+ve[t[e+14]]+ve[t[e+15]]).toLowerCase();if(!de(r))throw TypeError("Stringified UUID is invalid");return r}function me(t,e,r){function n(t,n,i,o){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}(t)),"string"==typeof n&&(n=function(t){if(!de(t))throw TypeError("Invalid UUID");var e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=255&e,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=255&e,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=255&e,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=255&e,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=255&e,r}(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+t.length);if(s.set(n),s.set(t,n.length),(s=r(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,i){o=o||0;for(var u=0;u<16;++u)i[o+u]=s[u];return i}return ge(s)}try{n.name=t}catch(t){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function Ee(t){return 14+(t+64>>>9<<4)+1}function we(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function Te(t,e,r,n,i,o){return we((s=we(we(e,t),we(n,o)))<<(u=i)|s>>>32-u,r);var s,u}function Ie(t,e,r,n,i,o,s){return Te(e&r|~e&n,t,e,i,o,s)}function _e(t,e,r,n,i,o,s){return Te(e&n|r&~n,t,e,i,o,s)}function Ae(t,e,r,n,i,o,s){return Te(e^r^n,t,e,i,o,s)}function be(t,e,r,n,i,o,s){return Te(r^(e|~n),t,e,i,o,s)}function Ne(t,e,r){var n=(t=t||{}).random||(t.rng||le)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return ge(n)}function Oe(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:case 3:return e^r^n;case 2:return e&r^e&n^r&n}}function Re(t,e){return t<<e|t>>>32-e}me("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return function(t){for(var e=[],r=32*t.length,n="0123456789abcdef",i=0;i<r;i+=8){var o=t[i>>5]>>>i%32&255,s=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);e.push(s)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[Ee(e)-1]=e;for(var r=1732584193,n=-271733879,i=-1732584194,o=271733878,s=0;s<t.length;s+=16){var u=r,a=n,c=i,f=o;r=Ie(r,n,i,o,t[s],7,-680876936),o=Ie(o,r,n,i,t[s+1],12,-389564586),i=Ie(i,o,r,n,t[s+2],17,606105819),n=Ie(n,i,o,r,t[s+3],22,-1044525330),r=Ie(r,n,i,o,t[s+4],7,-176418897),o=Ie(o,r,n,i,t[s+5],12,1200080426),i=Ie(i,o,r,n,t[s+6],17,-1473231341),n=Ie(n,i,o,r,t[s+7],22,-45705983),r=Ie(r,n,i,o,t[s+8],7,1770035416),o=Ie(o,r,n,i,t[s+9],12,-1958414417),i=Ie(i,o,r,n,t[s+10],17,-42063),n=Ie(n,i,o,r,t[s+11],22,-1990404162),r=Ie(r,n,i,o,t[s+12],7,1804603682),o=Ie(o,r,n,i,t[s+13],12,-40341101),i=Ie(i,o,r,n,t[s+14],17,-1502002290),r=_e(r,n=Ie(n,i,o,r,t[s+15],22,1236535329),i,o,t[s+1],5,-165796510),o=_e(o,r,n,i,t[s+6],9,-1069501632),i=_e(i,o,r,n,t[s+11],14,643717713),n=_e(n,i,o,r,t[s],20,-373897302),r=_e(r,n,i,o,t[s+5],5,-701558691),o=_e(o,r,n,i,t[s+10],9,38016083),i=_e(i,o,r,n,t[s+15],14,-660478335),n=_e(n,i,o,r,t[s+4],20,-405537848),r=_e(r,n,i,o,t[s+9],5,568446438),o=_e(o,r,n,i,t[s+14],9,-1019803690),i=_e(i,o,r,n,t[s+3],14,-187363961),n=_e(n,i,o,r,t[s+8],20,1163531501),r=_e(r,n,i,o,t[s+13],5,-1444681467),o=_e(o,r,n,i,t[s+2],9,-51403784),i=_e(i,o,r,n,t[s+7],14,1735328473),r=Ae(r,n=_e(n,i,o,r,t[s+12],20,-1926607734),i,o,t[s+5],4,-378558),o=Ae(o,r,n,i,t[s+8],11,-2022574463),i=Ae(i,o,r,n,t[s+11],16,1839030562),n=Ae(n,i,o,r,t[s+14],23,-35309556),r=Ae(r,n,i,o,t[s+1],4,-1530992060),o=Ae(o,r,n,i,t[s+4],11,1272893353),i=Ae(i,o,r,n,t[s+7],16,-155497632),n=Ae(n,i,o,r,t[s+10],23,-1094730640),r=Ae(r,n,i,o,t[s+13],4,681279174),o=Ae(o,r,n,i,t[s],11,-358537222),i=Ae(i,o,r,n,t[s+3],16,-722521979),n=Ae(n,i,o,r,t[s+6],23,76029189),r=Ae(r,n,i,o,t[s+9],4,-640364487),o=Ae(o,r,n,i,t[s+12],11,-421815835),i=Ae(i,o,r,n,t[s+15],16,530742520),r=be(r,n=Ae(n,i,o,r,t[s+2],23,-995338651),i,o,t[s],6,-198630844),o=be(o,r,n,i,t[s+7],10,1126891415),i=be(i,o,r,n,t[s+14],15,-1416354905),n=be(n,i,o,r,t[s+5],21,-57434055),r=be(r,n,i,o,t[s+12],6,1700485571),o=be(o,r,n,i,t[s+3],10,-1894986606),i=be(i,o,r,n,t[s+10],15,-1051523),n=be(n,i,o,r,t[s+1],21,-2054922799),r=be(r,n,i,o,t[s+8],6,1873313359),o=be(o,r,n,i,t[s+15],10,-30611744),i=be(i,o,r,n,t[s+6],15,-1560198380),n=be(n,i,o,r,t[s+13],21,1309151649),r=be(r,n,i,o,t[s+4],6,-145523070),o=be(o,r,n,i,t[s+11],10,-1120210379),i=be(i,o,r,n,t[s+2],15,718787259),n=be(n,i,o,r,t[s+9],21,-343485551),r=we(r,u),n=we(n,a),i=we(i,c),o=we(o,f)}return[r,n,i,o]}(function(t){if(0===t.length)return[];for(var e=8*t.length,r=new Uint32Array(Ee(e)),n=0;n<e;n+=8)r[n>>5]|=(255&t[n/8])<<n%32;return r}(t),8*t.length))})),me("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var n=unescape(encodeURIComponent(t));t=[];for(var i=0;i<n.length;++i)t.push(n.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,s=Math.ceil(o/16),u=new Array(s),a=0;a<s;++a){for(var c=new Uint32Array(16),f=0;f<16;++f)c[f]=t[64*a+4*f]<<24|t[64*a+4*f+1]<<16|t[64*a+4*f+2]<<8|t[64*a+4*f+3];u[a]=c}u[s-1][14]=8*(t.length-1)/Math.pow(2,32),u[s-1][14]=Math.floor(u[s-1][14]),u[s-1][15]=8*(t.length-1)&4294967295;for(var p=0;p<s;++p){for(var l=new Uint32Array(80),h=0;h<16;++h)l[h]=u[p][h];for(var d=16;d<80;++d)l[d]=Re(l[d-3]^l[d-8]^l[d-14]^l[d-16],1);for(var v=r[0],y=r[1],g=r[2],m=r[3],E=r[4],w=0;w<80;++w){var T=Math.floor(w/20),I=Re(v,5)+Oe(T,y,g,m)+E+e[T]+l[w]>>>0;E=m,m=g,g=Re(y,30)>>>0,y=v,v=I}r[0]=r[0]+v>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+g>>>0,r[3]=r[3]+m>>>0,r[4]=r[4]+E>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}));var Me=function(){function t(t){this.compareFn=t,this.data=new Map,this.compareFn=t,this.data=new Map}return t.prototype.values=function(){return Array.from(this.data.values())},t.prototype.keys=function(){return Array.from(this.data.keys())},t.prototype.get=function(t){var e=this,r=this.keys().find((function(r){return e.compareFn(r,t)}));return r?this.data.get(r):void 0},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.add=function(t,e){var r=e;return r||(r=t),this.data.set(t,r),this},t.prototype.delete=function(t){if(this.has(t)){var e=this.get(t);return this.data.delete(t),e}},t.prototype.forEach=function(t){this.data.forEach(t)},t.prototype.filter=function(e){for(var r=new t(this.compareFn),n=0,i=this.entries();n<i.length;n++){var o=i[n];e(o[0],o[1])&&r.add(o[0],o[1])}return r},t.prototype.entries=function(){return Array.from(this.data.entries())},t}(),Se=function(){function t(t,e){this.valueSupplier=e,this.field=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this.valueSupplier()},enumerable:!1,configurable:!0}),t}();function Ce(t,e){return t.name===e.name&&h.isEquals(t.tags,e.tags)}var xe=function(){function t(){this.id=Ne(),this.name="MetricRegistry",this._metrics=new Me(Ce)}return Object.defineProperty(t.prototype,"metrics",{get:function(){return Array.from(this._metrics.values())},enumerable:!1,configurable:!0}),t.prototype.registerCounter=function(t){return this.registerMetricIfNecessary(t,this.createCounter.bind(this))},t.prototype.registerTimer=function(t){return this.registerMetricIfNecessary(t,this.createTimer.bind(this))},t.prototype.counter=function(t,e){return void 0===e&&(e={}),new fe(t).tags(e).register(this)},t.prototype.timer=function(t,e){return void 0===e&&(e={}),new ue(t).tags(e).register(this)},t.prototype.registerMetricIfNecessary=function(t,e){return this.getOrCreateMetric(t,e)},t.prototype.getOrCreateMetric=function(t,e){var r,n=this._metrics.get(t);return n?r=n:(r=e(t),this._metrics.add(t,r)),r},t.prototype.close=function(){},t}(),Ue=function(t){function e(e,r){var n=t.call(this)||this;return n.scheduler=e,n.pushIntervalMillis=r,n.publishingJob=null,n}return u(e,t),e.prototype.start=function(){var t=this;null===this.publishingJob&&(this.publishingJob=this.scheduler.schedulePeriodically(this.pushIntervalMillis,this.pushIntervalMillis,(function(){return t.publish(!1)})),i.log.debug("PushMetricRegistry started. Publish metrics every ".concat(this.pushIntervalMillis,"ms.")))},e.prototype.stop=function(){var t;null===(t=this.publishingJob)||void 0===t||t.cancel(),this.publishingJob=null,this.publish(!0),i.log.debug("PushMetricRegistry stopped.")},e.prototype.close=function(){this.stop()},e}(xe),Pe=function(){function t(t){this.counterValue=0,this.id=t}return t.prototype.count=function(){return this.counterValue},t.prototype.increment=function(t){this.counterValue+=null!=t?t:1},t.prototype.measure=function(){return[new Se("count",this.count.bind(this))]},t}(),ke=function(){function t(t){this.id=t,this.currentCounter=new Pe(t)}return t.prototype.flush=function(){var t=this.currentCounter;return this.currentCounter=new Pe(this.id),t},t.prototype.count=function(){return this.currentCounter.count()},t.prototype.increment=function(t){this.currentCounter.increment(t)},t.prototype.measure=function(){return[new Se("count",this.count.bind(this))]},t}();var De=function(){function t(t){this._count=0,this._total=0,this._max=0,this.id=t}return t.prototype.count=function(){return this._count},t.prototype.totalTime=function(t){return g.nanosToUnit(this._total,t)},t.prototype.max=function(t){return g.nanosToUnit(this._max,t)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.record=function(t,e){if(!(t<0)){var r=g.converter[e](t,"nanoseconds");this._count=this.count()+1,this._total+=r,this._max=Math.max(r,this._max)}},t.prototype.measure=function(){var t=this;return[new Se("count",this.count.bind(this)),new Se("total",(function(){return t.totalTime("milliseconds")})),new Se("max",(function(){return t.max("milliseconds")})),new Se("mean",(function(){return t.mean("milliseconds")}))]},t}(),Le=function(){function t(t){this.id=t,this.currentTimer=new De(t)}return t.prototype.flush=function(){var t=this.currentTimer;return this.currentTimer=new De(this.id),t},t.prototype.count=function(){return this.currentTimer.count()},t.prototype.totalTime=function(t){return this.currentTimer.totalTime(t)},t.prototype.max=function(t){return this.currentTimer.max(t)},t.prototype.record=function(t,e){this.currentTimer.record(t,e)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.measure=function(){var t=this;return[new Se("count",this.count.bind(this)),new Se("total",(function(){return t.totalTime("milliseconds")})),new Se("max",(function(){return t.max("milliseconds")})),new Se("mean",(function(){return t.mean("milliseconds")}))]},t}(),Fe=function(t){function e(e,r){return t.call(this,e,r)||this}return u(e,t),e.prototype.createCounter=function(t){return new ke(t)},e.prototype.createTimer=function(t){return new Le(t)},e.prototype.publish=function(t){void 0===t&&(t=!1);var e=this.metrics.reduce((function(t,e){return function(t){return void 0!==t.flush&&"function"==typeof t.flush}(e)?t.concat(e.flush()):t}),[]);this.flushMetrics(e,t)},e}(Ue),Ve=function(){function t(t){this.id=t}return t.prototype.count=function(){return 0},t.prototype.increment=function(t){},t.prototype.measure=function(){return[new Se("count",this.count.bind(this))]},t}(),Ge=function(){function t(t){this._counters=new Me((function(t,e){return t.id===e.id})),this.id=t,this.noopCounter=new Ve(t)}return Object.defineProperty(t.prototype,"counters",{get:function(){return Array.from(this._counters.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._counters.add(t,t.registerCounter(this.id))},t.prototype.count=function(){return(this.counters[0]||this.noopCounter).count()},t.prototype.increment=function(t){this.counters.forEach((function(e){e.increment(t)}))},t.prototype.measure=function(){return[new Se("count",this.count.bind(this))]},t}();var je,He=function(){function t(t){this.id=t}return t.prototype.measure=function(){var t=this;return[new Se("count",this.count.bind(this)),new Se("total",(function(){return t.totalTime("milliseconds")})),new Se("max",(function(){return t.max("milliseconds")})),new Se("mean",(function(){return t.mean("milliseconds")}))]},t.prototype.count=function(){return 0},t.prototype.totalTime=function(t){return 0},t.prototype.max=function(t){return 0},t.prototype.mean=function(t){return 0},t.prototype.record=function(t,e){},t}(),Be=function(){function t(t){this._timers=new Me((function(t,e){return t.id===e.id})),this.id=t,this.noopTimer=new He(t)}return Object.defineProperty(t.prototype,"firstTimer",{get:function(){return this.timers[0]||this.noopTimer},enumerable:!1,configurable:!0}),t.prototype.totalTime=function(t){return this.firstTimer.totalTime(t)},t.prototype.max=function(t){return this.firstTimer.max(t)},t.prototype.mean=function(t){return this.firstTimer.mean(t)},t.prototype.record=function(t,e){this.timers.forEach((function(r){r.record(t,e)}))},Object.defineProperty(t.prototype,"timers",{get:function(){return Array.from(this._timers.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._timers.add(t,t.registerTimer(this.id))},t.prototype.count=function(){return this.firstTimer.count()},t.prototype.measure=function(){var t=this;return[new Se("count",this.count.bind(this)),new Se("total",(function(){return t.totalTime("milliseconds")})),new Se("max",(function(){return t.max("milliseconds")})),new Se("mean",(function(){return t.mean("milliseconds")}))]},t}(),ze=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registries=new Me((function(t,e){return t.id===e.id})),e}return u(e,t),e.prototype.createCounter=function(t){var e=new Ge(t);return this.addRegistry(e),e},e.prototype.createTimer=function(t){var e=new Be(t);return this.addRegistry(e),e},e.prototype.addRegistry=function(t){this.registries.forEach((function(e){return t.add(e)}))},e.prototype.add=function(t){t instanceof e||this.registries.has(t)||(this.registries.add(t),this.metrics.forEach((function(e){(function(t){return void 0!==t.add&&"function"==typeof t.add})(e)&&e.add(t)})))},e.prototype.close=function(){this.registries.forEach((function(t){t.close()}))},e}(xe),Ke=function(){function t(){}return t.counter=function(e,r){return t.globalRegistry.counter(e,r)},t.timer=function(e,r){return t.globalRegistry.timer(e,r)},t.addRegistry=function(e){t.globalRegistry.add(e),i.log.debug("MetricRegistry added ".concat(e.name))},t.globalRegistry=new ze,t}(),Je=function(){function t(){}return t.equalsIgnoreCase=function(t,e){return t.toLowerCase()===e.toLowerCase()},t.isNotEmptyString=function(t){return!e.isNullOrUndefined(t)&&("string"==typeof t&&t.length>0)},t}(),Ye=function(){function t(t,e,r,n,i){this.url=t,this.method=e,this.body=r,this.headers=n,this.options=i}return t.builder=function(){return new qe},t.get=function(e){return t.builder().url(e).build()},t.prototype.toBuilder=function(){return new qe(this)},t}(),qe=function(){function t(t){var e,r,n,i,o,s,u;this._url=null!==(e=null==t?void 0:t.url)&&void 0!==e?e:null,this._method=null!==(r=null==t?void 0:t.method)&&void 0!==r?r:"GET",this._body=null!==(n=null==t?void 0:t.body)&&void 0!==n?n:null,this._headers=null!==(o=null===(i=null==t?void 0:t.headers)||void 0===i?void 0:i.toBuilder())&&void 0!==o?o:We.builder(),this._timeoutMillis=null!==(u=null===(s=null==t?void 0:t.options)||void 0===s?void 0:s.timeoutMillis)&&void 0!==u?u:null}return t.prototype.url=function(t){return this._url=t,this},t.prototype.method=function(t){return this._method=t,this},t.prototype.body=function(t){return this._body=t,this},t.prototype.addHeader=function(t,e){return this._headers.add(t,e),this},t.prototype.timeoutMillis=function(t){return this._timeoutMillis=t,this},t.prototype.build=function(){if(null===this._url)throw new Error("url is null");var t={timeoutMillis:this._timeoutMillis};return new Ye(this._url,this._method,this._body,this._headers.build(),t)},t}(),Xe=function(){function t(t,e,r){this.statusCode=t,this.body=e,this.headers=r}return t.ok=function(e,r){return t.of(200,e,r)},t.of=function(e,r,n){return new t(e,null!=r?r:null,null!=n?n:We.empty())},t.prototype.isSuccessful=function(){return this.statusCode>=200&&this.statusCode<300},t.prototype.isClientError=function(){return this.statusCode>=400&&this.statusCode<500},t.prototype.isNotModified=function(){return 304===this.statusCode},t}(),We=function(){function t(t){this.headers=t}return t.empty=function(){return new t(new Map)},t.builder=function(){return new $e(new Map)},t.prototype.get=function(t){for(var e=0,r=Array.from(this.headers.entries());e<r.length;e++){var n=r[e],i=n[0],o=n[1];if(Je.equalsIgnoreCase(i,t))return o}return null},t.prototype.getOrDefault=function(t,e){var r;return null!==(r=this.get(t))&&void 0!==r?r:e},t.prototype.raw=function(){return Array.from(this.headers.entries()).reduce((function(t,e){var r=e[0],n=e[1];return t[r]=n,t}),{})},t.prototype.toBuilder=function(){return new $e(this.headers)},t.IF_MODIFIED_SINCE="If-Modified-Since",t.LAST_MODIFIED="Last-Modified",t}(),$e=function(){function t(t){this.headers=t}return t.prototype.add=function(t,e){return this.headers.set(t,e),this},t.prototype.build=function(){return new We(this.headers)},t}(),Ze=function(t){function n(e,r,n,i,o){var s=t.call(this,i,o)||this;return s.url=e,s.transport=r,s.synchronousTransport=n,s.start(),s}return u(n,t),n.prototype.flushMetrics=function(t,e){var n=this;r.chunked(t.filter(this.isDispatchTarget.bind(this)),100).forEach((function(t){n.dispatch(t,e)}))},n.prototype.isDispatchTarget=function(t){return!(!function(t){return"COUNTER"===t.id.type}(t)&&!function(t){return"TIMER"===t.id.type}(t))&&t.count()>0},n.prototype.dispatch=function(t,e){var r=this.createRequest(t);this.execute(r,e).catch((function(t){return i.log.debug("Failed to flushing metrics: ".concat(t))}))},n.prototype.createRequest=function(t){return Ye.builder().url(this.url).method("POST").body(JSON.stringify(this.batch(t))).addHeader("Content-Type","application/json").build()},n.prototype.execute=function(t,e){return e?this.synchronousTransport.send(t):this.transport.send(t)},n.prototype.batch=function(t){return{metrics:t.map((function(t){return{name:t.id.name,type:t.id.type,tags:t.id.tags,measurements:e.fromMap(r.associate(t.measure(),(function(t){return[t.field,t.value]})))}}))}},n.prototype.onVisibilityChanged=function(t,e){switch(t){case"visible":return;case"hidden":return void this.publish(!0)}},n}(Fe),Qe=function(){function t(){}return t.experiment=function(t,e,r){var n=Ke.timer("experiment.decision",{key:String(e),variation:r.variation,reason:String(r.reason)});t.stop(n)},t.featureFlag=function(t,e,r){var n=Ke.timer("feature.flag.decision",{key:String(e),on:String(r.isOn),reason:String(r.reason)});t.stop(n)},t.remoteConfig=function(t,e,r){var n=Ke.timer("remote.config.decision",{key:String(e),reason:String(r.reason)});t.stop(n)},t.inAppMessage=function(t,e,r){var n=Ke.timer("iam.decision",{key:String(e),show:String(r.isShow()),reason:String(r.reason)});t.stop(n)},t}(),tr=function(){function t(){}return t.record=function(e,r,n){var i=Ke.timer("api.call",{operation:e,success:t.success(n)});r.stop(i)},t.success=function(t){return null===t?"false":String(t.isSuccessful()||t.isNotModified())},t}(),er=function(){function t(){}return t.decide=function(t,r,n,i){if(e.isNullOrUndefined(n))return this.decision(t,r,"NULL",n,i);switch(typeof n){case"string":return this.decision(t,r,"STRING",n,i);case"number":return this.decision(t,r,"NUMBER",n,i);case"boolean":return this.decision(t,r,"BOOLEAN",n,i);default:return this.decision(t,r,"UNKNOWN",n,i)}},t.decision=function(t,r,n,i,o){return e.isNullOrUndefined(r)?A.of(i,S.INVALID_INPUT):t.remoteConfig(r,o,n,i)},t}(),rr=i.log,nr=function(){function t(t,e,r){this.core=t,this.userManager=e,this.user=r}return t.prototype.get=function(t,e){var r,n=ae.start();try{r=this.decide(t,e)}catch(n){rr.error("Unexpected exception while deciding remote config parameter[".concat(t,"]. Returning default value. : ").concat(n)),r=A.of(e,S.EXCEPTION)}return Qe.remoteConfig(n,t,r),r.value},t.prototype.decide=function(t,e){var r=this.userManager.resolve(this.user);return er.decide(this.core,t,e,r)},t}(),ir=function(){function t(){this._properties=new Map,this.MAX_PROPERTIES_COUNT=128,this.MAX_PROPERTY_KEY_LENGTH=128}return t.prototype.contains=function(t){return this._properties.has(t)},t.prototype.remove=function(t){var e=this;return t instanceof Map&&t.forEach((function(t,r){e.remove(r)})),"string"==typeof t&&this._properties.delete(t),this},t.prototype.compute=function(t,e){var r=this._properties.get(t),n=e(r);null!==n?this.add(t,n):(null!==r||this.contains(t))&&this.remove(t)},t.prototype.add=function(t,r,n){if(void 0===n&&(n=!1),n&&this.contains(t))return this;if(this._properties.size>=this.MAX_PROPERTIES_COUNT)return this;if("string"==typeof t&&t.length>this.MAX_PROPERTY_KEY_LENGTH)return this;var i=v.sanitizeValue(t,r);return e.isNullOrUndefined(i)||this._properties.set(t,i),this},t.prototype.addProperties=function(t,e){var r=this;return void 0===e&&(e=!1),t.forEach((function(t,n){r.add(n,t,e)})),this},t.prototype.build=function(){return this._properties},t}();!function(t){t.SET="$set",t.SET_ONCE="$setOnce",t.UNSET="$unset",t.INCREMENT="$increment",t.APPEND="$append",t.APPEND_ONCE="$appendOnce",t.PREPEND="$prepend",t.PREPEND_ONCE="$prependOnce",t.REMOVE="$remove",t.CLEAR_ALL="$clearAll"}(je||(je={}));var or=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new ir).addProperties(t).addProperties(e).build()},t}(),sr=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new ir).addProperties(t).addProperties(e,!0).build()},t}(),ur=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?new Map:0===e.size?t:(new ir).addProperties(t).remove(e).build()},t}(),ar=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new ir;return n.addProperties(t),e.forEach((function(t,e){n.compute(e,(function(e){return r.increment(e,t)}))})),n.build()},t.prototype.increment=function(t,e){return"number"!=typeof e?t:"number"!=typeof t?null==t?e:t:t+e},t}(),cr=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new ir;return n.addProperties(t),e.forEach((function(t,e){n.compute(e,(function(e){return r.compute(e,t)}))})),n.build()},t.prototype.compute=function(t,e){var r=this.toArray(t),n=this.toArray(e);return this.operateArray(r,n)},t.prototype.toArray=function(t){return null==t?[]:Array.isArray(t)?t:[t]},t.prototype.contains=function(t,e){return t.includes(e)},t.prototype.prepend=function(t,e,r){return void 0===r&&(r=!1),r&&this.contains(e,t)?e:p([t],e,!0)},t.prototype.append=function(t,e,r){return void 0===r&&(r=!1),r&&this.contains(t,e)?t:p(p([],t,!0),[e],!1)},t}(),fr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduce((function(t,e){return r.append.bind(r)(t,e)}),t)},e}(cr),pr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.appendOnce.bind(this),t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e}(cr),lr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduceRight((function(t,e){return r.prepend.bind(r)(e,t)}),t)},e}(cr),hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduce(this.appendOnce.bind(this),[]).reduceRight((function(t,e){return r.prependOnce.bind(r)(e,t)}),t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e.prototype.prependOnce=function(t,e){return this.prepend(t,e,!0)},e}(cr),dr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.remove.bind(this),t)},e.prototype.remove=function(t,e){return t.filter((function(t){return t!==e}))},e}(cr),vr=function(){function t(){}return t.prototype.operate=function(t,e){return new Map},t}(),yr=function(){function t(){}return t.get=function(t){switch(t){case je.SET:return new or;case je.SET_ONCE:return new sr;case je.UNSET:return new ur;case je.INCREMENT:return new ar;case je.APPEND:return new fr;case je.APPEND_ONCE:return new pr;case je.PREPEND:return new lr;case je.PREPEND_ONCE:return new hr;case je.CLEAR_ALL:return new vr;case je.REMOVE:return new dr}},t}(),gr=function(){function t(){this.operations=new Map}return t.prototype.set=function(t,e){return this.add(je.SET,t,e)},t.prototype.setOnce=function(t,e){return this.add(je.SET_ONCE,t,e)},t.prototype.unset=function(t){return this.add(je.UNSET,t,"-")},t.prototype.increment=function(t,e){return this.add(je.INCREMENT,t,e)},t.prototype.append=function(t,e){return this.add(je.APPEND,t,e)},t.prototype.appendOnce=function(t,e){return this.add(je.APPEND_ONCE,t,e)},t.prototype.prepend=function(t,e){return this.add(je.PREPEND,t,e)},t.prototype.prependOnce=function(t,e){return this.add(je.PREPEND_ONCE,t,e)},t.prototype.remove=function(t,e){return this.add(je.REMOVE,t,e)},t.prototype.clearAll=function(){return this.add(je.CLEAR_ALL,"clearAll","-")},t.prototype.build=function(){var t=Array.from(this.operations.entries()).map((function(t){return[t[0],t[1].build()]}));return new mr(new Map(t))},t.prototype.containsKey=function(t){return Array.from(this.operations.entries()).some((function(e){return e[0],e[1].contains(t)}))},t.prototype.add=function(t,e,r){if(this.containsKey(e))return this;this.operations.has(t)||this.operations.set(t,new ir);var n=this.operations.get(t);return null==n||n.add(e,r),this},t}(),mr=function(){function t(t){this.operations=null!=t?t:new Map}return t.prototype.operate=function(t){var e=t;return this.operations.forEach((function(t,r){e=yr.get(r).operate(e,t)})),e},t.prototype.toEvent=function(){var t={key:"$properties"};return this.operations.forEach((function(r,n){var i,o;t.properties=a(a({},t.properties),((i={})[n]=a(a({},null===(o=t.properties)||void 0===o?void 0:o[n]),v.sanitize(e.fromMap(r))),i))})),t},t.prototype.toRecord=function(){var t={};return this.operations.forEach((function(e,r){var n={};e.forEach((function(t,e){n[e]=t})),t[r]=n})),t},t}(),Er=function(){function t(){}return t.timeout=function(t,e){return new Promise((function(r,n){setTimeout((function(){return n(new Error("timeout (".concat(e,"ms)")))}),e),t.then(r,n)}))},t}(),wr=i.log,Tr=function(){function t(t,e,r,n,i,o){this.core=t,this.synchronizer=e,this.sessionManager=r,this.userManager=n,this.fetchThrottler=i,this.devTools=o,this.initialized=!1,this.initialize=this.initialize.bind(this),this.getSessionId=this.getSessionId.bind(this),this.getUser=this.getUser.bind(this),this.setUser=this.setUser.bind(this),this.setUserId=this.setUserId.bind(this),this.setDeviceId=this.setDeviceId.bind(this),this.setUserProperty=this.setUserProperty.bind(this),this.setUserProperties=this.setUserProperties.bind(this),this.updateUserProperties=this.updateUserProperties.bind(this),this.resetUser=this.resetUser.bind(this),this.variation=this.variation.bind(this),this.variationDetail=this.variationDetail.bind(this),this.isFeatureOn=this.isFeatureOn.bind(this),this.featureFlagDetail=this.featureFlagDetail.bind(this),this.track=this.track.bind(this),this.trackPageView=this.trackPageView.bind(this),this.remoteConfig=this.remoteConfig.bind(this),this.onReady=this.onReady.bind(this),this.onInitialized=this.onInitialized.bind(this),this.showUserExplorer=this.showUserExplorer.bind(this),this.hideUserExplorer=this.hideUserExplorer.bind(this),this.fetch=this.fetch.bind(this),this.close=this.close.bind(this),this.initialization=this.initialize()}return t.prototype.initialize=function(){return c(this,void 0,void 0,(function(){var t;return f(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,3,4]),wr.debug("HackleClient initializing"),[4,this.synchronizer.sync()];case 1:return e.sent(),wr.debug("HackleClient initialized"),[3,4];case 2:throw t=e.sent(),wr.error("HackleClient initialize failed: ".concat(t)),t;case 3:return this.initialized=!0,[7];case 4:return[2]}}))}))},t.prototype.getSessionId=function(){return this.sessionManager.sessionId},t.prototype.getUser=function(){return this.userManager.currentUser},t.prototype.setUser=function(t){try{var e=G(t);return e?(this.userManager.setUser(e),this.synchronizer.syncOnly("cohort").catch((function(){}))):(wr.warn("invalid user"),Promise.resolve())}catch(t){return wr.error("Unexpected exception while set user: ".concat(t)),Promise.resolve()}},t.prototype.setUserId=function(t){try{if(void 0===t)this.userManager.setUserId(void 0);else{var e=h.sanitizeValue(t);if(!e)return wr.warn("Invalid userId. [userId=".concat(t,"]")),Promise.resolve();this.userManager.setUserId(e)}return this.synchronizer.syncOnly("cohort").catch((function(){}))}catch(t){return wr.error("Unexpected exception while set userId: ".concat(t)),Promise.resolve()}},t.prototype.setDeviceId=function(t){try{var e=h.sanitizeValue(t);return e?(this.userManager.setDeviceId(e),this.synchronizer.syncOnly("cohort").catch((function(t){}))):(wr.warn("Invalid deviceId. [deviceId=".concat(t,"]")),Promise.resolve())}catch(t){return wr.error("Unexpected exception while set deviceId: ".concat(t)),Promise.resolve()}},t.prototype.setUserProperty=function(t,e){var r=(new gr).set(t,e).build();return this.updateUserProperties(r)},t.prototype.setUserProperties=function(t){try{var e=v.sanitize(t),r=new gr;return Object.entries(e).forEach((function(t){var e=t[0],n=t[1];r.set(e,n)})),this.updateUserProperties(r.build())}catch(t){return wr.error("Unexpected exception while set userProperties: ".concat(t)),Promise.resolve()}},t.prototype.updateUserProperties=function(t){try{var e=t.toEvent();return this.track(e),this.userManager.updateUserProperties(t),Promise.resolve()}catch(t){return wr.error("Unexpected exception while update userProperties: ".concat(t)),Promise.resolve()}},t.prototype.resetUser=function(){try{this.userManager.resetUser();var t=(new gr).clearAll().build();return this.track(t.toEvent()),this.synchronizer.syncOnly("cohort")}catch(t){return wr.error("Unexpected exception while reset user: ".concat(t)),Promise.resolve()}},t.prototype.variation=function(t,e,r){return this.variationDetail(t,e,r).variation},t.prototype.variationDetail=function(t,e,r){var n=r||"A",i=ae.start(),o=function(r){try{var i=r.userManager.resolve(e);return r.core.experiment(t,i,n)}catch(e){return wr.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(n,"] : ").concat(e)),N.of(n,S.EXCEPTION)}}(this);return Qe.experiment(i,t,o),o},t.prototype.isFeatureOn=function(t,e){return this.featureFlagDetail(t,e).isOn},t.prototype.featureFlagDetail=function(t,e){var r=ae.start(),n=function(r){try{var n=r.userManager.resolve(e);return r.core.featureFlag(t,n)}catch(e){return wr.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),O.off(S.EXCEPTION)}}(this);return Qe.featureFlag(r,t,n),n},t.prototype.track=function(t,e){try{wr.debug("track event : ".concat(JSON.stringify(t)));var r=this._convertEvent(t),n=this.userManager.resolve(e);this.core.track(r,n)}catch(t){wr.error("Unexpected exception while tracking event: ".concat(t))}},t.prototype.trackPageView=function(t){wr.debug("tracking page view");var e=this.userManager.resolve();this.core.track({key:"$page_view"},e)},t.prototype.remoteConfig=function(t){return new nr(this.core,this.userManager,t)},t.prototype.onReady=function(t,e){void 0===e&&(e=3e3),this.onInitialized({timeout:e}).finally((function(){return t()}))},t.prototype.onInitialized=function(t){var e;return c(this,void 0,void 0,(function(){var r;return f(this,(function(n){switch(n.label){case 0:if(this.initialized)return[2,{success:!0}];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Er.timeout(this.initialization,null!==(e=null==t?void 0:t.timeout)&&void 0!==e?e:3e3)];case 2:return n.sent(),[2,{success:!0}];case 3:return r=n.sent(),wr.error("Failed to onInitialized: ".concat(r)),[2,{success:!1}];case 4:return[2]}}))}))},t.prototype._convertEvent=function(t){return"string"==typeof t?{key:t}:t},t.prototype.showUserExplorer=function(){var t;(null===(t=this.devTools)||void 0===t?void 0:t.userExplorer)?(wr.debug("UserExplorer opened."),Ke.counter("user.explorer.show",{}).increment(),this.devTools.manager.userExplorer(this.devTools.userExplorer)):wr.error("UserExplorer is not provided")},t.prototype.hideUserExplorer=function(){this.devTools?this.devTools.manager.close():wr.warn("There is no active HackleDevtools.")},t.prototype.fetch=function(){var t=this;return this.fetchThrottler.execute((function(){return t.synchronizer.sync()}),(function(){return Promise.resolve()}))},t.prototype.close=function(){wr.debug("HackleClient closing"),this.core.close(),this.synchronizer.close()},t}(),Ir=i.log,_r=function(){function t(t,e){this.invocationProcessor=t,this.user=e}return t.prototype.get=function(t,e){var r=typeof e;try{var n={command:"remoteConfig",parameters:{defaultValue:e,key:t,valueType:r,user:this.user}},i=this.invocationProcessor.process(n);if(!i)throw new Error("invoke result data not exists");switch(r){case"number":return Number(i);case"boolean":return Boolean(i);default:return i}}catch(r){return Ir.error("Unexpected exception while deciding remote config parameter[".concat(t,"]. Returning default value. : ").concat(r)),e}},t}(),Ar=function(){function t(){}return t.prototype.isInvocatorResponse=function(t){return"object"==typeof t&&null!==t&&"success"in t&&"boolean"==typeof t.success&&"message"in t&&"string"==typeof t.message},t.prototype.resolve=function(t){var e=JSON.parse(null!=t?t:"");if(!this.isInvocatorResponse(e))throw new Error("invalid invocator response data");if(!e.success)throw new Error("failed response");return{message:e.message,success:e.success,data:e.data}},t}(),br=function(){function t(){}return t.tryParse=function(t){try{return new URL(t)}catch(t){return}},t.removePathnameTrailingSlash=function(e){var r=e instanceof URL?e:t.tryParse(e);if(!r)return String(e);if(r.pathname.endsWith("/")){r.pathname=r.pathname.replace(/\/+$/,"")}return r.href},t.tryDecodeURI=function(t){try{return decodeURI(t)}catch(t){return}},t.tryDecodeURIComponent=function(t){try{return decodeURIComponent(t)}catch(t){return}},t.decodeURIOrOriginal=function(t){try{return decodeURI(t)}catch(e){return t}},t.decodeURIComponentOrOriginal=function(t){try{return decodeURIComponent(t)}catch(e){return t}},t}(),Nr=function(){function t(t){void 0===t&&(t={days:0,isCrossSubdomain:!1,isSecure:!1}),this.options=t}return t.extractDomain=function(t){var e=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,r=t.split("."),n=r[r.length-1];(n.length>4||"com"===n||"org"===n)&&(e=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i);var i=t.match(e);return i?i[0]:""},t.prototype.getItem=function(t){for(var e,r=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(r))return null!==(e=br.tryDecodeURIComponent(o.substring(r.length,o.length)))&&void 0!==e?e:null}return null},t.prototype.getAllItem=function(t){var e=document.cookie.split("; ").map((function(t){return t.split("=")})),r=null==t?void 0:t.keyPrefix;return r?e.filter((function(t){var e=t[0];return t[1],e.startsWith(r)})):e},t.prototype.setItem=function(e,r,n){var i=a(a({},this.options),n),o="",s="",u="",c="";if(i.isCrossSubdomain){var f=t.extractDomain(document.location.hostname);o=f?"; domain=."+f:""}if(i.days){var p=new Date;p.setTime(p.getTime()+24*i.days*60*60*1e3),s="; expires="+p.toUTCString()}i.sameSite&&(c="; SameSite=".concat(i.sameSite)),i.isSecure&&(u+="; secure");var l=e+"="+encodeURIComponent(r)+s+"; path=/"+o+c+u;return document.cookie=l,l},t.prototype.removeItem=function(t,e){this.setItem(t,"",a(a({},e),{days:-1}))},t.prototype.getOptions=function(){return this.options},t.getInstance=function(e){return void 0===e&&(e={days:3650,isCrossSubdomain:!0}),t.storage||(t.storage=new t(e)),t.storage},t}(),Or=function(){function t(){}return t.prototype.initialize=function(){Nr.getInstance().getItem($t)||Cr()},t.prototype.onVisibilityChanged=function(t,e){switch(t){case"visible":return;case"hidden":return void Sr()}},t}();function Rr(){var t=Nr.getInstance(),e=t.getItem(Zt);if(e)return e;var r=t.getItem($t);return r||Cr()}function Mr(t){Nr.getInstance().setItem(Zt,t)}function Sr(){Nr.getInstance().removeItem(Zt)}function Cr(){var t=Ne();return Nr.getInstance().setItem($t,t),t}var xr=function(){function t(t){this.invocator=t}return t.prototype.createInvocationRequestDto=function(t){return{_hackle:{command:t.command,parameters:t.parameters}}},t.prototype.process=function(t){var e,r=this.createInvocationRequestDto(t);return null!==(e=this.invocator.invoke(r).data)&&void 0!==e?e:null},t}(),Ur=i.log;var Pr=function(){function t(t){this.invocationProcessor=t,this.getSessionId=this.getSessionId.bind(this),this.getUser=this.getUser.bind(this),this.setUser=this.setUser.bind(this),this.setUserId=this.setUserId.bind(this),this.setDeviceId=this.setDeviceId.bind(this),this.setUserProperty=this.setUserProperty.bind(this),this.setUserProperties=this.setUserProperties.bind(this),this.updateUserProperties=this.updateUserProperties.bind(this),this.resetUser=this.resetUser.bind(this),this.variation=this.variation.bind(this),this.variationDetail=this.variationDetail.bind(this),this.isFeatureOn=this.isFeatureOn.bind(this),this.featureFlagDetail=this.featureFlagDetail.bind(this),this.track=this.track.bind(this),this.trackPageView=this.trackPageView.bind(this),this.remoteConfig=this.remoteConfig.bind(this),this.onReady=this.onReady.bind(this),this.onInitialized=this.onInitialized.bind(this),this.showUserExplorer=this.showUserExplorer.bind(this),this.hideUserExplorer=this.hideUserExplorer.bind(this),this.fetch=this.fetch.bind(this),this.close=this.close.bind(this)}return t.prototype.getSessionId=function(){try{var t=this.invocationProcessor.process({command:"getSessionId"});return null!=t?t:Rr()}catch(t){return Ur.error("Unexpected exception while get sessionId: ".concat(t)),Rr()}},t.prototype.getUser=function(){var t;try{var e=this.invocationProcessor.process({command:"getUser"});return null!==(t=G(e))&&void 0!==t?t:this.defaultUser()}catch(t){return Ur.error("Unexpected exception while get user: ".concat(t)),this.defaultUser()}},t.prototype.setUser=function(t){return c(this,void 0,void 0,(function(){var e,r;return f(this,(function(n){try{if(!(e=G(t)))return Ur.warn("invalid user"),[2];r={command:"setUser",parameters:{user:e}},this.invocationProcessor.process(r)}catch(t){Ur.error("Unexpected exception while set user: ".concat(t))}return[2]}))}))},t.prototype.setUserId=function(t){return c(this,void 0,void 0,(function(){var e,r;return f(this,(function(n){try{if(!(e=h.sanitizeValue(t)))return Ur.warn("Invalid userId. [userId=".concat(t,"]")),[2];r={command:"setUserId",parameters:{userId:e}},this.invocationProcessor.process(r)}catch(t){Ur.error("Unexpected exception while set userId: ".concat(t))}return[2]}))}))},t.prototype.setDeviceId=function(t){return c(this,void 0,void 0,(function(){var e,r;return f(this,(function(n){try{if(!(e=h.sanitizeValue(t)))return Ur.warn("Invalid deviceId. [deviceId=".concat(t,"]")),[2];r={command:"setDeviceId",parameters:{deviceId:e}},this.invocationProcessor.process(r)}catch(t){Ur.error("Unexpected exception while set deviceId: ".concat(t))}return[2]}))}))},t.prototype.setUserProperty=function(t,e){return c(this,void 0,void 0,(function(){var r;return f(this,(function(n){try{r={command:"setUserProperty",parameters:{key:t,value:e}},this.invocationProcessor.process(r)}catch(t){Ur.error("Unexpected exception while set userProperty: ".concat(t))}return[2]}))}))},t.prototype.setUserProperties=function(t){return c(this,void 0,void 0,(function(){var e,r;return f(this,(function(n){try{e=v.sanitize(t),r=new gr,Object.entries(e).forEach((function(t){var e=t[0],n=t[1];r.set(e,n)})),this.updateUserProperties(r.build())}catch(t){Ur.error("Unexpected exception while set userProperties: ".concat(t))}return[2]}))}))},t.prototype.updateUserProperties=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){try{e={command:"updateUserProperties",parameters:{operations:t.toRecord()}},this.invocationProcessor.process(e)}catch(t){Ur.error("Unexpected exception while update userProperties: ".concat(t))}return[2]}))}))},t.prototype.resetUser=function(){return c(this,void 0,void 0,(function(){var t;return f(this,(function(e){try{t={command:"resetUser"},this.invocationProcessor.process(t)}catch(t){Ur.error("Unexpected exception while reset user: ".concat(t))}return[2]}))}))},t.prototype.variation=function(t,e,r){void 0===r&&(r="A");try{var n={command:"variation",parameters:{experimentKey:t,defaultVariation:r,user:this.convertUser(e)}},i=this.invocationProcessor.process(n);if(!i)throw new Error("invoke result data not exists");return i}catch(e){return Ur.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(r,"] : ").concat(e)),r}},t.prototype.variationDetail=function(t,e,r){var n;void 0===r&&(r="A");try{var i={command:"variationDetail",parameters:{experimentKey:t,defaultVariation:r,user:this.convertUser(e)}},o=this.invocationProcessor.process(i);if(null===o)throw new Error("invoke result data not exists");return N.of(o.variation,o.reason,new w(new Map(Object.entries(null!==(n=o.config.parameters)&&void 0!==n?n:{}))))}catch(e){return Ur.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(r,"] : ").concat(e)),N.of(r,S.EXCEPTION)}},t.prototype.isFeatureOn=function(t,e){try{var r={command:"isFeatureOn",parameters:{featureKey:t,user:this.convertUser(e)}},n=this.invocationProcessor.process(r);if(null===n)throw new Error("invoke result data not exists");return Boolean(n)}catch(e){return Ur.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),!1}},t.prototype.featureFlagDetail=function(t,e){var r;try{var n={command:"featureFlagDetail",parameters:{featureKey:t,user:this.convertUser(e)}},i=this.invocationProcessor.process(n);if(null===i)throw new Error("invoke result data not exists");return new O(i.isOn,i.reason,new w(new Map(Object.entries(null!==(r=i.config.parameters)&&void 0!==r?r:{}))),void 0)}catch(e){return Ur.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),O.off(S.EXCEPTION)}},t.prototype.track=function(t,e){try{var r={command:"track",parameters:{event:this.convertEvent(t),user:this.convertUser(e)}};this.invocationProcessor.process(r)}catch(t){Ur.error("Unexpected exception while tracking event: ".concat(t))}},t.prototype.trackPageView=function(t){Ur.info("Web to app integration feature is not support 'trackPageView' method")},t.prototype.remoteConfig=function(t){return new _r(this.invocationProcessor,this.convertUser(t))},t.prototype.onReady=function(t,e){t()},t.prototype.showUserExplorer=function(){try{this.invocationProcessor.process({command:"showUserExplorer"})}catch(t){Ur.error("Unexpected exception while show userExplorer: ".concat(t))}},t.prototype.hideUserExplorer=function(){Ur.info("Web to app integration feature is not support 'hideUserExplorer' method")},t.prototype.fetch=function(){return Promise.resolve()},t.prototype.onInitialized=function(t){return Promise.resolve({success:!0})},t.prototype.close=function(){Ur.info("Web to app integration feature is not support 'close' method")},t.prototype.convertEvent=function(t){return"string"==typeof t?{key:t}:t},t.prototype.convertUser=function(t){var e;return"string"==typeof t?t:t&&null!==(e=G(t))&&void 0!==e?e:void 0},t.prototype.defaultUser=function(){return{deviceId:Rr()}},t}(),kr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Dr=function(t){return t&&t.Math==Math&&t},Lr=Dr("object"==typeof globalThis&&globalThis)||Dr("object"==typeof window&&window)||Dr("object"==typeof self&&self)||Dr("object"==typeof kr&&kr)||function(){return this}()||Function("return this")(),Fr={},Vr=function(t){try{return!!t()}catch(t){return!0}},Gr=!Vr((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),jr=!Vr((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),Hr=jr,Br=Function.prototype.call,zr=Hr?Br.bind(Br):function(){return Br.apply(Br,arguments)},Kr={},Jr={}.propertyIsEnumerable,Yr=Object.getOwnPropertyDescriptor,qr=Yr&&!Jr.call({1:2},1);Kr.f=qr?function(t){var e=Yr(this,t);return!!e&&e.enumerable}:Jr;var Xr,Wr,$r=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Zr=jr,Qr=Function.prototype,tn=Qr.bind,en=Qr.call,rn=Zr&&tn.bind(en,en),nn=Zr?function(t){return t&&rn(t)}:function(t){return t&&function(){return en.apply(t,arguments)}},on=nn,sn=on({}.toString),un=on("".slice),an=function(t){return un(sn(t),8,-1)},cn=Vr,fn=an,pn=Object,ln=nn("".split),hn=cn((function(){return!pn("z").propertyIsEnumerable(0)}))?function(t){return"String"==fn(t)?ln(t,""):pn(t)}:pn,dn=TypeError,vn=function(t){if(null==t)throw dn("Can't call method on "+t);return t},yn=hn,gn=vn,mn=function(t){return yn(gn(t))},En=function(t){return"function"==typeof t},wn=En,Tn=function(t){return"object"==typeof t?null!==t:wn(t)},In=Lr,_n=En,An=function(t){return _n(t)?t:void 0},bn=function(t,e){return arguments.length<2?An(In[t]):In[t]&&In[t][e]},Nn=nn({}.isPrototypeOf),On=bn("navigator","userAgent")||"",Rn=Lr,Mn=On,Sn=Rn.process,Cn=Rn.Deno,xn=Sn&&Sn.versions||Cn&&Cn.version,Un=xn&&xn.v8;Un&&(Wr=(Xr=Un.split("."))[0]>0&&Xr[0]<4?1:+(Xr[0]+Xr[1])),!Wr&&Mn&&(!(Xr=Mn.match(/Edge\/(\d+)/))||Xr[1]>=74)&&(Xr=Mn.match(/Chrome\/(\d+)/))&&(Wr=+Xr[1]);var Pn=Wr,kn=Pn,Dn=Vr,Ln=!!Object.getOwnPropertySymbols&&!Dn((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&kn&&kn<41})),Fn=Ln&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Vn=bn,Gn=En,jn=Nn,Hn=Object,Bn=Fn?function(t){return"symbol"==typeof t}:function(t){var e=Vn("Symbol");return Gn(e)&&jn(e.prototype,Hn(t))},zn=String,Kn=function(t){try{return zn(t)}catch(t){return"Object"}},Jn=En,Yn=Kn,qn=TypeError,Xn=function(t){if(Jn(t))return t;throw qn(Yn(t)+" is not a function")},Wn=Xn,$n=function(t,e){var r=t[e];return null==r?void 0:Wn(r)},Zn=zr,Qn=En,ti=Tn,ei=TypeError,ri={exports:{}},ni=Lr,ii=Object.defineProperty,oi=function(t,e){try{ii(ni,t,{value:e,configurable:!0,writable:!0})}catch(r){ni[t]=e}return e},si=oi,ui="__core-js_shared__",ai=Lr[ui]||si(ui,{}),ci=ai;(ri.exports=function(t,e){return ci[t]||(ci[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.24.1",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"});var fi=vn,pi=Object,li=function(t){return pi(fi(t))},hi=li,di=nn({}.hasOwnProperty),vi=Object.hasOwn||function(t,e){return di(hi(t),e)},yi=nn,gi=0,mi=Math.random(),Ei=yi(1..toString),wi=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Ei(++gi+mi,36)},Ti=Lr,Ii=ri.exports,_i=vi,Ai=wi,bi=Ln,Ni=Fn,Oi=Ii("wks"),Ri=Ti.Symbol,Mi=Ri&&Ri.for,Si=Ni?Ri:Ri&&Ri.withoutSetter||Ai,Ci=function(t){if(!_i(Oi,t)||!bi&&"string"!=typeof Oi[t]){var e="Symbol."+t;bi&&_i(Ri,t)?Oi[t]=Ri[t]:Oi[t]=Ni&&Mi?Mi(e):Si(e)}return Oi[t]},xi=zr,Ui=Tn,Pi=Bn,ki=$n,Di=function(t,e){var r,n;if("string"===e&&Qn(r=t.toString)&&!ti(n=Zn(r,t)))return n;if(Qn(r=t.valueOf)&&!ti(n=Zn(r,t)))return n;if("string"!==e&&Qn(r=t.toString)&&!ti(n=Zn(r,t)))return n;throw ei("Can't convert object to primitive value")},Li=TypeError,Fi=Ci("toPrimitive"),Vi=function(t,e){if(!Ui(t)||Pi(t))return t;var r,n=ki(t,Fi);if(n){if(void 0===e&&(e="default"),r=xi(n,t,e),!Ui(r)||Pi(r))return r;throw Li("Can't convert object to primitive value")}return void 0===e&&(e="number"),Di(t,e)},Gi=Bn,ji=function(t){var e=Vi(t,"string");return Gi(e)?e:e+""},Hi=Tn,Bi=Lr.document,zi=Hi(Bi)&&Hi(Bi.createElement),Ki=function(t){return zi?Bi.createElement(t):{}},Ji=Ki,Yi=!Gr&&!Vr((function(){return 7!=Object.defineProperty(Ji("div"),"a",{get:function(){return 7}}).a})),qi=Gr,Xi=zr,Wi=Kr,$i=$r,Zi=mn,Qi=ji,to=vi,eo=Yi,ro=Object.getOwnPropertyDescriptor;Fr.f=qi?ro:function(t,e){if(t=Zi(t),e=Qi(e),eo)try{return ro(t,e)}catch(t){}if(to(t,e))return $i(!Xi(Wi.f,t,e),t[e])};var no={},io=Gr&&Vr((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),oo=Tn,so=String,uo=TypeError,ao=function(t){if(oo(t))return t;throw uo(so(t)+" is not an object")},co=Gr,fo=Yi,po=io,lo=ao,ho=ji,vo=TypeError,yo=Object.defineProperty,go=Object.getOwnPropertyDescriptor,mo="enumerable",Eo="configurable",wo="writable";no.f=co?po?function(t,e,r){if(lo(t),e=ho(e),lo(r),"function"==typeof t&&"prototype"===e&&"value"in r&&wo in r&&!r.writable){var n=go(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:Eo in r?r.configurable:n.configurable,enumerable:mo in r?r.enumerable:n.enumerable,writable:!1})}return yo(t,e,r)}:yo:function(t,e,r){if(lo(t),e=ho(e),lo(r),fo)try{return yo(t,e,r)}catch(t){}if("get"in r||"set"in r)throw vo("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var To=no,Io=$r,_o=Gr?function(t,e,r){return To.f(t,e,Io(1,r))}:function(t,e,r){return t[e]=r,t},Ao={exports:{}},bo=Gr,No=vi,Oo=Function.prototype,Ro=bo&&Object.getOwnPropertyDescriptor,Mo=No(Oo,"name"),So={EXISTS:Mo,PROPER:Mo&&"something"===function(){}.name,CONFIGURABLE:Mo&&(!bo||bo&&Ro(Oo,"name").configurable)},Co=En,xo=ai,Uo=nn(Function.toString);Co(xo.inspectSource)||(xo.inspectSource=function(t){return Uo(t)});var Po,ko,Do,Lo=xo.inspectSource,Fo=En,Vo=Lo,Go=Lr.WeakMap,jo=Fo(Go)&&/native code/.test(Vo(Go)),Ho=ri.exports,Bo=wi,zo=Ho("keys"),Ko=function(t){return zo[t]||(zo[t]=Bo(t))},Jo={},Yo=jo,qo=Lr,Xo=nn,Wo=Tn,$o=_o,Zo=vi,Qo=ai,ts=Ko,es=Jo,rs="Object already initialized",ns=qo.TypeError,is=qo.WeakMap;if(Yo||Qo.state){var os=Qo.state||(Qo.state=new is),ss=Xo(os.get),us=Xo(os.has),as=Xo(os.set);Po=function(t,e){if(us(os,t))throw new ns(rs);return e.facade=t,as(os,t,e),e},ko=function(t){return ss(os,t)||{}},Do=function(t){return us(os,t)}}else{var cs=ts("state");es[cs]=!0,Po=function(t,e){if(Zo(t,cs))throw new ns(rs);return e.facade=t,$o(t,cs,e),e},ko=function(t){return Zo(t,cs)?t[cs]:{}},Do=function(t){return Zo(t,cs)}}var fs={set:Po,get:ko,has:Do,enforce:function(t){return Do(t)?ko(t):Po(t,{})},getterFor:function(t){return function(e){var r;if(!Wo(e)||(r=ko(e)).type!==t)throw ns("Incompatible receiver, "+t+" required");return r}}},ps=Vr,ls=En,hs=vi,ds=Gr,vs=So.CONFIGURABLE,ys=Lo,gs=fs.enforce,ms=fs.get,Es=Object.defineProperty,ws=ds&&!ps((function(){return 8!==Es((function(){}),"length",{value:8}).length})),Ts=String(String).split("String"),Is=Ao.exports=function(t,e,r){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!hs(t,"name")||vs&&t.name!==e)&&(ds?Es(t,"name",{value:e,configurable:!0}):t.name=e),ws&&r&&hs(r,"arity")&&t.length!==r.arity&&Es(t,"length",{value:r.arity});try{r&&hs(r,"constructor")&&r.constructor?ds&&Es(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=gs(t);return hs(n,"source")||(n.source=Ts.join("string"==typeof e?e:"")),t};Function.prototype.toString=Is((function(){return ls(this)&&ms(this).source||ys(this)}),"toString");var _s=En,As=no,bs=Ao.exports,Ns=oi,Os=function(t,e,r,n){n||(n={});var i=n.enumerable,o=void 0!==n.name?n.name:e;if(_s(r)&&bs(r,o,n),n.global)i?t[e]=r:Ns(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch(t){}i?t[e]=r:As.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},Rs={},Ms=Math.ceil,Ss=Math.floor,Cs=Math.trunc||function(t){var e=+t;return(e>0?Ss:Ms)(e)},xs=function(t){var e=+t;return e!=e||0===e?0:Cs(e)},Us=xs,Ps=Math.max,ks=Math.min,Ds=function(t,e){var r=Us(t);return r<0?Ps(r+e,0):ks(r,e)},Ls=xs,Fs=Math.min,Vs=function(t){return t>0?Fs(Ls(t),9007199254740991):0},Gs=function(t){return Vs(t.length)},js=mn,Hs=Ds,Bs=Gs,zs=function(t){return function(e,r,n){var i,o=js(e),s=Bs(o),u=Hs(n,s);if(t&&r!=r){for(;s>u;)if((i=o[u++])!=i)return!0}else for(;s>u;u++)if((t||u in o)&&o[u]===r)return t||u||0;return!t&&-1}},Ks={includes:zs(!0),indexOf:zs(!1)},Js=vi,Ys=mn,qs=Ks.indexOf,Xs=Jo,Ws=nn([].push),$s=function(t,e){var r,n=Ys(t),i=0,o=[];for(r in n)!Js(Xs,r)&&Js(n,r)&&Ws(o,r);for(;e.length>i;)Js(n,r=e[i++])&&(~qs(o,r)||Ws(o,r));return o},Zs=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Qs=$s,tu=Zs.concat("length","prototype");Rs.f=Object.getOwnPropertyNames||function(t){return Qs(t,tu)};var eu={};eu.f=Object.getOwnPropertySymbols;var ru=bn,nu=Rs,iu=eu,ou=ao,su=nn([].concat),uu=ru("Reflect","ownKeys")||function(t){var e=nu.f(ou(t)),r=iu.f;return r?su(e,r(t)):e},au=vi,cu=uu,fu=Fr,pu=no,lu=function(t,e,r){for(var n=cu(e),i=pu.f,o=fu.f,s=0;s<n.length;s++){var u=n[s];au(t,u)||r&&au(r,u)||i(t,u,o(e,u))}},hu=Vr,du=En,vu=/#|\.prototype\./,yu=function(t,e){var r=mu[gu(t)];return r==wu||r!=Eu&&(du(e)?hu(e):!!e)},gu=yu.normalize=function(t){return String(t).replace(vu,".").toLowerCase()},mu=yu.data={},Eu=yu.NATIVE="N",wu=yu.POLYFILL="P",Tu=yu,Iu=Lr,_u=Fr.f,Au=_o,bu=Os,Nu=oi,Ou=lu,Ru=Tu,Mu=function(t,e){var r,n,i,o,s,u=t.target,a=t.global,c=t.stat;if(r=a?Iu:c?Iu[u]||Nu(u,{}):(Iu[u]||{}).prototype)for(n in e){if(o=e[n],i=t.dontCallGetSet?(s=_u(r,n))&&s.value:r[n],!Ru(a?n:u+(c?".":"#")+n,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;Ou(o,i)}(t.sham||i&&i.sham)&&Au(o,"sham",!0),bu(r,n,o,t)}},Su=!Vr((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Cu=vi,xu=En,Uu=li,Pu=Su,ku=Ko("IE_PROTO"),Du=Object,Lu=Du.prototype,Fu=Pu?Du.getPrototypeOf:function(t){var e=Uu(t);if(Cu(e,ku))return e[ku];var r=e.constructor;return xu(r)&&e instanceof r?r.prototype:e instanceof Du?Lu:null},Vu=En,Gu=String,ju=TypeError,Hu=nn,Bu=ao,zu=function(t){if("object"==typeof t||Vu(t))return t;throw ju("Can't set "+Gu(t)+" as a prototype")},Ku=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Hu(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return Bu(r),zu(n),e?t(r,n):r.__proto__=n,r}}():void 0),Ju={},Yu=$s,qu=Zs,Xu=Object.keys||function(t){return Yu(t,qu)},Wu=Gr,$u=io,Zu=no,Qu=ao,ta=mn,ea=Xu;Ju.f=Wu&&!$u?Object.defineProperties:function(t,e){Qu(t);for(var r,n=ta(e),i=ea(e),o=i.length,s=0;o>s;)Zu.f(t,r=i[s++],n[r]);return t};var ra,na=bn("document","documentElement"),ia=ao,oa=Ju,sa=Zs,ua=Jo,aa=na,ca=Ki,fa=Ko("IE_PROTO"),pa=function(){},la=function(t){return"<script>"+t+"</"+"script>"},ha=function(t){t.write(la("")),t.close();var e=t.parentWindow.Object;return t=null,e},da=function(){try{ra=new ActiveXObject("htmlfile")}catch(t){}var t,e;da="undefined"!=typeof document?document.domain&&ra?ha(ra):((e=ca("iframe")).style.display="none",aa.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(la("document.F=Object")),t.close(),t.F):ha(ra);for(var r=sa.length;r--;)delete da.prototype[sa[r]];return da()};ua[fa]=!0;var va=Object.create||function(t,e){var r;return null!==t?(pa.prototype=ia(t),r=new pa,pa.prototype=null,r[fa]=t):r=da(),void 0===e?r:oa.f(r,e)},ya=Error,ga=nn("".replace),ma=String(ya("zxcasd").stack),Ea=/\n\s*at [^:]*:[^\n]*/,wa=Ea.test(ma),Ta=Tn,Ia=_o,_a=Xn,Aa=jr,ba=nn(nn.bind),Na=function(t,e){return _a(t),void 0===e?t:Aa?ba(t,e):function(){return t.apply(e,arguments)}},Oa={},Ra=Oa,Ma=Ci("iterator"),Sa=Array.prototype,Ca=function(t){return void 0!==t&&(Ra.Array===t||Sa[Ma]===t)},xa={};xa[Ci("toStringTag")]="z";var Ua="[object z]"===String(xa),Pa=Ua,ka=En,Da=an,La=Ci("toStringTag"),Fa=Object,Va="Arguments"==Da(function(){return arguments}()),Ga=Pa?Da:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Fa(t),La))?r:Va?Da(e):"Object"==(n=Da(e))&&ka(e.callee)?"Arguments":n},ja=Ga,Ha=$n,Ba=Oa,za=Ci("iterator"),Ka=function(t){if(null!=t)return Ha(t,za)||Ha(t,"@@iterator")||Ba[ja(t)]},Ja=zr,Ya=Xn,qa=ao,Xa=Kn,Wa=Ka,$a=TypeError,Za=function(t,e){var r=arguments.length<2?Wa(t):e;if(Ya(r))return qa(Ja(r,t));throw $a(Xa(t)+" is not iterable")},Qa=zr,tc=ao,ec=$n,rc=function(t,e,r){var n,i;tc(t);try{if(!(n=ec(t,"return"))){if("throw"===e)throw r;return r}n=Qa(n,t)}catch(t){i=!0,n=t}if("throw"===e)throw r;if(i)throw n;return tc(n),r},nc=Na,ic=zr,oc=ao,sc=Kn,uc=Ca,ac=Gs,cc=Nn,fc=Za,pc=Ka,lc=rc,hc=TypeError,dc=function(t,e){this.stopped=t,this.result=e},vc=dc.prototype,yc=function(t,e,r){var n,i,o,s,u,a,c,f=r&&r.that,p=!(!r||!r.AS_ENTRIES),l=!(!r||!r.IS_RECORD),h=!(!r||!r.IS_ITERATOR),d=!(!r||!r.INTERRUPTED),v=nc(e,f),y=function(t){return n&&lc(n,"normal",t),new dc(!0,t)},g=function(t){return p?(oc(t),d?v(t[0],t[1],y):v(t[0],t[1])):d?v(t,y):v(t)};if(l)n=t.iterator;else if(h)n=t;else{if(!(i=pc(t)))throw hc(sc(t)+" is not iterable");if(uc(i)){for(o=0,s=ac(t);s>o;o++)if((u=g(t[o]))&&cc(vc,u))return u;return new dc(!1)}n=fc(t,i)}for(a=l?t.next:n.next;!(c=ic(a,n)).done;){try{u=g(c.value)}catch(t){lc(n,"throw",t)}if("object"==typeof u&&u&&cc(vc,u))return u}return new dc(!1)},gc=Ga,mc=String,Ec=function(t){if("Symbol"===gc(t))throw TypeError("Cannot convert a Symbol value to a string");return mc(t)},wc=Ec,Tc=$r,Ic=!Vr((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",Tc(1,7)),7!==t.stack)})),_c=Mu,Ac=Nn,bc=Fu,Nc=Ku,Oc=lu,Rc=va,Mc=_o,Sc=$r,Cc=function(t,e){if(wa&&"string"==typeof t&&!ya.prepareStackTrace)for(;e--;)t=ga(t,Ea,"");return t},xc=function(t,e){Ta(e)&&"cause"in e&&Ia(t,"cause",e.cause)},Uc=yc,Pc=function(t,e){return void 0===t?arguments.length<2?"":e:wc(t)},kc=Ic,Dc=Ci("toStringTag"),Lc=Error,Fc=[].push,Vc=function(t,e){var r,n=arguments.length>2?arguments[2]:void 0,i=Ac(Gc,this);Nc?r=Nc(new Lc,i?bc(this):Gc):(r=i?this:Rc(Gc),Mc(r,Dc,"Error")),void 0!==e&&Mc(r,"message",Pc(e)),kc&&Mc(r,"stack",Cc(r.stack,1)),xc(r,n);var o=[];return Uc(t,Fc,{that:o}),Mc(r,"errors",o),r};Nc?Nc(Vc,Lc):Oc(Vc,Lc,{name:!0});var Gc=Vc.prototype=Rc(Lc.prototype,{constructor:Sc(1,Vc),message:Sc(1,""),name:Sc(1,"AggregateError")});_c({global:!0,constructor:!0,arity:2},{AggregateError:Vc});var jc=Ci,Hc=va,Bc=no.f,zc=jc("unscopables"),Kc=Array.prototype;null==Kc[zc]&&Bc(Kc,zc,{configurable:!0,value:Hc(null)});var Jc,Yc,qc,Xc=function(t){Kc[zc][t]=!0},Wc=Vr,$c=En,Zc=Fu,Qc=Os,tf=Ci("iterator"),ef=!1;[].keys&&("next"in(qc=[].keys())?(Yc=Zc(Zc(qc)))!==Object.prototype&&(Jc=Yc):ef=!0);var rf=null==Jc||Wc((function(){var t={};return Jc[tf].call(t)!==t}));rf&&(Jc={}),$c(Jc[tf])||Qc(Jc,tf,(function(){return this}));var nf={IteratorPrototype:Jc,BUGGY_SAFARI_ITERATORS:ef},of=no.f,sf=vi,uf=Ci("toStringTag"),af=function(t,e,r){t&&!r&&(t=t.prototype),t&&!sf(t,uf)&&of(t,uf,{configurable:!0,value:e})},cf=nf.IteratorPrototype,ff=va,pf=$r,lf=af,hf=Oa,df=function(){return this},vf=Mu,yf=zr,gf=En,mf=function(t,e,r,n){var i=e+" Iterator";return t.prototype=ff(cf,{next:pf(+!n,r)}),lf(t,i,!1),hf[i]=df,t},Ef=Fu,wf=Ku,Tf=af,If=_o,_f=Os,Af=Oa,bf=So.PROPER,Nf=So.CONFIGURABLE,Of=nf.IteratorPrototype,Rf=nf.BUGGY_SAFARI_ITERATORS,Mf=Ci("iterator"),Sf="keys",Cf="values",xf="entries",Uf=function(){return this},Pf=function(t,e,r,n,i,o,s){mf(r,e,n);var u,a,c,f=function(t){if(t===i&&v)return v;if(!Rf&&t in h)return h[t];switch(t){case Sf:case Cf:case xf:return function(){return new r(this,t)}}return function(){return new r(this)}},p=e+" Iterator",l=!1,h=t.prototype,d=h[Mf]||h["@@iterator"]||i&&h[i],v=!Rf&&d||f(i),y="Array"==e&&h.entries||d;if(y&&(u=Ef(y.call(new t)))!==Object.prototype&&u.next&&(Ef(u)!==Of&&(wf?wf(u,Of):gf(u[Mf])||_f(u,Mf,Uf)),Tf(u,p,!0)),bf&&i==Cf&&d&&d.name!==Cf&&(Nf?If(h,"name",Cf):(l=!0,v=function(){return yf(d,this)})),i)if(a={values:f(Cf),keys:o?v:f(Sf),entries:f(xf)},s)for(c in a)(Rf||l||!(c in h))&&_f(h,c,a[c]);else vf({target:e,proto:!0,forced:Rf||l},a);return h[Mf]!==v&&_f(h,Mf,v,{name:i}),Af[e]=v,a},kf=mn,Df=Xc,Lf=Oa,Ff=fs,Vf=no.f,Gf=Pf,jf=Gr,Hf="Array Iterator",Bf=Ff.set,zf=Ff.getterFor(Hf),Kf=Gf(Array,"Array",(function(t,e){Bf(this,{type:Hf,target:kf(t),index:0,kind:e})}),(function(){var t=zf(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values"),Jf=Lf.Arguments=Lf.Array;if(Df("keys"),Df("values"),Df("entries"),jf&&"values"!==Jf.name)try{Vf(Jf,"name",{value:"values"})}catch(t){}var Yf=Ga,qf=Ua?{}.toString:function(){return"[object "+Yf(this)+"]"};Ua||Os(Object.prototype,"toString",qf,{unsafe:!0});var Xf="process"==an(Lr.process),Wf=bn,$f=no,Zf=Gr,Qf=Ci("species"),tp=function(t){var e=Wf(t),r=$f.f;Zf&&e&&!e[Qf]&&r(e,Qf,{configurable:!0,get:function(){return this}})},ep=Nn,rp=TypeError,np=function(t,e){if(ep(e,t))return t;throw rp("Incorrect invocation")},ip=nn,op=Vr,sp=En,up=Ga,ap=Lo,cp=function(){},fp=[],pp=bn("Reflect","construct"),lp=/^\s*(?:class|function)\b/,hp=ip(lp.exec),dp=!lp.exec(cp),vp=function(t){if(!sp(t))return!1;try{return pp(cp,fp,t),!0}catch(t){return!1}},yp=function(t){if(!sp(t))return!1;switch(up(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return dp||!!hp(lp,ap(t))}catch(t){return!0}};yp.sham=!0;var gp,mp,Ep,wp,Tp=!pp||op((function(){var t;return vp(vp.call)||!vp(Object)||!vp((function(){t=!0}))||t}))?yp:vp,Ip=Tp,_p=Kn,Ap=TypeError,bp=ao,Np=function(t){if(Ip(t))return t;throw Ap(_p(t)+" is not a constructor")},Op=Ci("species"),Rp=function(t,e){var r,n=bp(t).constructor;return void 0===n||null==(r=bp(n)[Op])?e:Np(r)},Mp=jr,Sp=Function.prototype,Cp=Sp.apply,xp=Sp.call,Up="object"==typeof Reflect&&Reflect.apply||(Mp?xp.bind(Cp):function(){return xp.apply(Cp,arguments)}),Pp=nn([].slice),kp=TypeError,Dp=/(?:ipad|iphone|ipod).*applewebkit/i.test(On),Lp=Lr,Fp=Up,Vp=Na,Gp=En,jp=vi,Hp=Vr,Bp=na,zp=Pp,Kp=Ki,Jp=function(t,e){if(t<e)throw kp("Not enough arguments");return t},Yp=Dp,qp=Xf,Xp=Lp.setImmediate,Wp=Lp.clearImmediate,$p=Lp.process,Zp=Lp.Dispatch,Qp=Lp.Function,tl=Lp.MessageChannel,el=Lp.String,rl=0,nl={},il="onreadystatechange";try{gp=Lp.location}catch(t){}var ol=function(t){if(jp(nl,t)){var e=nl[t];delete nl[t],e()}},sl=function(t){return function(){ol(t)}},ul=function(t){ol(t.data)},al=function(t){Lp.postMessage(el(t),gp.protocol+"//"+gp.host)};Xp&&Wp||(Xp=function(t){Jp(arguments.length,1);var e=Gp(t)?t:Qp(t),r=zp(arguments,1);return nl[++rl]=function(){Fp(e,void 0,r)},mp(rl),rl},Wp=function(t){delete nl[t]},qp?mp=function(t){$p.nextTick(sl(t))}:Zp&&Zp.now?mp=function(t){Zp.now(sl(t))}:tl&&!Yp?(wp=(Ep=new tl).port2,Ep.port1.onmessage=ul,mp=Vp(wp.postMessage,wp)):Lp.addEventListener&&Gp(Lp.postMessage)&&!Lp.importScripts&&gp&&"file:"!==gp.protocol&&!Hp(al)?(mp=al,Lp.addEventListener("message",ul,!1)):mp=il in Kp("script")?function(t){Bp.appendChild(Kp("script")).onreadystatechange=function(){Bp.removeChild(this),ol(t)}}:function(t){setTimeout(sl(t),0)});var cl,fl,pl,ll,hl,dl,vl,yl,gl={set:Xp,clear:Wp},ml=Lr,El=/ipad|iphone|ipod/i.test(On)&&void 0!==ml.Pebble,wl=/web0s(?!.*chrome)/i.test(On),Tl=Lr,Il=Na,_l=Fr.f,Al=gl.set,bl=Dp,Nl=El,Ol=wl,Rl=Xf,Ml=Tl.MutationObserver||Tl.WebKitMutationObserver,Sl=Tl.document,Cl=Tl.process,xl=Tl.Promise,Ul=_l(Tl,"queueMicrotask"),Pl=Ul&&Ul.value;Pl||(cl=function(){var t,e;for(Rl&&(t=Cl.domain)&&t.exit();fl;){e=fl.fn,fl=fl.next;try{e()}catch(t){throw fl?ll():pl=void 0,t}}pl=void 0,t&&t.enter()},bl||Rl||Ol||!Ml||!Sl?!Nl&&xl&&xl.resolve?((vl=xl.resolve(void 0)).constructor=xl,yl=Il(vl.then,vl),ll=function(){yl(cl)}):Rl?ll=function(){Cl.nextTick(cl)}:(Al=Il(Al,Tl),ll=function(){Al(cl)}):(hl=!0,dl=Sl.createTextNode(""),new Ml(cl).observe(dl,{characterData:!0}),ll=function(){dl.data=hl=!hl}));var kl=Pl||function(t){var e={fn:t,next:void 0};pl&&(pl.next=e),fl||(fl=e,ll()),pl=e},Dl=Lr,Ll=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Fl=function(){this.head=null,this.tail=null};Fl.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var Vl=Fl,Gl=Lr.Promise,jl="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Hl=!jl&&!Xf&&"object"==typeof window&&"object"==typeof document,Bl=Lr,zl=Gl,Kl=En,Jl=Tu,Yl=Lo,ql=Ci,Xl=Hl,Wl=jl,$l=Pn;zl&&zl.prototype;var Zl=ql("species"),Ql=!1,th=Kl(Bl.PromiseRejectionEvent),eh=Jl("Promise",(function(){var t=Yl(zl),e=t!==String(zl);if(!e&&66===$l)return!0;if(!$l||$l<51||!/native code/.test(t)){var r=new zl((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Zl]=n,!(Ql=r.then((function(){}))instanceof n))return!0}return!e&&(Xl||Wl)&&!th})),rh={CONSTRUCTOR:eh,REJECTION_EVENT:th,SUBCLASSING:Ql},nh={},ih=Xn,oh=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n})),this.resolve=ih(e),this.reject=ih(r)};nh.f=function(t){return new oh(t)};var sh,uh,ah,ch=Mu,fh=Xf,ph=Lr,lh=zr,hh=Os,dh=Ku,vh=af,yh=tp,gh=Xn,mh=En,Eh=Tn,wh=np,Th=Rp,Ih=gl.set,_h=kl,Ah=function(t,e){var r=Dl.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))},bh=Ll,Nh=Vl,Oh=fs,Rh=Gl,Mh=nh,Sh="Promise",Ch=rh.CONSTRUCTOR,xh=rh.REJECTION_EVENT,Uh=rh.SUBCLASSING,Ph=Oh.getterFor(Sh),kh=Oh.set,Dh=Rh&&Rh.prototype,Lh=Rh,Fh=Dh,Vh=ph.TypeError,Gh=ph.document,jh=ph.process,Hh=Mh.f,Bh=Hh,zh=!!(Gh&&Gh.createEvent&&ph.dispatchEvent),Kh="unhandledrejection",Jh=function(t){var e;return!(!Eh(t)||!mh(e=t.then))&&e},Yh=function(t,e){var r,n,i,o=e.value,s=1==e.state,u=s?t.ok:t.fail,a=t.resolve,c=t.reject,f=t.domain;try{u?(s||(2===e.rejection&&Zh(e),e.rejection=1),!0===u?r=o:(f&&f.enter(),r=u(o),f&&(f.exit(),i=!0)),r===t.promise?c(Vh("Promise-chain cycle")):(n=Jh(r))?lh(n,r,a,c):a(r)):c(o)}catch(t){f&&!i&&f.exit(),c(t)}},qh=function(t,e){t.notified||(t.notified=!0,_h((function(){for(var r,n=t.reactions;r=n.get();)Yh(r,t);t.notified=!1,e&&!t.rejection&&Wh(t)})))},Xh=function(t,e,r){var n,i;zh?((n=Gh.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),ph.dispatchEvent(n)):n={promise:e,reason:r},!xh&&(i=ph["on"+t])?i(n):t===Kh&&Ah("Unhandled promise rejection",r)},Wh=function(t){lh(Ih,ph,(function(){var e,r=t.facade,n=t.value;if($h(t)&&(e=bh((function(){fh?jh.emit("unhandledRejection",n,r):Xh(Kh,r,n)})),t.rejection=fh||$h(t)?2:1,e.error))throw e.value}))},$h=function(t){return 1!==t.rejection&&!t.parent},Zh=function(t){lh(Ih,ph,(function(){var e=t.facade;fh?jh.emit("rejectionHandled",e):Xh("rejectionhandled",e,t.value)}))},Qh=function(t,e,r){return function(n){t(e,n,r)}},td=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,qh(t,!0))},ed=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Vh("Promise can't be resolved itself");var n=Jh(e);n?_h((function(){var r={done:!1};try{lh(n,e,Qh(ed,r,t),Qh(td,r,t))}catch(e){td(r,e,t)}})):(t.value=e,t.state=1,qh(t,!1))}catch(e){td({done:!1},e,t)}}};if(Ch&&(Fh=(Lh=function(t){wh(this,Fh),gh(t),lh(sh,this);var e=Ph(this);try{t(Qh(ed,e),Qh(td,e))}catch(t){td(e,t)}}).prototype,(sh=function(t){kh(this,{type:Sh,done:!1,notified:!1,parent:!1,reactions:new Nh,rejection:!1,state:0,value:void 0})}).prototype=hh(Fh,"then",(function(t,e){var r=Ph(this),n=Hh(Th(this,Lh));return r.parent=!0,n.ok=!mh(t)||t,n.fail=mh(e)&&e,n.domain=fh?jh.domain:void 0,0==r.state?r.reactions.add(n):_h((function(){Yh(n,r)})),n.promise})),uh=function(){var t=new sh,e=Ph(t);this.promise=t,this.resolve=Qh(ed,e),this.reject=Qh(td,e)},Mh.f=Hh=function(t){return t===Lh||undefined===t?new uh(t):Bh(t)},mh(Rh)&&Dh!==Object.prototype)){ah=Dh.then,Uh||hh(Dh,"then",(function(t,e){var r=this;return new Lh((function(t,e){lh(ah,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete Dh.constructor}catch(t){}dh&&dh(Dh,Fh)}ch({global:!0,constructor:!0,wrap:!0,forced:Ch},{Promise:Lh}),vh(Lh,Sh,!1),yh(Sh);var rd=Ci("iterator"),nd=!1;try{var id=0,od={next:function(){return{done:!!id++}},return:function(){nd=!0}};od[rd]=function(){return this},Array.from(od,(function(){throw 2}))}catch(t){}var sd=function(t,e){if(!e&&!nd)return!1;var r=!1;try{var n={};n[rd]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},ud=Gl,ad=rh.CONSTRUCTOR||!sd((function(t){ud.all(t).then(void 0,(function(){}))})),cd=zr,fd=Xn,pd=nh,ld=Ll,hd=yc;Mu({target:"Promise",stat:!0,forced:ad},{all:function(t){var e=this,r=pd.f(e),n=r.resolve,i=r.reject,o=ld((function(){var r=fd(e.resolve),o=[],s=0,u=1;hd(t,(function(t){var a=s++,c=!1;u++,cd(r,e,t).then((function(t){c||(c=!0,o[a]=t,--u||n(o))}),i)})),--u||n(o)}));return o.error&&i(o.value),r.promise}});var dd=Mu,vd=rh.CONSTRUCTOR,yd=Gl,gd=bn,md=En,Ed=Os,wd=yd&&yd.prototype;if(dd({target:"Promise",proto:!0,forced:vd,real:!0},{catch:function(t){return this.then(void 0,t)}}),md(yd)){var Td=gd("Promise").prototype.catch;wd.catch!==Td&&Ed(wd,"catch",Td,{unsafe:!0})}var Id=zr,_d=Xn,Ad=nh,bd=Ll,Nd=yc;Mu({target:"Promise",stat:!0,forced:ad},{race:function(t){var e=this,r=Ad.f(e),n=r.reject,i=bd((function(){var i=_d(e.resolve);Nd(t,(function(t){Id(i,e,t).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var Od=zr,Rd=nh;Mu({target:"Promise",stat:!0,forced:rh.CONSTRUCTOR},{reject:function(t){var e=Rd.f(this);return Od(e.reject,void 0,t),e.promise}});var Md=ao,Sd=Tn,Cd=nh,xd=function(t,e){if(Md(t),Sd(e)&&e.constructor===t)return e;var r=Cd.f(t);return(0,r.resolve)(e),r.promise},Ud=Mu,Pd=rh.CONSTRUCTOR,kd=xd;bn("Promise"),Ud({target:"Promise",stat:!0,forced:Pd},{resolve:function(t){return kd(this,t)}});var Dd=zr,Ld=Xn,Fd=nh,Vd=Ll,Gd=yc;Mu({target:"Promise",stat:!0},{allSettled:function(t){var e=this,r=Fd.f(e),n=r.resolve,i=r.reject,o=Vd((function(){var r=Ld(e.resolve),i=[],o=0,s=1;Gd(t,(function(t){var u=o++,a=!1;s++,Dd(r,e,t).then((function(t){a||(a=!0,i[u]={status:"fulfilled",value:t},--s||n(i))}),(function(t){a||(a=!0,i[u]={status:"rejected",reason:t},--s||n(i))}))})),--s||n(i)}));return o.error&&i(o.value),r.promise}});var jd=zr,Hd=Xn,Bd=bn,zd=nh,Kd=Ll,Jd=yc,Yd="No one promise resolved";Mu({target:"Promise",stat:!0},{any:function(t){var e=this,r=Bd("AggregateError"),n=zd.f(e),i=n.resolve,o=n.reject,s=Kd((function(){var n=Hd(e.resolve),s=[],u=0,a=1,c=!1;Jd(t,(function(t){var f=u++,p=!1;a++,jd(n,e,t).then((function(t){p||c||(c=!0,i(t))}),(function(t){p||c||(p=!0,s[f]=t,--a||o(new r(s,Yd)))}))})),--a||o(new r(s,Yd))}));return s.error&&o(s.value),n.promise}});var qd=Mu,Xd=Gl,Wd=Vr,$d=bn,Zd=En,Qd=Rp,tv=xd,ev=Os,rv=Xd&&Xd.prototype;if(qd({target:"Promise",proto:!0,real:!0,forced:!!Xd&&Wd((function(){rv.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=Qd(this,$d("Promise")),r=Zd(t);return this.then(r?function(r){return tv(e,t()).then((function(){return r}))}:t,r?function(r){return tv(e,t()).then((function(){throw r}))}:t)}}),Zd(Xd)){var nv=$d("Promise").prototype.finally;rv.finally!==nv&&ev(rv,"finally",nv,{unsafe:!0})}var iv=nn,ov=xs,sv=Ec,uv=vn,av=iv("".charAt),cv=iv("".charCodeAt),fv=iv("".slice),pv=function(t){return function(e,r){var n,i,o=sv(uv(e)),s=ov(r),u=o.length;return s<0||s>=u?t?"":void 0:(n=cv(o,s))<55296||n>56319||s+1===u||(i=cv(o,s+1))<56320||i>57343?t?av(o,s):n:t?fv(o,s,s+2):i-56320+(n-55296<<10)+65536}},lv={codeAt:pv(!1),charAt:pv(!0)}.charAt,hv=Ec,dv=fs,vv=Pf,yv="String Iterator",gv=dv.set,mv=dv.getterFor(yv);vv(String,"String",(function(t){gv(this,{type:yv,string:hv(t),index:0})}),(function(){var t,e=mv(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=lv(r,n),e.index+=t.length,{value:t,done:!1})}));var Ev=Lr,wv=Ev.Promise,Tv=Ki("span").classList,Iv=Tv&&Tv.constructor&&Tv.constructor.prototype,_v=Iv===Object.prototype?void 0:Iv,Av=Lr,bv={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Nv=_v,Ov=Kf,Rv=_o,Mv=Ci,Sv=Mv("iterator"),Cv=Mv("toStringTag"),xv=Ov.values,Uv=function(t,e){if(t){if(t[Sv]!==xv)try{Rv(t,Sv,xv)}catch(e){t[Sv]=xv}if(t[Cv]||Rv(t,Cv,e),bv[e])for(var r in Ov)if(t[r]!==Ov[r])try{Rv(t,r,Ov[r])}catch(e){t[r]=Ov[r]}}};for(var Pv in bv)Uv(Av[Pv]&&Av[Pv].prototype,Pv);Uv(Nv,"DOMTokenList");var kv=wv,Dv=nh,Lv=Ll;Mu({target:"Promise",stat:!0,forced:!0},{try:function(t){var e=Dv.f(this),r=Lv(t);return(r.error?e.reject:e.resolve)(r.value),e.promise}});var Fv=kv;!function(t){t.exports=Fv}({exports:{}});var Vv=ao,Gv=rc,jv=ji,Hv=no,Bv=$r,zv=function(t,e,r){var n=jv(e);n in t?Hv.f(t,n,Bv(0,r)):t[n]=r},Kv=Na,Jv=zr,Yv=li,qv=function(t,e,r,n){try{return n?e(Vv(r)[0],r[1]):e(r)}catch(e){Gv(t,"throw",e)}},Xv=Ca,Wv=Tp,$v=Gs,Zv=zv,Qv=Za,ty=Ka,ey=Array,ry=function(t){var e=Yv(t),r=Wv(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=void 0!==i;o&&(i=Kv(i,n>2?arguments[2]:void 0));var s,u,a,c,f,p,l=ty(e),h=0;if(!l||this===ey&&Xv(l))for(s=$v(e),u=r?new this(s):ey(s);s>h;h++)p=o?i(e[h],h):e[h],Zv(u,h,p);else for(f=(c=Qv(e,l)).next,u=r?new this:[];!(a=Jv(f,c)).done;h++)p=o?qv(c,i,[a.value,h],!0):a.value,Zv(u,h,p);return u.length=h,u};Mu({target:"Array",stat:!0,forced:!sd((function(t){Array.from(t)}))},{from:ry});var ny=an,iy=Array.isArray||function(t){return"Array"==ny(t)};Mu({target:"Array",stat:!0},{isArray:iy});var oy=Tp,sy=zv,uy=Array;Mu({target:"Array",stat:!0,forced:Vr((function(){function t(){}return!(uy.of.call(t)instanceof t)}))},{of:function(){for(var t=0,e=arguments.length,r=new(oy(this)?this:uy)(e);e>t;)sy(r,t,arguments[t++]);return r.length=e,r}});var ay=li,cy=Gs,fy=xs,py=Xc;Mu({target:"Array",proto:!0},{at:function(t){var e=ay(this),r=cy(e),n=fy(t),i=n>=0?n:r+n;return i<0||i>=r?void 0:e[i]}}),py("at");var ly=TypeError,hy=function(t){if(t>9007199254740991)throw ly("Maximum allowed index exceeded");return t},dy=iy,vy=Tp,yy=Tn,gy=Ci("species"),my=Array,Ey=function(t){var e;return dy(t)&&(e=t.constructor,(vy(e)&&(e===my||dy(e.prototype))||yy(e)&&null===(e=e[gy]))&&(e=void 0)),void 0===e?my:e},wy=function(t,e){return new(Ey(t))(0===e?0:e)},Ty=Vr,Iy=Pn,_y=Ci("species"),Ay=function(t){return Iy>=51||!Ty((function(){var e=[];return(e.constructor={})[_y]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},by=Mu,Ny=Vr,Oy=iy,Ry=Tn,My=li,Sy=Gs,Cy=hy,xy=zv,Uy=wy,Py=Ay,ky=Pn,Dy=Ci("isConcatSpreadable"),Ly=ky>=51||!Ny((function(){var t=[];return t[Dy]=!1,t.concat()[0]!==t})),Fy=Py("concat"),Vy=function(t){if(!Ry(t))return!1;var e=t[Dy];return void 0!==e?!!e:Oy(t)};by({target:"Array",proto:!0,arity:1,forced:!Ly||!Fy},{concat:function(t){var e,r,n,i,o,s=My(this),u=Uy(s,0),a=0;for(e=-1,n=arguments.length;e<n;e++)if(Vy(o=-1===e?s:arguments[e]))for(i=Sy(o),Cy(a+i),r=0;r<i;r++,a++)r in o&&xy(u,a,o[r]);else Cy(a+1),xy(u,a++,o);return u.length=a,u}});var Gy=Kn,jy=TypeError,Hy=function(t,e){if(!delete t[e])throw jy("Cannot delete property "+Gy(e)+" of "+Gy(t))},By=li,zy=Ds,Ky=Gs,Jy=Hy,Yy=Math.min,qy=[].copyWithin||function(t,e){var r=By(this),n=Ky(r),i=zy(t,n),o=zy(e,n),s=arguments.length>2?arguments[2]:void 0,u=Yy((void 0===s?n:zy(s,n))-o,n-i),a=1;for(o<i&&i<o+u&&(a=-1,o+=u-1,i+=u-1);u-- >0;)o in r?r[i]=r[o]:Jy(r,i),i+=a,o+=a;return r},Xy=Xc;Mu({target:"Array",proto:!0},{copyWithin:qy}),Xy("copyWithin");var Wy=Na,$y=hn,Zy=li,Qy=Gs,tg=wy,eg=nn([].push),rg=function(t){var e=1==t,r=2==t,n=3==t,i=4==t,o=6==t,s=7==t,u=5==t||o;return function(a,c,f,p){for(var l,h,d=Zy(a),v=$y(d),y=Wy(c,f),g=Qy(v),m=0,E=p||tg,w=e?E(a,g):r||s?E(a,0):void 0;g>m;m++)if((u||m in v)&&(h=y(l=v[m],m,d),t))if(e)w[m]=h;else if(h)switch(t){case 3:return!0;case 5:return l;case 6:return m;case 2:eg(w,l)}else switch(t){case 4:return!1;case 7:eg(w,l)}return o?-1:n||i?i:w}},ng={forEach:rg(0),map:rg(1),filter:rg(2),some:rg(3),every:rg(4),find:rg(5),findIndex:rg(6),filterReject:rg(7)},ig=Vr,og=function(t,e){var r=[][t];return!!r&&ig((function(){r.call(null,e||function(){return 1},1)}))},sg=ng.every;Mu({target:"Array",proto:!0,forced:!og("every")},{every:function(t){return sg(this,t,arguments.length>1?arguments[1]:void 0)}});var ug=li,ag=Ds,cg=Gs,fg=function(t){for(var e=ug(this),r=cg(e),n=arguments.length,i=ag(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,s=void 0===o?r:ag(o,r);s>i;)e[i++]=t;return e},pg=Xc;Mu({target:"Array",proto:!0},{fill:fg}),pg("fill");var lg=ng.filter;Mu({target:"Array",proto:!0,forced:!Ay("filter")},{filter:function(t){return lg(this,t,arguments.length>1?arguments[1]:void 0)}});var hg=Mu,dg=ng.find,vg=Xc,yg="find",gg=!0;yg in[]&&Array(1).find((function(){gg=!1})),hg({target:"Array",proto:!0,forced:gg},{find:function(t){return dg(this,t,arguments.length>1?arguments[1]:void 0)}}),vg(yg);var mg=Mu,Eg=ng.findIndex,wg=Xc,Tg="findIndex",Ig=!0;Tg in[]&&Array(1).findIndex((function(){Ig=!1})),mg({target:"Array",proto:!0,forced:Ig},{findIndex:function(t){return Eg(this,t,arguments.length>1?arguments[1]:void 0)}}),wg(Tg);var _g=Na,Ag=hn,bg=li,Ng=Gs,Og=function(t){var e=1==t;return function(r,n,i){for(var o,s=bg(r),u=Ag(s),a=_g(n,i),c=Ng(u);c-- >0;)if(a(o=u[c],c,s))switch(t){case 0:return o;case 1:return c}return e?-1:void 0}},Rg={findLast:Og(0),findLastIndex:Og(1)},Mg=Rg.findLast,Sg=Xc;Mu({target:"Array",proto:!0},{findLast:function(t){return Mg(this,t,arguments.length>1?arguments[1]:void 0)}}),Sg("findLast");var Cg=Rg.findLastIndex,xg=Xc;Mu({target:"Array",proto:!0},{findLastIndex:function(t){return Cg(this,t,arguments.length>1?arguments[1]:void 0)}}),xg("findLastIndex");var Ug=iy,Pg=Gs,kg=hy,Dg=Na,Lg=function(t,e,r,n,i,o,s,u){for(var a,c,f=i,p=0,l=!!s&&Dg(s,u);p<n;)p in r&&(a=l?l(r[p],p,e):r[p],o>0&&Ug(a)?(c=Pg(a),f=Lg(t,e,a,c,f,o-1)-1):(kg(f+1),t[f]=a),f++),p++;return f},Fg=Lg,Vg=Fg,Gg=li,jg=Gs,Hg=xs,Bg=wy;Mu({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=Gg(this),r=jg(e),n=Bg(e,0);return n.length=Vg(n,e,e,r,0,void 0===t?1:Hg(t)),n}});var zg=Fg,Kg=Xn,Jg=li,Yg=Gs,qg=wy;Mu({target:"Array",proto:!0},{flatMap:function(t){var e,r=Jg(this),n=Yg(r);return Kg(t),(e=qg(r,0)).length=zg(e,r,r,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var Xg=ng.forEach,Wg=og("forEach")?[].forEach:function(t){return Xg(this,t,arguments.length>1?arguments[1]:void 0)};Mu({target:"Array",proto:!0,forced:[].forEach!=Wg},{forEach:Wg});var $g=Ks.includes,Zg=Xc;Mu({target:"Array",proto:!0,forced:Vr((function(){return!Array(1).includes()}))},{includes:function(t){return $g(this,t,arguments.length>1?arguments[1]:void 0)}}),Zg("includes");var Qg=Mu,tm=Ks.indexOf,em=og,rm=nn([].indexOf),nm=!!rm&&1/rm([1],1,-0)<0,im=em("indexOf");Qg({target:"Array",proto:!0,forced:nm||!im},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return nm?rm(this,t,e)||0:tm(this,t,e)}});var om=Mu,sm=hn,um=mn,am=og,cm=nn([].join),fm=sm!=Object,pm=am("join",",");om({target:"Array",proto:!0,forced:fm||!pm},{join:function(t){return cm(um(this),void 0===t?",":t)}});var lm=Up,hm=mn,dm=xs,vm=Gs,ym=og,gm=Math.min,mm=[].lastIndexOf,Em=!!mm&&1/[1].lastIndexOf(1,-0)<0,wm=ym("lastIndexOf"),Tm=Em||!wm?function(t){if(Em)return lm(mm,this,arguments)||0;var e=hm(this),r=vm(e),n=r-1;for(arguments.length>1&&(n=gm(n,dm(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:mm;Mu({target:"Array",proto:!0,forced:Tm!==[].lastIndexOf},{lastIndexOf:Tm});var Im=ng.map;Mu({target:"Array",proto:!0,forced:!Ay("map")},{map:function(t){return Im(this,t,arguments.length>1?arguments[1]:void 0)}});var _m=Mu,Am=li,bm=Gs,Nm=hy,Om=Vr((function(){return 4294967297!==[].push.call({length:4294967296},1)})),Rm=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();_m({target:"Array",proto:!0,arity:1,forced:Om||Rm},{push:function(t){var e=Am(this),r=bm(e),n=arguments.length;Nm(r+n);for(var i=0;i<n;i++)e[r]=arguments[i],r++;return e.length=r,r}});var Mm=Xn,Sm=li,Cm=hn,xm=Gs,Um=TypeError,Pm=function(t){return function(e,r,n,i){Mm(r);var o=Sm(e),s=Cm(o),u=xm(o),a=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(a in s){i=s[a],a+=c;break}if(a+=c,t?a<0:u<=a)throw Um("Reduce of empty array with no initial value")}for(;t?a>=0:u>a;a+=c)a in s&&(i=r(i,s[a],a,o));return i}},km={left:Pm(!1),right:Pm(!0)},Dm=km.left,Lm=Pn,Fm=Xf;Mu({target:"Array",proto:!0,forced:!og("reduce")||!Fm&&Lm>79&&Lm<83},{reduce:function(t){var e=arguments.length;return Dm(this,t,e,e>1?arguments[1]:void 0)}});var Vm=km.right,Gm=Pn,jm=Xf;Mu({target:"Array",proto:!0,forced:!og("reduceRight")||!jm&&Gm>79&&Gm<83},{reduceRight:function(t){return Vm(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Hm=Mu,Bm=iy,zm=nn([].reverse),Km=[1,2];Hm({target:"Array",proto:!0,forced:String(Km)===String(Km.reverse())},{reverse:function(){return Bm(this)&&(this.length=this.length),zm(this)}});var Jm=Mu,Ym=iy,qm=Tp,Xm=Tn,Wm=Ds,$m=Gs,Zm=mn,Qm=zv,tE=Ci,eE=Pp,rE=Ay("slice"),nE=tE("species"),iE=Array,oE=Math.max;Jm({target:"Array",proto:!0,forced:!rE},{slice:function(t,e){var r,n,i,o=Zm(this),s=$m(o),u=Wm(t,s),a=Wm(void 0===e?s:e,s);if(Ym(o)&&(r=o.constructor,(qm(r)&&(r===iE||Ym(r.prototype))||Xm(r)&&null===(r=r[nE]))&&(r=void 0),r===iE||void 0===r))return eE(o,u,a);for(n=new(void 0===r?iE:r)(oE(a-u,0)),i=0;u<a;u++,i++)u in o&&Qm(n,i,o[u]);return n.length=i,n}});var sE=ng.some;Mu({target:"Array",proto:!0,forced:!og("some")},{some:function(t){return sE(this,t,arguments.length>1?arguments[1]:void 0)}});var uE=Ds,aE=Gs,cE=zv,fE=Array,pE=Math.max,lE=function(t,e,r){for(var n=aE(t),i=uE(e,n),o=uE(void 0===r?n:r,n),s=fE(pE(o-i,0)),u=0;i<o;i++,u++)cE(s,u,t[i]);return s.length=u,s},hE=lE,dE=Math.floor,vE=function(t,e){var r=t.length,n=dE(r/2);return r<8?yE(t,e):gE(t,vE(hE(t,0,n),e),vE(hE(t,n),e),e)},yE=function(t,e){for(var r,n,i=t.length,o=1;o<i;){for(n=o,r=t[o];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==o++&&(t[n]=r)}return t},gE=function(t,e,r,n){for(var i=e.length,o=r.length,s=0,u=0;s<i||u<o;)t[s+u]=s<i&&u<o?n(e[s],r[u])<=0?e[s++]:r[u++]:s<i?e[s++]:r[u++];return t},mE=vE,EE=On.match(/firefox\/(\d+)/i),wE=!!EE&&+EE[1],TE=/MSIE|Trident/.test(On),IE=On.match(/AppleWebKit\/(\d+)\./),_E=!!IE&&+IE[1],AE=Mu,bE=nn,NE=Xn,OE=li,RE=Gs,ME=Hy,SE=Ec,CE=Vr,xE=mE,UE=og,PE=wE,kE=TE,DE=Pn,LE=_E,FE=[],VE=bE(FE.sort),GE=bE(FE.push),jE=CE((function(){FE.sort(void 0)})),HE=CE((function(){FE.sort(null)})),BE=UE("sort"),zE=!CE((function(){if(DE)return DE<70;if(!(PE&&PE>3)){if(kE)return!0;if(LE)return LE<603;var t,e,r,n,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)FE.push({k:e+n,v:r})}for(FE.sort((function(t,e){return e.v-t.v})),n=0;n<FE.length;n++)e=FE[n].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));AE({target:"Array",proto:!0,forced:jE||!HE||!BE||!zE},{sort:function(t){void 0!==t&&NE(t);var e=OE(this);if(zE)return void 0===t?VE(e):VE(e,t);var r,n,i=[],o=RE(e);for(n=0;n<o;n++)n in e&&GE(i,e[n]);for(xE(i,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:SE(e)>SE(r)?1:-1}}(t)),r=i.length,n=0;n<r;)e[n]=i[n++];for(;n<o;)ME(e,n++);return e}}),tp("Array");var KE=Mu,JE=li,YE=Ds,qE=xs,XE=Gs,WE=hy,$E=wy,ZE=zv,QE=Hy,tw=Ay("splice"),ew=Math.max,rw=Math.min;KE({target:"Array",proto:!0,forced:!tw},{splice:function(t,e){var r,n,i,o,s,u,a=JE(this),c=XE(a),f=YE(t,c),p=arguments.length;for(0===p?r=n=0:1===p?(r=0,n=c-f):(r=p-2,n=rw(ew(qE(e),0),c-f)),WE(c+r-n),i=$E(a,n),o=0;o<n;o++)(s=f+o)in a&&ZE(i,o,a[s]);if(i.length=n,r<n){for(o=f;o<c-n;o++)u=o+r,(s=o+n)in a?a[u]=a[s]:QE(a,u);for(o=c;o>c-n+r;o--)QE(a,o-1)}else if(r>n)for(o=c-n;o>f;o--)u=o+r-1,(s=o+n-1)in a?a[u]=a[s]:QE(a,u);for(o=0;o<r;o++)a[o+f]=arguments[o+2];return a.length=c-n+r,i}}),Xc("flat"),Xc("flatMap");var nw=Mu,iw=li,ow=Gs,sw=Hy,uw=hy,aw=1!==[].unshift(0),cw=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();nw({target:"Array",proto:!0,arity:1,forced:aw||cw},{unshift:function(t){var e=iw(this),r=ow(e),n=arguments.length;if(n){uw(r+n);for(var i=r;i--;){var o=i+n;i in e?e[o]=e[i]:sw(e,o)}for(var s=0;s<n;s++)e[s]=arguments[s]}return e.length=r+n}});var fw=Ev.Array,pw={exports:{}},lw={},hw=an,dw=mn,vw=Rs.f,yw=lE,gw="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];lw.f=function(t){return gw&&"Window"==hw(t)?function(t){try{return vw(t)}catch(t){return yw(gw)}}(t):vw(dw(t))};var mw=Vr((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Ew=Vr,ww=Tn,Tw=an,Iw=mw,_w=Object.isExtensible,Aw=Ew((function(){_w(1)}))||Iw?function(t){return!!ww(t)&&((!Iw||"ArrayBuffer"!=Tw(t))&&(!_w||_w(t)))}:_w,bw=!Vr((function(){return Object.isExtensible(Object.preventExtensions({}))})),Nw=Mu,Ow=nn,Rw=Jo,Mw=Tn,Sw=vi,Cw=no.f,xw=Rs,Uw=lw,Pw=Aw,kw=bw,Dw=!1,Lw=wi("meta"),Fw=0,Vw=function(t){Cw(t,Lw,{value:{objectID:"O"+Fw++,weakData:{}}})},Gw=pw.exports={enable:function(){Gw.enable=function(){},Dw=!0;var t=xw.f,e=Ow([].splice),r={};r[Lw]=1,t(r).length&&(xw.f=function(r){for(var n=t(r),i=0,o=n.length;i<o;i++)if(n[i]===Lw){e(n,i,1);break}return n},Nw({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Uw.f}))},fastKey:function(t,e){if(!Mw(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!Sw(t,Lw)){if(!Pw(t))return"F";if(!e)return"E";Vw(t)}return t[Lw].objectID},getWeakData:function(t,e){if(!Sw(t,Lw)){if(!Pw(t))return!0;if(!e)return!1;Vw(t)}return t[Lw].weakData},onFreeze:function(t){return kw&&Dw&&Pw(t)&&!Sw(t,Lw)&&Vw(t),t}};Rw[Lw]=!0;var jw=En,Hw=Tn,Bw=Ku,zw=Mu,Kw=Lr,Jw=nn,Yw=Tu,qw=Os,Xw=pw.exports,Ww=yc,$w=np,Zw=En,Qw=Tn,tT=Vr,eT=sd,rT=af,nT=function(t,e,r){var n,i;return Bw&&jw(n=e.constructor)&&n!==r&&Hw(i=n.prototype)&&i!==r.prototype&&Bw(t,i),t},iT=Os,oT=function(t,e,r){for(var n in e)iT(t,n,e[n],r);return t},sT=no.f,uT=va,aT=oT,cT=Na,fT=np,pT=yc,lT=Pf,hT=tp,dT=Gr,vT=pw.exports.fastKey,yT=fs.set,gT=fs.getterFor,mT={getConstructor:function(t,e,r,n){var i=t((function(t,i){fT(t,o),yT(t,{type:e,index:uT(null),first:void 0,last:void 0,size:0}),dT||(t.size=0),null!=i&&pT(i,t[n],{that:t,AS_ENTRIES:r})})),o=i.prototype,s=gT(e),u=function(t,e,r){var n,i,o=s(t),u=a(t,e);return u?u.value=r:(o.last=u={index:i=vT(e,!0),key:e,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=u),n&&(n.next=u),dT?o.size++:t.size++,"F"!==i&&(o.index[i]=u)),t},a=function(t,e){var r,n=s(t),i=vT(e);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==e)return r};return aT(o,{clear:function(){for(var t=s(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,dT?t.size=0:this.size=0},delete:function(t){var e=this,r=s(e),n=a(e,t);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),dT?r.size--:e.size--}return!!n},forEach:function(t){for(var e,r=s(this),n=cT(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!a(this,t)}}),aT(o,r?{get:function(t){var e=a(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),dT&&sT(o,"size",{get:function(){return s(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=gT(e),o=gT(n);lT(t,e,(function(t,e){yT(this,{type:n,target:t,state:i(t),kind:e,last:void 0})}),(function(){for(var t=o(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),hT(e)}};(function(t,e,r){var n=-1!==t.indexOf("Map"),i=-1!==t.indexOf("Weak"),o=n?"set":"add",s=Kw[t],u=s&&s.prototype,a=s,c={},f=function(t){var e=Jw(u[t]);qw(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(i&&!Qw(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return i&&!Qw(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(i&&!Qw(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(Yw(t,!Zw(s)||!(i||u.forEach&&!tT((function(){(new s).entries().next()})))))a=r.getConstructor(e,t,n,o),Xw.enable();else if(Yw(t,!0)){var p=new a,l=p[o](i?{}:-0,1)!=p,h=tT((function(){p.has(1)})),d=eT((function(t){new s(t)})),v=!i&&tT((function(){for(var t=new s,e=5;e--;)t[o](e,e);return!t.has(-0)}));d||((a=e((function(t,e){$w(t,u);var r=nT(new s,t,a);return null!=e&&Ww(e,r[o],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=a),(h||v)&&(f("delete"),f("has"),n&&f("get")),(v||l)&&f(o),i&&u.clear&&delete u.clear}c[t]=a,zw({global:!0,constructor:!0,forced:a!=s},c),rT(a,t),i||r.setStrong(a,t,n)})("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),mT);var ET=Gs,wT=function(t,e){for(var r=0,n=ET(e),i=new t(n);n>r;)i[r]=e[r++];return i},TT=Na,IT=hn,_T=li,AT=ji,bT=Gs,NT=va,OT=wT,RT=Array,MT=nn([].push),ST=function(t,e,r,n){for(var i,o,s,u=_T(t),a=IT(u),c=TT(e,r),f=NT(null),p=bT(a),l=0;p>l;l++)s=a[l],(o=AT(c(s,l,u)))in f?MT(f[o],s):f[o]=[s];if(n&&(i=n(u))!==RT)for(o in f)f[o]=OT(i,f[o]);return f},CT=ST,xT=Xc;Mu({target:"Array",proto:!0},{group:function(t){var e=arguments.length>1?arguments[1]:void 0;return CT(this,t,e)}}),xT("group");var UT=ST,PT=Xc;Mu({target:"Array",proto:!0,forced:!og("groupBy")},{groupBy:function(t){var e=arguments.length>1?arguments[1]:void 0;return UT(this,t,e)}}),PT("groupBy");var kT=Na,DT=nn,LT=hn,FT=li,VT=Gs,GT=bn("Map"),jT=GT.prototype,HT=DT(jT.get),BT=DT(jT.has),zT=DT(jT.set),KT=DT([].push),JT=function(t){for(var e,r,n=FT(this),i=LT(n),o=kT(t,arguments.length>1?arguments[1]:void 0),s=new GT,u=VT(i),a=0;u>a;a++)e=o(r=i[a],a,n),BT(s,e)?KT(HT(s,e),r):zT(s,e,[r]);return s},YT=Xc,qT=JT;Mu({target:"Array",proto:!0,name:"groupToMap",forced:!og("groupByToMap")},{groupByToMap:qT}),YT("groupByToMap");var XT=Xc;Mu({target:"Array",proto:!0},{groupToMap:JT}),XT("groupToMap");var WT=Gs,$T=function(t,e){for(var r=WT(t),n=new e(r),i=0;i<r;i++)n[i]=t[r-i-1];return n},ZT=mn,QT=Xc,tI=Array;Mu({target:"Array",proto:!0},{toReversed:function(){return $T(ZT(this),tI)}}),QT("toReversed");var eI=Lr,rI=function(t){return eI[t].prototype},nI=Mu,iI=Xn,oI=mn,sI=wT,uI=Xc,aI=Array,cI=nn(rI("Array").sort);nI({target:"Array",proto:!0},{toSorted:function(t){void 0!==t&&iI(t);var e=oI(this),r=sI(aI,e);return cI(r,t)}}),uI("toSorted");var fI=Mu,pI=Xc,lI=hy,hI=Gs,dI=Ds,vI=mn,yI=xs,gI=Array,mI=Math.max,EI=Math.min;fI({target:"Array",proto:!0},{toSpliced:function(t,e){var r,n,i,o,s=vI(this),u=hI(s),a=dI(t,u),c=arguments.length,f=0;for(0===c?r=n=0:1===c?(r=0,n=u-a):(r=c-2,n=EI(mI(yI(e),0),u-a)),i=lI(u+r-n),o=gI(i);f<a;f++)o[f]=s[f];for(;f<a+r;f++)o[f]=arguments[f-a+2];for(;f<i;f++)o[f]=s[f+n-r];return o}}),pI("toSpliced");var wI=Gs,TI=xs,II=RangeError,_I=function(t,e,r,n){var i=wI(t),o=TI(r),s=o<0?i+o:o;if(s>=i||s<0)throw II("Incorrect index");for(var u=new e(i),a=0;a<i;a++)u[a]=a===s?n:t[a];return u},AI=mn,bI=Array;Mu({target:"Array",proto:!0},{with:function(t,e){return _I(AI(this),bI,t,e)}});var NI,OI,RI=fw,MI=Lr,SI=ai,CI=En,xI=Fu,UI=Os,PI=Ci("asyncIterator"),kI=MI.AsyncIterator,DI=SI.AsyncIteratorPrototype;if(DI)NI=DI;else if(CI(kI))NI=kI.prototype;else if(SI.USE_FUNCTION_CONSTRUCTOR||MI.USE_FUNCTION_CONSTRUCTOR)try{OI=xI(xI(xI(Function("return async function*(){}()")()))),xI(OI)===Object.prototype&&(NI=OI)}catch(t){}NI||(NI={}),CI(NI[PI])||UI(NI,PI,(function(){return this}));var LI=zr,FI=ao,VI=va,GI=$n,jI=oT,HI=fs,BI=NI,zI=bn("Promise"),KI="AsyncFromSyncIterator",JI=HI.set,YI=HI.getterFor(KI),qI=function(t,e,r){var n=t.done;zI.resolve(t.value).then((function(t){e({done:n,value:t})}),r)},XI=function(t){JI(this,{type:KI,iterator:FI(t),next:t.next})};XI.prototype=jI(VI(BI),{next:function(){var t=YI(this);return new zI((function(e,r){var n=FI(LI(t.next,t.iterator));qI(n,e,r)}))},return:function(){var t=YI(this).iterator;return new zI((function(e,r){var n=GI(t,"return");if(void 0===n)return e({done:!0,value:void 0});var i=FI(LI(n,t));qI(i,e,r)}))}});var WI=XI,$I=zr,ZI=WI,QI=ao,t_=Za,e_=$n,r_=Ci("asyncIterator"),n_=Xn,i_=ao,o_=zr,s_=bn,u_=$n,a_=zr,c_=Xn,f_=ao,p_=hy,l_=bn,h_=function(t){return{iterator:t,next:n_(i_(t).next)}},d_=function(t,e,r,n){try{var i=u_(t,"return");if(i)return s_("Promise").resolve(o_(i,t)).then((function(){e(r)}),(function(t){n(t)}))}catch(t){return n(t)}e(r)},v_=function(t){var e=0==t,r=1==t,n=2==t,i=3==t;return function(t,o,s){var u=h_(t),a=l_("Promise"),c=u.iterator,f=u.next,p=0,l=void 0!==o;return!l&&e||c_(o),new a((function(t,u){var h=function(t){d_(c,u,t,u)},d=function(){try{if(e&&l)try{p_(p)}catch(t){h(t)}a.resolve(f_(a_(f,c))).then((function(f){try{if(f_(f).done)e?(s.length=p,t(s)):t(!i&&(n||void 0));else{var v=f.value;try{l?a.resolve(e?o(v,p):o(v)).then((function(o){if(r)d();else if(n)o?d():d_(c,t,!1,u);else if(e)try{s[p++]=o,d()}catch(t){h(t)}else o?d_(c,t,i||v,u):d()}),h):(s[p++]=v,d())}catch(t){h(t)}}}catch(t){u(t)}}),u)}catch(t){u(t)}};d()}))}},y_={toArray:v_(0),forEach:v_(1),every:v_(2),some:v_(3),find:v_(4)},g_=Na,m_=li,E_=Tp,w_=function(t,e){var r=arguments.length<2?e_(t,r_):e;return r?QI($I(r,t)):new ZI(t_(t))},T_=Za,I_=Ka,__=$n,A_=rI,b_=bn,N_=WI,O_=y_.toArray,R_=Ci("asyncIterator"),M_=A_("Array").values,S_=function(t){var e=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(b_("Promise"))((function(r){var o=m_(t);void 0!==n&&(n=g_(n,i));var s=__(o,R_),u=s?void 0:I_(o)||M_,a=E_(e)?new e:[],c=s?w_(o,s):new N_(T_(o,u));r(O_(c,n,a))}))};Mu({target:"Array",stat:!0,forced:!0},{fromAsync:S_});var C_=ng.filterReject,x_=Xc;Mu({target:"Array",proto:!0,forced:!0},{filterOut:function(t){return C_(this,t,arguments.length>1?arguments[1]:void 0)}}),x_("filterOut");var U_=ng.filterReject,P_=Xc;Mu({target:"Array",proto:!0,forced:!0},{filterReject:function(t){return U_(this,t,arguments.length>1?arguments[1]:void 0)}}),P_("filterReject");var k_=Mu,D_=iy,L_=Object.isFrozen,F_=function(t,e){if(!L_||!D_(t)||!L_(t))return!1;for(var r,n=0,i=t.length;n<i;)if(!("string"==typeof(r=t[n++])||e&&void 0===r))return!1;return 0!==i};k_({target:"Array",stat:!0,sham:!0,forced:!0},{isTemplateObject:function(t){if(!F_(t,!0))return!1;var e=t.raw;return e.length===t.length&&F_(e,!1)}});var V_=Ao.exports,G_=no,j_=function(t,e,r){return r.get&&V_(r.get,e,{getter:!0}),r.set&&V_(r.set,e,{setter:!0}),G_.f(t,e,r)},H_=Xc,B_=li,z_=Gs;Gr&&(j_(Array.prototype,"lastItem",{configurable:!0,get:function(){var t=B_(this),e=z_(t);return 0==e?void 0:t[e-1]},set:function(t){var e=B_(this),r=z_(e);return e[0==r?0:r-1]=t}}),H_("lastItem"));var K_=Xc,J_=li,Y_=Gs;Gr&&(j_(Array.prototype,"lastIndex",{configurable:!0,get:function(){var t=J_(this),e=Y_(t);return 0==e?0:e-1}}),K_("lastIndex"));var q_=nn,X_=Xn,W_=Gs,$_=li,Z_=wy,Q_=bn("Map"),tA=Q_.prototype,eA=q_(tA.forEach),rA=q_(tA.has),nA=q_(tA.set),iA=q_([].push),oA=Xc;Mu({target:"Array",proto:!0,forced:!0},{uniqueBy:function(t){var e,r,n,i=$_(this),o=W_(i),s=Z_(i,0),u=new Q_,a=null!=t?X_(t):function(t){return t};for(e=0;e<o;e++)n=a(r=i[e]),rA(u,n)||nA(u,n,r);return eA(u,(function(t){iA(s,t)})),s}}),oA("uniqueBy");var sA=RI;!function(t){t.exports=sA}({exports:{}});var uA,aA=function(){function t(t,e,r){void 0===r&&(r=Ne()),this.timestamp=t,this.user=e,this.insertId=r}return t.exposure=function(t,e,r,n){return new cA(n,t,e.experiment,e.variationId,e.variationKey,e.reason,r)},t.track=function(t,e,r,n){return new fA(n,r,t,e)},t.remoteConfig=function(t,e,r,n){return new pA(n,t,e.parameter,e.valueId,e.reason,r)},t.isExposureEvent=function(t){return void 0!==t.experiment},t.isTrackEvent=function(t){return void 0!==t.eventType},t.isRemoteConfigEvent=function(t){return void 0!==t.parameter},t.isExposureEventDto=function(t){return"experimentId"in t&&void 0!==t.experimentId},t.isTrackEventDto=function(t){return"eventTypeId"in t&&void 0!==t.eventTypeId},t.isRemoteConfigEventDto=function(t){return"parameterId"in t&&void 0!==t.parameterId},t.prototype.toDto=function(){return{insertId:this.insertId,timestamp:this.timestamp,userId:this.user.identifiers[L.ID],identifiers:this.user.identifiers,userProperties:v.sanitize(this.user.properties),hackleProperties:v.sanitize(this.user.hackleProperties)}},t}(),cA=function(t){function e(e,r,n,i,o,s,u,a){var c=t.call(this,e,r,a)||this;return c.experiment=n,c.variationId=i,c.variationKey=o,c.decisionReason=s,c.properties=u,c}return u(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.experiment,this.variationId,this.variationKey,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return a(a({},t.prototype.toDto.call(this)),{experimentId:this.experiment.id,experimentKey:this.experiment.key,experimentType:this.experiment.type,experimentVersion:this.experiment.version,variationId:this.variationId,variationKey:this.variationKey,decisionReason:this.decisionReason.toString(),properties:this.properties})},e}(aA),fA=function(t){function e(e,r,n,i,o){var s=t.call(this,e,r,o)||this;return s.eventType=n,s.event=i,s}return u(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.eventType,this.event,this.insertId)},e.prototype.toDto=function(){return a(a({},t.prototype.toDto.call(this)),{eventTypeId:this.eventType.id,eventTypeKey:this.eventType.key,value:this.event.value||0,properties:v.sanitize(this.event.properties)})},e}(aA),pA=function(t){function e(e,r,n,i,o,s,u){var a=t.call(this,e,r,u)||this;return a.parameter=n,a.valueId=i,a.decisionReason=o,a.properties=s,a}return u(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.parameter,this.valueId,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return a(a({},t.prototype.toDto.call(this)),{parameterId:this.parameter.id,parameterKey:this.parameter.key,parameterType:this.parameter.type,valueId:this.valueId,decisionReason:this.decisionReason.toString(),properties:v.sanitize(this.properties)})},e}(aA),lA=function(){function t(t,e){this.userManager=t,this.core=e}return t.isSessionEvent=function(e){return!!aA.isTrackEvent(e)&&(e.event.key===t.SESSION_START_EVENT_NAME||e.event.key===t.SESSION_END_EVENT_NAME)},t.prototype.onSessionStarted=function(e,r,n){this.track(t.SESSION_START_EVENT_NAME,e,r,n)},t.prototype.onSessionEnded=function(e,r,n){this.track(t.SESSION_END_EVENT_NAME,e,r,n)},t.prototype.track=function(t,e,r,n){var i={key:t},o=this.userManager.toHackleUser(r),s=this.decorateSession(o,e);this.core.track(i,s,n)},t.prototype.decorateSession=function(t,e){var r=(new V).add(L.SESSION,e).addIdentifiers(t.identifiers).build();return a(a({},t),{identifiers:r})},t.SESSION_START_EVENT_NAME="$session_start",t.SESSION_END_EVENT_NAME="$session_end",t}(),hA=function(){function t(t,e,r,n){this.delegate=t,this.eventDedupDeterminer=e,this.sessionManager=r,this.userManager=n}return t.prototype.process=function(t){if(lA.isSessionEvent(t)||this.sessionManager.startNewSessionIfNeeded(this.userManager.currentUser,t.timestamp),!this.eventDedupDeterminer.isDedupTarget(t)){var e=function(t,e){var r;return null===e.currentSessionId||t.user.identifiers[L.SESSION]?t:t.copyWithUser(a(a({},t.user),{identifiers:a(a({},t.user.identifiers),(r={},r[L.SESSION]=e.sessionId,r))}))}(t,this.sessionManager);this.delegate.process(e)}},t.prototype.flush=function(t){this.delegate.flush(t)},t.prototype.close=function(){this.delegate.close()},t.prototype.onVisibilityChanged=function(t,e){switch(t){case"visible":return;case"hidden":return void this.flush(!0)}},t}(),dA=function(){function t(){}return t.toEvent=function(e){var r;return{key:t.EVENT_KEY,properties:{level:t.LEVEL_ERROR,type:e.name,message:null!==(r=e.message)&&void 0!==r?r:"",$stacktrace:t._stacktrace(e)}}},t._stacktrace=function(r){return e.isNullOrUndefined(r.stack)?"":r.stack.split("\n").slice(0,t.STACK_TRACK_LIMIT).join("\n")},t.EVENT_KEY="$trace",t.LEVEL_ERROR="error",t.STACK_TRACK_LIMIT=30,t}(),vA=function(){function t(){}return t.prototype.evaluate=function(t,e){if(!this.supports(t))throw new Error("Unsupported EvaluatorRequest ".concat(t.toString()));if(e.contains(t)){var r=e.stack.map((function(t){return t.toString()})).join(" - ");throw new Error("Circular evaluation has occurred [".concat(r," - ").concat(t.toString(),"]"))}e.addRequest(t);try{return this.evaluateInternal(t,e)}finally{e.removeRequest(t)}},t}(),yA=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.experiment=r,this.variationId=n,this.variationKey=i,this.config=o}return t.prototype.with=function(e){return new t(e,this.targetEvaluations,this.experiment,this.variationId,this.variationKey,this.config)},t.of=function(e,r,n,i){var o=this.config(e.workspace,n);return new t(i,r.targetEvaluations,e.experiment,n.id,n.key,o)},t.ofDefault=function(r,n,i){var o=r.experiment._getVariationByKeyOrNull(r.defaultVariationKey);return e.isNotNullOrUndefined(o)?this.of(r,n,o,i):new t(i,n.targetEvaluations,r.experiment,void 0,r.defaultVariationKey,void 0)},t.config=function(t,r){if(!e.isNullOrUndefined(r.parameterConfigurationId))return e.requiredNotNullOrUndefined(t.getParameterConfigurationOrNull(r.parameterConfigurationId),(function(){return"ParameterConfiguration[".concat(r.parameterConfigurationId,"]")}))},t}(),gA=function(t){function e(e){var r=t.call(this)||this;return r.evaluationFlowFactory=e,r}return u(e,t),e.prototype.supports=function(t){return void 0!==t.experiment},e.prototype.evaluateInternal=function(t,e){var r;return null!==(r=this.evaluationFlowFactory.getExperimentFlow(t.experiment.type).evaluate(t,e))&&void 0!==r?r:yA.ofDefault(t,e,S.TRAFFIC_NOT_ALLOCATED)},e}(vA),mA=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.parameter=r,this.valueId=n,this.value=i,this.properties=o}return t.of=function(e,r,n,i,o,s){return s.returnValue=v.truncateStringValue(i),new t(o,r.targetEvaluations,e.parameter,n,i,s)},t.ofDefault=function(t,e,r,n){return this.of(t,e,void 0,t.defaultValue,r,n)},t}(),EA=function(t){function r(e){var r=t.call(this)||this;return r.targetRuleDeterminer=e,r}return u(r,t),r.prototype.supports=function(t){return void 0!==t.parameter},r.prototype.evaluateInternal=function(t,r){var n={};if(n.requestValueType=t.requiredType,n.requestDefaultValue=v.truncateStringValue(t.defaultValue),e.isNullOrUndefined(t.user.identifiers[t.parameter.identifierType]))return mA.ofDefault(t,r,S.IDENTIFIER_NOT_FOUND,n);var i=this.targetRuleDeterminer.determineTargetRuleOrNull(t,r);return e.isNotNullOrUndefined(i)?(n.targetRuleKey=i.key,n.targetRuleName=i.name,this.evaluation(t,r,i.value,S.TARGET_RULE_MATCH,n)):this.evaluation(t,r,t.parameter.defaultValue,S.DEFAULT_RULE,n)},r.prototype.evaluation=function(t,e,r,n,i){return"UNKNOWN"===t.requiredType||"NULL"!==t.requiredType&&typeof t.defaultValue!=typeof r.rawValue?mA.ofDefault(t,e,S.TYPE_MISMATCH,i):mA.of(t,e,r.id,r.rawValue,n,i)},r}(vA),wA=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isEquals=function(t){return this.type===t.type&&this.id===t.id},t}(),TA=function(){function t(){this._stack=[],this._targetEvaluations=[],this._properties={}}return t.create=function(){return new t},Object.defineProperty(t.prototype,"stack",{get:function(){return Array.from(this._stack)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetEvaluations",{get:function(){return Array.from(this._targetEvaluations)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return v.sanitize(this._properties)},enumerable:!1,configurable:!0}),t.prototype.contains=function(t){return this._stack.some((function(e){return e.key.isEquals(t.key)}))},t.prototype.addRequest=function(t){this._stack.push(t)},t.prototype.removeRequest=function(t){var e=this._stack.indexOf(t,0);e>-1&&this._stack.splice(e,1)},t.prototype.getEvaluation=function(t){return this._targetEvaluations.find((function(e){return e instanceof yA&&e.experiment.id===t.id}))},t.prototype.addEvaluation=function(t){this._targetEvaluations.push(t)},t.prototype.setProperty=function(t,e){this._properties[t]=e},t}(),IA=function(){function t(t,e,r,n){this.key=new wA("EXPERIMENT",r.id),this.workspace=t,this.user=e,this.experiment=r,this.defaultVariationKey=n}return t.of=function(e,r,n,i){return new t(e,r,n,i)},t.by=function(e,r){return new t(e.workspace,e.user,r,"A")},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.experiment.type,", key=").concat(this.experiment.key,")")},t}(),_A=function(){function t(t,e,r,n,i){this.key=new wA("REMOTE_CONFIG",r.id),this.workspace=t,this.user=e,this.parameter=r,this.requiredType=n,this.defaultValue=i}return t.of=function(e,r,n,i,o){return new t(e,r,n,i,o)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.parameter.key,")")},t}(),AA=function(){function t(){}return t.asString=function(t){switch(typeof t){case"string":return t;case"number":return t.toString();default:return}},t.asNumber=function(t){switch(typeof t){case"number":return this.asActualNumber(t);case"string":return this.asActualNumber(Number(t));default:return}},t.asActualNumber=function(t){return!isNaN(t)&&isFinite(t)?t:void 0},t}(),bA=function(){function t(t){this.storages=t}return t.prototype.getVariation=function(t,e){if(0!==this.storages.length)for(var r=0,n=this.storages;r<n.length;r++){var i=n[r].getVariation(t,e);if(void 0!==i)return i}},t}(),NA=function(){function t(t){this.listStorage=t}return t.prototype.getVariation=function(t,e){var r=this.get(t);if(r)return t._getVariationByIdOrNull(r)},t.prototype.get=function(t){var e=this.listStorage.getItem(t.id.toString());return AA.asNumber(e)},t.prototype.getAll=function(){var t=new Map;return this.listStorage.entries().forEach((function(r){var n=r[0],i=r[1],o=AA.asNumber(n),s=AA.asNumber(i);e.isNullOrUndefined(o)||o<0||e.isNullOrUndefined(s)||o<0||t.set(o,s)})),t},t.prototype.set=function(t,e){this.listStorage.setItem(t.id.toString(),e.toString())},t.prototype.remove=function(t){this.listStorage.removeItem(t.id.toString())},t.prototype.clear=function(){this.listStorage.clear()},t}(),OA=function(){function t(){this.evaluators=new Array}return t.prototype.add=function(t){this.evaluators.push(t)},t.prototype.evaluate=function(t,r){var n=this.evaluators.find((function(e){return e.supports(t)}));if(e.isNullOrUndefined(n))throw new Error("Unsupported EvaluatorRequest [".concat(t.toString(),"]"));return n.evaluate(t,r)},t}(),RA=function(){function t(t){this.conditionMatcherFactory=t}return t.prototype.matches=function(t,e,r){var n=this;return r.conditions.every((function(r){return n._matches(t,e,r)}))},t.prototype.anyMatches=function(t,e,r){var n=this;return!r.length||r.some((function(r){return n.matches(t,e,r)}))},t.prototype._matches=function(t,e,r){return this.conditionMatcherFactory.getMatcher(r.key.type).matches(t,e,r)},t}(),MA=function(){function t(){}return t.prototype.decorate=function(t){return t},t}(),SA=function(){function t(){}return t.prototype.decorate=function(t){return"string"==typeof t?br.decodeURIOrOriginal(t):t},t}(),CA=function(){function t(t,e){this.valueMatcherFactory=t,this.operatorMatcherFactory=e}return t.prototype.matches=function(t,e,r){void 0===r&&(r=new MA);var n=this.valueMatcherFactory.getMatcher(e.valueType),i=this.operatorMatcherFactory.getMatcher(e.operator),o=this.userValueMatches(t,e,n,i,r);return this.typeMatches(e.type,o)},t.prototype.userValueMatches=function(t,e,r,n,i){return Array.isArray(t)?this.arrayMatches(t,e,r,n,i):this.singleMatches(t,e,r,n,i)},t.prototype.singleMatches=function(t,e,r,n,i){return e.values.some((function(e){return r.matches(n,i.decorate(t),i.decorate(e))}))},t.prototype.arrayMatches=function(t,e,r,n,i){var o=this;return t.some((function(t){return o.singleMatches(t,e,r,n,i)}))},t.prototype.typeMatches=function(t,e){switch(t){case"MATCH":return e;case"NOT_MATCH":return!e}},t}(),xA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return t===e},t.prototype.numberMatches=function(t,e){return t===e},t.prototype.stringMatches=function(t,e){return t===e},t.prototype.versionMatches=function(t,e){return t.isEqualTo(e)},t.prototype.urlMatches=function(t,e){return br.decodeURIOrOriginal(br.removePathnameTrailingSlash(t))===br.decodeURIOrOriginal(br.removePathnameTrailingSlash(e))},t}(),UA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.includes(e)},t.prototype.versionMatches=function(t,e){return!1},t.prototype.urlMatches=function(t,e){var r=br.decodeURIOrOriginal(t.href);return r.includes(e)||r.includes(encodeURI(e))},t}(),PA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.startsWith(e)},t.prototype.versionMatches=function(t,e){return!1},t.prototype.urlMatches=function(t,e){var r=br.decodeURIOrOriginal(t.href);return r.startsWith(e)||r.startsWith(encodeURI(e))},t}(),kA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.endsWith(e)},t.prototype.versionMatches=function(t,e){return!1},t.prototype.urlMatches=function(t,e){return!1},t}(),DA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t>e},t.prototype.stringMatches=function(t,e){return t>e},t.prototype.versionMatches=function(t,e){return t.isGreaterThan(e)},t.prototype.urlMatches=function(t,e){return!1},t}(),LA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t>=e},t.prototype.stringMatches=function(t,e){return t>=e},t.prototype.versionMatches=function(t,e){return t.isGreaterThanOrEqualTo(e)},t.prototype.urlMatches=function(t,e){return!1},t}(),FA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t<e},t.prototype.stringMatches=function(t,e){return t<e},t.prototype.versionMatches=function(t,e){return t.isLessThan(e)},t.prototype.urlMatches=function(t,e){return!1},t}(),VA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t<=e},t.prototype.stringMatches=function(t,e){return t<=e},t.prototype.versionMatches=function(t,e){return t.isLessThanOrEqualTo(e)},t.prototype.urlMatches=function(t,e){return!1},t}(),GA=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"IN":return t.IN_MATCHER;case"CONTAINS":return t.CONTAINS_MATCHER;case"STARTS_WITH":return t.STARTS_WITH_MATCHER;case"ENDS_WITH":return t.ENDS_WITH_MATCHER;case"GT":return t.GT_MATCHER;case"GTE":return t.GTE_MATCHER;case"LT":return t.LT_MATCHER;case"LTE":return t.LTE_MATCHER}},t.IN_MATCHER=new xA,t.CONTAINS_MATCHER=new UA,t.STARTS_WITH_MATCHER=new PA,t.ENDS_WITH_MATCHER=new kA,t.GT_MATCHER=new DA,t.GTE_MATCHER=new LA,t.LT_MATCHER=new FA,t.LTE_MATCHER=new VA,t}(),jA=function(){function t(){}return t.prototype.matches=function(t,r,n){var i=AA.asString(r),o=AA.asString(n);return!e.isNullOrUndefined(i)&&!e.isNullOrUndefined(o)&&t.stringMatches(i,o)},t}(),HA=function(){function t(){}return t.prototype.matches=function(t,r,n){var i=AA.asNumber(r),o=AA.asNumber(n);return!e.isNullOrUndefined(i)&&!e.isNullOrUndefined(o)&&t.numberMatches(i,o)},t}(),BA=function(){function t(){}return t.prototype.matches=function(t,e,r){return"boolean"==typeof e&&"boolean"==typeof r&&t.booleanMatches(e,r)},t}(),zA=function(){function t(){}return t.prototype.matches=function(t,e,r){var n=tt.tryParse(e),i=tt.tryParse(r);return!(!n||!i)&&t.versionMatches(n,i)},t}(),KA=function(){function t(){}return t.prototype.matches=function(t,r,n){var i=br.tryParse(r),o=AA.asString(n);return!e.isNullOrUndefined(i)&&!e.isNullOrUndefined(o)&&t.urlMatches(i,o)},t}(),JA=function(){function t(){}return t.prototype.matches=function(t,e,r){return!1},t}(),YA=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"STRING":case"JSON":return t.STRING_MATCHER;case"NUMBER":return t.NUMBER_MATCHER;case"BOOLEAN":return t.BOOLEAN_MATCHER;case"VERSION":return t.VERSION_MATCHER;case"URL":return t.URL_MATCHER;case"NULL":case"UNKNOWN":return t.NULL_MATCHER}},t.STRING_MATCHER=new jA,t.NUMBER_MATCHER=new HA,t.BOOLEAN_MATCHER=new BA,t.VERSION_MATCHER=new zA,t.URL_MATCHER=new KA,t.NULL_MATCHER=new JA,t}(),qA=function(){function t(t,e){this.URL_HACKLE_PROPERTY_KEY_NAMES=["pagePath","host","url","queryParameter"],this.userValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,r,n){var i=this.userValueResolver.resolveOrNull(t.user,n.key);if(e.isNullOrUndefined(i))return!1;var o=this.valueDecorator(n.key);return this.valueOperatorMatcher.matches(i,n.match,o)},t.prototype.valueDecorator=function(t){return"HACKLE_PROPERTY"===t.type&&this.URL_HACKLE_PROPERTY_KEY_NAMES.includes(t.name)?new SA:new MA},t}(),XA=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){switch(e.type){case"USER_ID":return t.identifiers[e.name];case"USER_PROPERTY":return t.properties[e.name];case"HACKLE_PROPERTY":return t.hackleProperties[e.name];case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":case"EVENT_PROPERTY":case"COHORT":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t}(),WA=function(){function t(t){this.segmentMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;if("SEGMENT"!=r.key.type)throw new Error("Unsupported TargetKeyType [".concat(r.key.type,"]"));var i=r.match.values.some((function(r){return n._matches(t,e,r)}));switch(r.match.type){case"MATCH":return i;case"NOT_MATCH":return!i}},t.prototype._matches=function(t,e,r){if("string"!=typeof r)throw new Error("SegmentKey[".concat(r,"]"));var n=t.workspace.getSegmentOrNull(r);if(!n)throw new Error("Segment[".concat(r,"]"));return this.segmentMatcher.matches(t,e,n)},t}(),$A=function(){function t(t){this.userConditionMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;return r.targets.some((function(r){return n._matches(t,e,r)}))},t.prototype._matches=function(t,e,r){var n=this;return r.conditions.every((function(r){return n.userConditionMatcher.matches(t,e,r)}))},t}(),ZA=function(){function t(t,e){this.abTestMatcher=t,this.featureFlagMatcher=e}return t.prototype.matches=function(t,e,r){switch(r.key.type){case"AB_TEST":return this.abTestMatcher.matches(t,e,r);case"FEATURE_FLAG":return this.featureFlagMatcher.matches(t,e,r);case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"EVENT_PROPERTY":case"SEGMENT":case"COHORT":throw new Error("Unsupported TargetKeyType [".concat(r.key.type,"]"))}},t}(),QA=function(){function t(t,e){this.evaluator=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,r,n){var i,o=e.requiredNotNullOrUndefined(AA.asNumber(n.key.name),(function(){return"Invalid key [".concat(n.key.type,", ").concat(n.key.name,"]")})),s=this.experiment(t,o);if(e.isNullOrUndefined(s))return!1;var u=null!==(i=r.getEvaluation(s))&&void 0!==i?i:this.evaluate(t,r,s);return this.evaluationMatches(u,n)},t.prototype.evaluate=function(t,e,r){var n=IA.by(t,r),i=this.evaluator.evaluate(n,e),o=this.resolve(t,i);return e.addEvaluation(o),o},t}(),tb=function(t){function e(e,r){return t.call(this,e,r)||this}return u(e,t),e.prototype.experiment=function(t,e){return t.workspace.getExperimentOrNull(e)},e.prototype.resolve=function(t,e){return t instanceof IA&&e.reason===S.TRAFFIC_ALLOCATED?e.with(S.TRAFFIC_ALLOCATED_BY_TARGETING):e},e.prototype.evaluationMatches=function(t,r){return!!e.AB_TEST_MATCHED_REASONS.includes(t.reason)&&this.valueOperatorMatcher.matches(t.variationKey,r.match)},e.AB_TEST_MATCHED_REASONS=[S.OVERRIDDEN,S.TRAFFIC_ALLOCATED,S.EXPERIMENT_COMPLETED,S.TRAFFIC_ALLOCATED_BY_TARGETING],e}(QA),eb=function(t){function e(e,r){return t.call(this,e,r)||this}return u(e,t),e.prototype.experiment=function(t,e){return t.workspace.getFeatureFlagOrNull(e)},e.prototype.resolve=function(t,e){return e},e.prototype.evaluationMatches=function(t,e){var r="A"!==t.variationKey;return this.valueOperatorMatcher.matches(r,e.match)},e}(QA),rb=function(){function t(t,e){this.eventValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,r,n){if(!this.isEventEvaluatorRequest(t))return!1;var i=this.eventValueResolver.resolveOrNull(t.event,n.key);return!e.isNullOrUndefined(i)&&this.valueOperatorMatcher.matches(i,n.match)},t.prototype.isEventEvaluatorRequest=function(t){return void 0!==t.event},t}(),nb=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){var r;switch(e.type){case"EVENT_PROPERTY":return null===(r=this.properties(t))||void 0===r?void 0:r[e.name];case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":case"COHORT":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t.prototype.properties=function(t){return aA.isTrackEvent(t)?t.event.properties:aA.isExposureEvent(t)||aA.isRemoteConfigEvent(t)?t.properties:void 0},t}(),ib=function(){function t(t){this.valueOperatorMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;if("COHORT"!==r.key.type)throw new Error("Unsupported TargetKeyType [".concat(r.key.type,"]"));return!!t.user.cohorts&&t.user.cohorts.some((function(t){return n.valueOperatorMatcher.matches(t.id,r.match)}))},t}(),ob=function(){function t(t){var e=new CA(new YA,new GA);this.userConditionMatcher=new qA(new XA,e),this.eventConditionMatcher=new rb(new nb,e),this.segmentConditionMatcher=new WA(new $A(this.userConditionMatcher)),this.experimentConditionMatcher=new ZA(new tb(t,e),new eb(t,e)),this.cohortConditionMatcher=new ib(e)}return t.prototype.getMatcher=function(t){switch(t){case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":return this.userConditionMatcher;case"EVENT_PROPERTY":return this.eventConditionMatcher;case"SEGMENT":return this.segmentConditionMatcher;case"AB_TEST":case"FEATURE_FLAG":return this.experimentConditionMatcher;case"COHORT":return this.cohortConditionMatcher}},t}(),sb=function(){function t(t){this.bucketer=t}return t.prototype.resolveOrNull=function(t,e,r){switch(r.type){case"VARIATION":return this.resolveVariation(t,r);case"BUCKET":return this.resolveBucket(t,r)}},t.prototype.resolveVariation=function(t,e){return t.experiment._getVariationByIdOrNull(e.variationId)},t.prototype.resolveBucket=function(t,e){var r=t.workspace.getBucketOrNull(e.bucketId),n=t.user.identifiers[t.experiment.identifierType];if(n){var i=this.bucketer.bucketing(r,n);if(i)return t.experiment._getVariationByIdOrNull(i.variationId)}},t}(),ub={murmurhash3_x86_32:function(t,e,r,n){void 0===n&&(n=t.length);for(var i,o=3432918353,s=461845907,u=-4&n,a=e,c=0;c<u;c+=4)i=255&t.charCodeAt(c)|(255&t.charCodeAt(c+1))<<8|(255&t.charCodeAt(c+2))<<16|(255&t.charCodeAt(c+3))<<24,i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,a=5*(a=(524287&(a^=i=this.mul32(i,s)))<<13|a>>>19)+3864292196|0;switch(i=0,n%4){case 3:i=(255&t.charCodeAt(u+2))<<16;case 2:i|=(255&t.charCodeAt(u+1))<<8;case 1:i|=255&t.charCodeAt(u),i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,a^=i=this.mul32(i,s)}return a^=n,a^=a>>>16,a=this.mul32(a,2246822507),a^=a>>>13,a=this.mul32(a,3266489909),a^=a>>>16},mul32:function(t,e){var r=65535&e;return((e-r)*t|0)+(r*t|0)|0}},ab=function(){function t(){}return t.prototype.bucketing=function(t,e){var r=this.calculateSlotNumber(t.seed,t.slotSize,e);return t.slots.find((function(t){return t.contains(r)}))},t.prototype.calculateSlotNumber=function(t,e,r){var n=ub.murmurhash3_x86_32(r,t);return Math.abs(n)%Math.abs(e)},t}(),cb=function(){function t(t,e){this.flowEvaluator=t,this.nextFlow=e}return t.prototype.evaluate=function(t,e){return this.flowEvaluator&&this.nextFlow?this.flowEvaluator.evaluate(t,e,this.nextFlow):void 0},t.end=function(){return new t(void 0,void 0)},t.decision=function(e,r){return new t(e,r)},t.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.end(),n=0,i=t.reverse();n<i.length;n++){var o=i[n];r=this.decision(o,r)}return r},t}(),fb=function(){function t(t){this.overrideResolver=t}return t.prototype.evaluate=function(t,e,r){var n=this.overrideResolver.resolveOrNull(t,e);if(!n)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return yA.of(t,e,n,S.OVERRIDDEN);case"FEATURE_FLAG":return yA.of(t,e,n,S.INDIVIDUAL_TARGET_MATCH)}},t}(),pb=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"DRAFT"===t.experiment.status?yA.ofDefault(t,e,S.EXPERIMENT_DRAFT):r.evaluate(t,e)},t}(),lb=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("PAUSED"!==t.experiment.status)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return yA.ofDefault(t,e,S.EXPERIMENT_PAUSED);case"FEATURE_FLAG":return yA.ofDefault(t,e,S.FEATURE_FLAG_INACTIVE)}},t}(),hb=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("COMPLETED"===t.experiment.status){var n=t.experiment._winnerVariationOrNull();if(!n)throw new Error("winner variation [".concat(t.experiment.id,"]"));return yA.of(t,e,n,S.EXPERIMENT_COMPLETED)}return r.evaluate(t,e)},t}(),db=function(){function t(t){this.experimentTargetDeterminer=t}return t.prototype.evaluate=function(t,e,r){if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));return this.experimentTargetDeterminer.isUserInExperimentTarget(t,e)?r.evaluate(t,e):yA.ofDefault(t,e,S.NOT_IN_EXPERIMENT_TARGET)},t}(),vb=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));var n=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);return n?n.isDropped?yA.ofDefault(t,e,S.VARIATION_DROPPED):yA.of(t,e,n,S.TRAFFIC_ALLOCATED):yA.ofDefault(t,e,S.TRAFFIC_NOT_ALLOCATED)},t}(),yb=function(){function t(t,e){this.targetRuleDeterminer=t,this.actionResolver=e}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return r.evaluate(t,e);var n=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);if(!n)return r.evaluate(t,e);var i=this.actionResolver.resolveOrNull(t,e,n.action);if(!i)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return yA.of(t,e,i,S.TARGET_RULE_MATCH)},t}(),gb=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return yA.ofDefault(t,e,S.DEFAULT_RULE);var n=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);if(!n)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return yA.of(t,e,n,S.DEFAULT_RULE)},t}(),mb=function(){function t(t){this.containerResolver=t}return t.prototype.evaluate=function(t,e,r){var n=t.experiment.containerId;if(!n)return r.evaluate(t,e);var i=t.workspace.getContainerOrNull(n);if(!i)throw new Error("container[".concat(n,"]"));return this.containerResolver.isUserInContainerGroup(t,e,i)?r.evaluate(t,e):yA.ofDefault(t,e,S.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT)},t}(),Eb=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.user.identifiers[t.experiment.identifierType]?r.evaluate(t,e):yA.ofDefault(t,e,S.IDENTIFIER_NOT_FOUND)},t}(),wb=function(){function t(t){this.targetMatcher=t}return t.prototype.isUserInExperimentTarget=function(t,e){var r=this;return 0===t.experiment.targetAudiences.length||t.experiment.targetAudiences.some((function(n){return r.targetMatcher.matches(t,e,n)}))},t}(),Tb=function(){function t(t){this.targetMatcher=t}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.experiment.targetRules.find((function(n){return r.targetMatcher.matches(t,e,n.target)}))},t}(),Ib=function(){function t(t,e,r){this.manualOverrideStorage=t,this.targetMatcher=e,this.actionResolver=r}return t.prototype.resolveOrNull=function(t,e){var r,n;return null!==(n=null!==(r=this.resolveManualOverride(t))&&void 0!==r?r:this._resolveUserOverride(t))&&void 0!==n?n:this._resolveSegmentOverride(t,e)},t.prototype.resolveManualOverride=function(t){return this.manualOverrideStorage.getVariation(t.experiment,t.user)},t.prototype._resolveUserOverride=function(t){var e=t.experiment,r=t.user.identifiers[e.identifierType];if(r){var n=e.userOverrides.get(r);if(n)return e._getVariationByIdOrNull(n)}},t.prototype._resolveSegmentOverride=function(t,e){var r=this,n=t.experiment.segmentOverrides.find((function(n){return r.targetMatcher.matches(t,e,n.target)}));if(n)return this.actionResolver.resolveOrNull(t,e,n.action)},t}(),_b=function(){function t(t){this.bucketer=t}return t.prototype.isUserInContainerGroup=function(t,r,n){var i=t.user.identifiers[t.experiment.identifierType];if(e.isNullOrUndefined(i))return!1;var o=t.workspace.getBucketOrNull(n.bucketId);if(e.isNullOrUndefined(o))throw new Error("Bucket[".concat(n.bucketId,"]"));var s=this.bucketer.bucketing(o,i);if(e.isNullOrUndefined(s))return!1;var u=n.getGroupOrNull(s.variationId);if(e.isNullOrUndefined(u))throw new Error("ContainerGroup[".concat(s.variationId,"]"));return u.experiments.includes(t.experiment.id)},t}(),Ab=function(){function t(t,e,r,n,i){this.reason=t,this.targetEvaluations=e,this.inAppMessage=r,this.message=n,this.properties=i}return t.of=function(e,r,n,i){return new t(n,r.targetEvaluations,e.inAppMessage,i,r.properties)},t}(),bb=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.inAppMessage.supports("WEB")?r.evaluate(t,e):Ab.of(t,e,S.UNSUPPORTED_PLATFORM)},t}(),Nb=function(){function t(t,e){this.userOverrideMatcher=t,this.inAppMessageResolver=e}return t.prototype.evaluate=function(t,e,r){if(this.userOverrideMatcher.matches(t,e)){var n=this.inAppMessageResolver.resolve(t,e);return Ab.of(t,e,S.OVERRIDDEN,n)}return r.evaluate(t,e)},t}(),Ob=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"DRAFT"===t.inAppMessage.status?Ab.of(t,e,S.IN_APP_MESSAGE_DRAFT):r.evaluate(t,e)},t}(),Rb=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"PAUSE"===t.inAppMessage.status?Ab.of(t,e,S.IN_APP_MESSAGE_PAUSED):r.evaluate(t,e)},t}(),Mb=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.inAppMessage.period.within(t.timestamp)?r.evaluate(t,e):Ab.of(t,e,S.NOT_IN_IN_APP_MESSAGE_PERIOD)},t}(),Sb=function(){function t(t){this.hiddenMatcher=t}return t.prototype.evaluate=function(t,e,r){return this.hiddenMatcher.matches(t,e)?Ab.of(t,e,S.IN_APP_MESSAGE_HIDDEN):r.evaluate(t,e)},t}(),Cb=function(){function t(t,e){this.targetMatcher=t,this.inAppMessageResolver=e}return t.prototype.evaluate=function(t,e,r){if(this.targetMatcher.matches(t,e)){var n=this.inAppMessageResolver.resolve(t,e);return Ab.of(t,e,S.IN_APP_MESSAGE_TARGET,n)}return Ab.of(t,e,S.NOT_IN_IN_APP_MESSAGE_TARGET)},t}(),xb=function(){function t(t){this.evaluator=t}return t.prototype.resolve=function(t,e){var r;return null!==(r=this.resolveExperiment(t,e))&&void 0!==r?r:this.resolveDefault(t)},t.prototype.resolveExperiment=function(t,r){var n=t.inAppMessage.messageContext.experimentContext;if(!n)return null;var i=e.requiredNotNullOrUndefined(t.workspace.getExperimentOrNull(n.key),(function(){return"Experiment[".concat(n.key,"]")})),o=IA.by(t,i),s=this.evaluator.evaluate(o,r);this.addExperimentContext(s,r);var u=t.inAppMessage.messageContext.defaultLang;return this.resolveMessage(t,(function(t){return t.lang===u&&s.variationKey===t.variationKey}))},t.prototype.addExperimentContext=function(t,e){e.addEvaluation(t),e.setProperty("experiment_id",t.experiment.id),e.setProperty("experiment_key",t.experiment.key),e.setProperty("variation_id",t.variationId),e.setProperty("variation_key",t.variationKey),e.setProperty("experiment_decision_reason",t.reason)},t.prototype.resolveDefault=function(t){var e=t.inAppMessage.messageContext.defaultLang;return this.resolveMessage(t,(function(t){return t.lang===e}))},t.prototype.resolveMessage=function(t,r){var n=t.inAppMessage.messageContext.messages.find(r);return e.requiredNotNullOrUndefined(n,(function(){return"InAppMessage must be decided [".concat(t.inAppMessage.id,"]")}))},t}(),Ub=function(){function t(){}return t.prototype.matches=function(t,e){var r=this;return t.inAppMessage.targetContext.overrides.some((function(e){return r.isUserOverridden(t,e)}))},t.prototype.isUserOverridden=function(t,r){var n=t.user.identifiers[r.identifierType];return!e.isNullOrUndefined(n)&&r.identifiers.includes(n)},t}(),Pb=function(){function t(t){this.targetMatcher=t}return t.prototype.matches=function(t,e){var r=this,n=t.inAppMessage.targetContext.targets;return 0===n.length||n.some((function(n){return r.targetMatcher.matches(t,e,n)}))},t}(),kb=function(){function t(t){this.storage=t}return t.prototype.matches=function(t,e){return this.storage.exist(t.inAppMessage,t.timestamp)},t}(),Db=function(){function t(t,e){this.targetMatcher=t,this.bucketer=e}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.parameter.targetRules.find((function(n){return r.matches(t,e,n)}))},t.prototype.matches=function(t,r,n){if(!this.targetMatcher.matches(t,r,n.target))return!1;var i=t.user.identifiers[t.parameter.identifierType];if(e.isNullOrUndefined(i))return!1;var o=t.workspace.getBucketOrNull(n.bucketId);if(e.isNullOrUndefined(o))throw new Error("bucket[".concat(n.bucketId,"]"));return e.isNotNullOrUndefined(this.bucketer.bucketing(o,i))},t}(),Lb=function(){function t(){}return t.get=function(t){return e.requiredNotNullOrUndefined(this.getOrNull(t),(function(){return"Instance not registered [".concat(t,"]")}))},t.getOrNull=function(e){return t.instances.get(e)},t.register=function(e,r){return t.instances.set(e,r),r},t.instances=new Map,t}(),Fb=function(){function t(t,e,r){var n=new ab,i=Lb.register("targetMatcher",new RA(new ob(t))),o=new sb(n),s=new Ib(e,i,o),u=new _b(n);this.abTestFlow=cb.of(new fb(s),new Eb,new mb(u),new db(new wb(i)),new pb,new lb,new hb,new vb(o)),this.featureFlagFlow=cb.of(new pb,new lb,new hb,new fb(s),new Eb,new yb(new Tb(i),o),new gb(o));var a=new xb(t);this.inAppMessageFlow=cb.of(new bb,new Nb(new Ub,a),new Ob,new Rb,new Mb,new Sb(new kb(r)),new Cb(new Pb(i),a)),this.remoteConfigParameterTargetRuleDeterminer=new Db(i,n)}return t.prototype.getExperimentFlow=function(t){switch(t){case"AB_TEST":return this.abTestFlow;case"FEATURE_FLAG":return this.featureFlagFlow}},t.prototype.getInAppMessageFlow=function(){return this.inAppMessageFlow},t}(),Vb=function(){function t(t){this.clock=t}return t.prototype.create=function(e,r){var n=this,i=this.clock.currentMillis(),o=new Array,s=this.createEvent(e,r,i,{});return s&&o.push(s),r.targetEvaluations.forEach((function(r){var s,u=((s={})[t.ROOT_TYPE]=e.key.type,s[t.ROOT_ID]=e.key.id,s),a=n.createEvent(e,r,i,u);a&&o.push(a)})),o},t.prototype.createEvent=function(e,r,n,i){var o;if(r instanceof yA)return i[t.CONFIG_ID_PROPERTY_KEY]=null===(o=r.config)||void 0===o?void 0:o.id,i[t.EXPERIMENT_VERSION_KEY]=r.experiment.version,i[t.EXECUTION_VERSION_KEY]=r.experiment.executionVersion,aA.exposure(e.user,r,i,n);if(r instanceof mA)return aA.remoteConfig(e.user,r,a(a({},i),r.properties),n);if(r instanceof Ab)return null;throw new Error("Unsupported Evaluation [".concat(typeof r,"]"))},t.ROOT_TYPE="$targetingRootType",t.ROOT_ID="$targetingRootId",t.CONFIG_ID_PROPERTY_KEY="$parameterConfigurationId",t.EXPERIMENT_VERSION_KEY="$experiment_version",t.EXECUTION_VERSION_KEY="$execution_version",t}(),Gb=function(t){function e(e){var r=t.call(this)||this;return r.evaluationFlowFactory=e,r}return u(e,t),e.prototype.supports=function(t){return void 0!==t.inAppMessage},e.prototype.evaluateInternal=function(t,e){var r;return null!==(r=this.evaluationFlowFactory.getInAppMessageFlow().evaluate(t,e))&&void 0!==r?r:Ab.of(t,e,S.NOT_IN_IN_APP_MESSAGE_TARGET)},e}(vA),jb=function(){function t(t,e,r,n){this.key=new wA("IN_APP_MESSAGE",r.id),this.workspace=t,this.user=e,this.inAppMessage=r,this.timestamp=n}return t.of=function(e,r,n,i){return new t(e,r,n,i)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.inAppMessage.key,")")},t}(),Hb=i.log,Bb=function(){function t(t,e,r,n,i,o,s,u){this.experimentEvaluator=t,this.remoteConfigEvaluator=e,this.inAppMessageEvaluator=r,this.workspaceFetcher=n,this.eventFactory=i,this.eventProcessor=o,this.errorDedupDeterminer=s,this.clock=u}return t.create=function(e,r,n,i){var o=new OA,s=new bA(n),u=new Fb(o,s,i),a=new gA(u),c=new EA(u.remoteConfigParameterTargetRuleDeterminer),f=new Gb(u);return o.add(a),o.add(c),new t(a,c,f,e,new Vb(m.instance),r,new zb,m.instance)},t.prototype.experiment=function(t,e,r){var n=this;if(!t)return Hb.error("experimentKey must not be empty"),N.of(r,S.INVALID_INPUT);var i=this.workspaceFetcher.get();if(!i)return Hb.warn("SDK not ready."),N.of(r,S.SDK_NOT_READY);var o=i.getExperimentOrNull(t);if(!o)return Hb.warn("Experiment does not exist."),N.of(r,S.EXPERIMENT_NOT_FOUND);var s=IA.of(i,e,o,r),u=this.experimentInternal(s),a=u[0],c=u[1];return this.eventFactory.create(s,a).forEach((function(t){return n.eventProcessor.process(t)})),c},t.prototype.experiments=function(t){var e=this,r=new Me((function(t,e){return t.id===e.id})),n=this.workspaceFetcher.get();return n?(n.getExperiments().forEach((function(i){var o=IA.of(n,t,i,"A"),s=e.experimentInternal(o);s[0];var u=s[1];r.add(i,u)})),r):r},t.prototype.experimentInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,TA.create()),n=null!==(e=r.config)&&void 0!==e?e:new E;return[r,N.of(r.variationKey,r.reason,n,r.experiment)]},t.prototype.featureFlag=function(t,e){var r=this;if(!t)return Hb.error("featureKey must not be empty"),O.off(S.INVALID_INPUT);var n=this.workspaceFetcher.get();if(!n)return Hb.warn("SDK not ready."),O.off(S.SDK_NOT_READY);var i=n.getFeatureFlagOrNull(t);if(!i)return Hb.warn("FeatureFlag does not exist."),O.off(S.FEATURE_FLAG_NOT_FOUND);var o=IA.of(n,e,i,"A"),s=this.featureFlagInternal(o),u=s[0],a=s[1];return this.eventFactory.create(o,u).forEach((function(t){return r.eventProcessor.process(t)})),a},t.prototype.featureFlags=function(t){var e=this,r=new Me((function(t,e){return t.id===e.id})),n=this.workspaceFetcher.get();return n?(n.getFeatureFlags().forEach((function(i){var o=IA.of(n,t,i,"A"),s=e.featureFlagInternal(o);s[0];var u=s[1];r.add(i,u)})),r):r},t.prototype.featureFlagInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,TA.create()),n=null!==(e=r.config)&&void 0!==e?e:new E;return[r,"A"===r.variationKey?O.off(r.reason,n,r.experiment):O.on(r.reason,n,r.experiment)]},t.prototype.inAppMessage=function(t,e){var r=this,n=this.workspaceFetcher.get();if(!n)return Hb.warn("SDK not ready."),b.of(S.SDK_NOT_READY);var i=n.getInAppMessageOrNull(t);if(!i)return Hb.warn("In app message does not exist."),b.of(S.IN_APP_MESSAGE_NOT_FOUND);var o=jb.of(n,e,i,this.clock.currentMillis()),s=this.inAppMessageEvaluator.evaluate(o,TA.create());return this.eventFactory.create(o,s).forEach((function(t){return r.eventProcessor.process(t)})),b.of(s.reason,s.inAppMessage,s.message,s.properties)},t.prototype.tryInAppMessage=function(t,e){var r,n=ae.start();try{r=this.inAppMessage(t,e)}catch(e){Hb.error("Unexpected error while deciding in app message [".concat(t,"]: ").concat(e)),r=b.of(S.EXCEPTION)}return Qe.inAppMessage(n,t,r),r},t.prototype.track=function(t,e,r){var n;if(void 0===r&&(r=(new Date).getTime()),t)if("object"==typeof t)if("object"!=typeof t||t.key&&"string"==typeof t.key){var i=(null===(n=this.workspaceFetcher.get())||void 0===n?void 0:n.getEventTypeOrNull(t.key))||new D(0,t.key);this.eventProcessor.process(aA.track(i,t,e,r))}else Hb.warn("Event key must be not null. or event key must be string type.");else Hb.warn("Event must be event type.");else Hb.warn("event must not be null.")},t.prototype.trackException=function(t,e){if(!this.errorDedupDeterminer.isDedupTarget(t)){var r=dA.toEvent(t);this.flush(),this.track(r,e),this.flush()}},t.prototype.flush=function(t){void 0===t&&(t=!1),this.eventProcessor.flush(t)},t.prototype.remoteConfig=function(t,r,n,i){var o=this,s=this.workspaceFetcher.get();if(e.isNullOrUndefined(s))return Hb.warn("SDK not ready."),A.of(i,S.SDK_NOT_READY);var u=s.getRemoteConfigParameterOrNull(t);if(e.isNullOrUndefined(u))return Hb.warn("Remote config parameter does not exist."),A.of(i,S.REMOTE_CONFIG_PARAMETER_NOT_FOUND);var a=_A.of(s,r,u,n,i),c=this.remoteConfigEvaluator.evaluate(a,TA.create());return this.eventFactory.create(a,c).forEach((function(t){return o.eventProcessor.process(t)})),A.of(c.value,c.reason)},t.prototype.close=function(){this.eventProcessor.close()},t}(),zb=function(){function t(){}return t.prototype.isDedupTarget=function(t){return!!this._isSameError(t,this.previous)||(this.previous=t,!1)},t.prototype._isSameError=function(t,r){return!e.isNullOrUndefined(r)&&(t.name===r.name&&t.message===r.message&&t.stack===r.stack)},t}(),Kb=function(){function t(){this._installed=[],this._installations={onerror:Yb,onunhandledrejection:qb}}return t.prototype.install=function(t,e){this._install("onerror",t,e),this._install("onunhandledrejection",t,e)},t.prototype._install=function(t,e,r){t in this._installed||((0,this._installations[t])(e,r),this._installed.push(t))},t}(),Jb=null;function Yb(t,r){Jb=window.onerror,window.onerror=function(n,i,o,s,u){e.isNotNullOrUndefined(u)&&t.trackException(u,r.resolve()),Jb&&Jb.apply(this,arguments)}}function qb(t,e){uA=window.onunhandledrejection,window.onunhandledrejection=function(r){var n;try{"reason"in r?n=r.reason:"detail"in r&&"reason"in r.detail&&(n=r.detail.reason)}catch(t){}n instanceof Error&&t.trackException(n,e.resolve()),uA&&uA.apply(this,arguments)}}var Xb=function(){function t(t,e,r){this.storage=t,this.storageKey=e,this.maxSize=r}return t.prototype.read=function(){return c(this,void 0,void 0,(function(){var t;return f(this,(function(e){return(t=this.storage.getItem(this.storageKey))?[2,JSON.parse(t)]:[2,[]]}))}))},t.prototype.save=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){return 0===t.length?[2,this.clear()]:(e=JSON.stringify(t.slice(-this.maxSize)),this.storage.setItem(this.storageKey,e),[2])}))}))},t.prototype.add=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:return[4,this.read()];case 1:return e=r.sent(),[4,this.save(e.concat(t).slice(-this.maxSize))];case 2:return r.sent(),[2]}}))}))},t.prototype.delete=function(t){return c(this,void 0,void 0,(function(){var e,r,n=this;return f(this,(function(i){switch(i.label){case 0:return[4,this.read()];case 1:return e=i.sent(),r=e.filter((function(e){return!n.isDeleteTarget(e,t)})),[4,this.save(r)];case 2:return i.sent(),[2]}}))}))},t.prototype.isDeleteTarget=function(t,e){return e.some((function(e){return e.insertId===t.insertId}))},t.prototype.clear=function(){return c(this,void 0,void 0,(function(){return f(this,(function(t){return this.storage.removeItem(this.storageKey),[2]}))}))},t}(),Wb=function(t,e){return null!==t&&(t.userId===e.userId&&t.deviceId===e.deviceId)},$b=function(){function t(t){this.cohorts=t}return t.builder=function(){return new Zb},t.empty=function(){return t.builder().build()},t.from=function(e){return new t(e)},t.fromDto=function(e){for(var r=t.builder(),n=0,i=e.cohorts;n<i.length;n++){var o=i[n];r.put({identifier:o.identifier,cohorts:o.cohorts.map((function(t){return new zt(t)}))})}return r.build()},Object.defineProperty(t.prototype,"rawCohorts",{get:function(){return this.cohorts.values().flatMap((function(t){return t.cohorts}))},enumerable:!1,configurable:!0}),t.prototype.get=function(t){return this.cohorts.get(t)},t.prototype.filterBy=function(e){var r=F(e),n=this.asComparable().filter((function(t,e){return r[t.type]===t.value}));return t.from(n)},t.prototype.asArray=function(){return this.cohorts.values()},t.prototype.asComparable=function(){return this.cohorts},t.prototype.toBuilder=function(){return new Zb(this)},t}(),Zb=function(){function t(t){this.cohorts=new Me(h.isEqual),t&&this.putAll(t)}return t.prototype.put=function(t){return this.cohorts.add(t.identifier,t),this},t.prototype.putAll=function(t){var e=this;return t.asArray().forEach((function(t){return e.put(t)})),this},t.prototype.build=function(){return new $b(this.cohorts)},t}(),Qb="model",tN="name",eN="type",rN="vendor",nN="version",iN="architecture",oN="console",sN="mobile",uN="tablet",aN="smarttv",cN="wearable",fN=function(){function t(){}return t.parse=function(e){return{browser:t.getBrowser(e),cpu:t.getCPU(e),device:t.getDevice(e),engine:t.getEngine(e),os:t.getOS(e)}},t.getBrowser=function(e){var r={name:void 0,version:void 0,major:void 0};return t.mapper.rgx.call(r,e,t.regexes.browser),r.major=t.util.major(r.version),r},t.getCPU=function(e){var r={architecture:void 0};return t.mapper.rgx.call(r,e,t.regexes.cpu),r},t.getDevice=function(e){var r={model:void 0,type:void 0,vendor:void 0};return t.mapper.rgx.call(r,e,t.regexes.device),r},t.getEngine=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.getOS=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.util={extend:function(t,e){var r={};for(var n in t)e[n]&&e[n].length%2==0?r[n]=e[n].concat(t[n]):r[n]=t[n];return r},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},t.mapper={rgx:function(t,e){for(var r,n,i,o,s,u,a=0;a<e.length&&!s;){var c=e[a],f=e[a+1];for(r=n=0;r<c.length&&!s;)if(s=c[r++].exec(t))for(i=0;i<f.length;i++)u=s[++n],"object"==typeof(o=f[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,u):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=u?u.replace(o[1],o[2]):void 0:this[o[0]]=u?o[1].call(this,u,o[2]):void 0:4==o.length&&(this[o[0]]=u?o[3].call(this,u.replace(o[1],o[2])):void 0):this[o]=u||void 0;a+=2}},str:function(e,r){for(var n in r)if("object"==typeof r[n]&&r[n].length>0){for(var i=0;i<r[n].length;i++)if(t.util.has(r[n][i],e))return"?"===n?void 0:n}else if(t.util.has(r[n],e))return"?"===n?void 0:n;return e}},t.maps={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},t.regexes={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[tN,nN],[/(opios)[\/\s]+([\w\.]+)/i],[[tN,"Opera Mini"],nN],[/\s(opr)\/([\w\.]+)/i],[[tN,"Opera"],nN],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[tN,nN],[/(konqueror)\/([\w\.]+)/i],[[tN,"Konqueror"],nN],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[tN,"IE"],nN],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[tN,"Edge"],nN],[/(yabrowser)\/([\w\.]+)/i],[[tN,"Yandex"],nN],[/(Avast)\/([\w\.]+)/i],[[tN,"Avast Secure Browser"],nN],[/(AVG)\/([\w\.]+)/i],[[tN,"AVG Secure Browser"],nN],[/(puffin)\/([\w\.]+)/i],[[tN,"Puffin"],nN],[/(focus)\/([\w\.]+)/i],[[tN,"Firefox Focus"],nN],[/(opt)\/([\w\.]+)/i],[[tN,"Opera Touch"],nN],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[tN,"UCBrowser"],nN],[/(comodo_dragon)\/([\w\.]+)/i],[[tN,/_/g," "],nN],[/(windowswechat qbcore)\/([\w\.]+)/i],[[tN,"WeChat(Win) Desktop"],nN],[/(micromessenger)\/([\w\.]+)/i],[[tN,"WeChat"],nN],[/(brave)\/([\w\.]+)/i],[[tN,"Brave"],nN],[/(whale)\/([\w\.]+)/i],[[tN,"Whale"],nN],[/(qqbrowserlite)\/([\w\.]+)/i],[tN,nN],[/(QQ)\/([\d\.]+)/i],[tN,nN],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[tN,nN],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[tN,nN],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[tN,nN],[/(MetaSr)[\/\s]?([\w\.]+)/i],[tN],[/(LBBROWSER)/i],[tN],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[nN,[tN,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[nN,[tN,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[tN,nN],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[nN,[tN,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[tN,/(.+)/,"$1 WebView"],nN],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[tN,/(.+(?:g|us))(.+)/,"$1 $2"],nN],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[tN,"Chrome Mobile"],nN],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[nN,[tN,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[tN,"Sailfish Browser"],nN],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[tN,nN],[/(dolfin)\/([\w\.]+)/i],[[tN,"Dolphin"],nN],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[tN,"360 Browser"]],[/(coast)\/([\w\.]+)/i],[[tN,"Opera Coast"],nN],[/fxios\/([\w\.-]+)/i],[nN,[tN,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[nN,[tN,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[nN,tN],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[tN,"GSA"],nN],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[tN,[nN,t.mapper.str,t.maps.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[tN,nN],[/(navigator|netscape)\/([\w\.-]+)/i],[[tN,"Netscape"],nN],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[tN,nN]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[iN,"amd64"]],[/(ia32(?=;))/i],[[iN,t.util.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[iN,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[iN,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[iN,/ower/,"",t.util.lowerize]],[/(sun4\w)[;\)]/i],[[iN,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[iN,t.util.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[Qb,rN,[eN,uN]],[/applecoremedia\/[\w\.]+ \((ipad)/],[Qb,[rN,"Apple"],[eN,uN]],[/(apple\s{0,1}tv)/i],[[Qb,"Apple TV"],[rN,"Apple"],[eN,aN]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[rN,Qb,[eN,uN]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[Qb,[rN,"Amazon"],[eN,uN]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[Qb,t.mapper.str,t.maps.device.amazon.model],[rN,"Amazon"],[eN,sN]],[/android.+aft([bms])\sbuild/i],[Qb,[rN,"Amazon"],[eN,aN]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[Qb,rN,[eN,sN]],[/\((ip[honed|\s\w*]+);/i],[Qb,[rN,"Apple"],[eN,sN]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[rN,Qb,[eN,sN]],[/\(bb10;\s(\w+)/i],[Qb,[rN,"BlackBerry"],[eN,sN]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[Qb,[rN,"Asus"],[eN,uN]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[rN,"Sony"],[Qb,"Xperia Tablet"],[eN,uN]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[Qb,[rN,"Sony"],[eN,sN]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[rN,Qb,[eN,oN]],[/android.+;\s(shield)\sbuild/i],[Qb,[rN,"Nvidia"],[eN,oN]],[/(playstation\s[34portablevi]+)/i],[Qb,[rN,"Sony"],[eN,oN]],[/(sprint\s(\w+))/i],[[rN,t.mapper.str,t.maps.device.sprint.vendor],[Qb,t.mapper.str,t.maps.device.sprint.model],[eN,sN]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[rN,[Qb,/_/g," "],[eN,sN]],[/(nexus\s9)/i],[Qb,[rN,"HTC"],[eN,uN]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[Qb,[rN,"Huawei"],[eN,sN]],[/android.+(bah2?-a?[lw]\d{2})/i],[Qb,[rN,"Huawei"],[eN,uN]],[/(microsoft);\s(lumia[\s\w]+)/i],[rN,Qb,[eN,sN]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[Qb,[rN,"Microsoft"],[eN,oN]],[/(kin\.[onetw]{3})/i],[[Qb,/\./g," "],[rN,"Microsoft"],[eN,sN]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[Qb,[rN,"Motorola"],[eN,sN]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[Qb,[rN,"Motorola"],[eN,uN]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[rN,t.util.trim],[Qb,t.util.trim],[eN,aN]],[/hbbtv.+maple;(\d+)/i],[[Qb,/^/,"SmartTV"],[rN,"Samsung"],[eN,aN]],[/\(dtv[\);].+(aquos)/i],[Qb,[rN,"Sharp"],[eN,aN]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[rN,"Samsung"],Qb,[eN,uN]],[/smart-tv.+(samsung)/i],[rN,[eN,aN],Qb],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[rN,"Samsung"],Qb,[eN,sN]],[/sie-(\w*)/i],[Qb,[rN,"Siemens"],[eN,sN]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[rN,"Nokia"],Qb,[eN,sN]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[Qb,[rN,"Acer"],[eN,uN]],[/android.+([vl]k\-?\d{3})\s+build/i],[Qb,[rN,"LG"],[eN,uN]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[rN,"LG"],Qb,[eN,uN]],[/(lg) netcast\.tv/i],[rN,Qb,[eN,aN]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[Qb,[rN,"LG"],[eN,sN]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[rN,Qb,[eN,uN]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[Qb,[rN,"Lenovo"],[eN,uN]],[/(lenovo)[_\s-]?([\w-]+)/i],[rN,Qb,[eN,sN]],[/linux;.+((jolla));/i],[rN,Qb,[eN,sN]],[/((pebble))app\/[\d\.]+\s/i],[rN,Qb,[eN,cN]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[rN,Qb,[eN,sN]],[/crkey/i],[[Qb,"Chromecast"],[rN,"Google"],[eN,aN]],[/android.+;\s(glass)\s\d/i],[Qb,[rN,"Google"],[eN,cN]],[/android.+;\s(pixel c)[\s)]/i],[Qb,[rN,"Google"],[eN,uN]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[Qb,[rN,"Google"],[eN,sN]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[Qb,/_/g," "],[rN,"Xiaomi"],[eN,sN]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[Qb,/_/g," "],[rN,"Xiaomi"],[eN,uN]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[Qb,[rN,"Meizu"],[eN,sN]],[/(mz)-([\w-]{2,})/i],[[rN,"Meizu"],Qb,[eN,sN]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[Qb,[rN,"OnePlus"],[eN,sN]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[Qb,[rN,"RCA"],[eN,uN]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[Qb,[rN,"Dell"],[eN,uN]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[Qb,[rN,"Verizon"],[eN,uN]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[rN,"Barnes & Noble"],Qb,[eN,uN]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[Qb,[rN,"NuVision"],[eN,uN]],[/android.+;\s(k88)\sbuild/i],[Qb,[rN,"ZTE"],[eN,uN]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[Qb,[rN,"Swiss"],[eN,sN]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[Qb,[rN,"Swiss"],[eN,uN]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[Qb,[rN,"Zeki"],[eN,uN]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[rN,"Dragon Touch"],Qb,[eN,uN]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[Qb,[rN,"Insignia"],[eN,uN]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[Qb,[rN,"NextBook"],[eN,uN]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[rN,"Voice"],Qb,[eN,sN]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[rN,"LvTel"],Qb,[eN,sN]],[/android.+;\s(PH-1)\s/i],[Qb,[rN,"Essential"],[eN,sN]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[Qb,[rN,"Envizen"],[eN,uN]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[rN,Qb,[eN,uN]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[Qb,[rN,"MachSpeed"],[eN,uN]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[rN,Qb,[eN,uN]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[Qb,[rN,"Rotor"],[eN,uN]],[/android.+(KS(.+))\s+build/i],[Qb,[rN,"Amazon"],[eN,uN]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[rN,Qb,[eN,uN]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[eN,t.util.lowerize],rN,Qb],[/[\s\/\(](smart-?tv)[;\)]/i],[[eN,aN]],[/(android[\w\.\s\-]{0,9});.+build/i],[Qb,[rN,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[nN,[tN,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[nN,[tN,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[tN,nN],[/rv\:([\w\.]{1,9}).+(gecko)/i],[nN,tN]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[tN,nN],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[tN,t.mapper.str,t.maps.os.windows],[nN,t.mapper.str,t.maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[tN,"Windows"],[nN,t.mapper.str,t.maps.os.windows.version]],[/\((bb)(10);/i],[[tN,"BlackBerry"],nN],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[tN,nN],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[tN,"Symbian"],nN],[/\((series40);/i],[tN],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[tN,"Firefox OS"],nN],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[tN,"Linux"],nN],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[tN,"Chromium OS"],nN],[/(sunos)\s?([\w\.\d]*)/i],[[tN,"Solaris"],nN],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[tN,"Linux"],nN],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[tN,"iOS"],[nN,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[tN,"iOS"],[nN,/_/g,"."]],[/(haiku)\s(\w+)/i],[tN,nN],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[nN,/_/g,"."],[tN,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[tN,"Mac"],[nN,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[tN,nN]]},t}(),pN=function(){function t(){}return t.generate=function(t){var e,r,n,i,o,s,u;if(void 0===t){var a={hostname:"",pathname:"",host:"",search:"",protocol:""};u={navigator:{userAgent:"",vendor:"",languages:[]},document:{location:a,title:""},location:a,screen:{width:"",height:""}}}else u=t;var c=fN.parse(u.navigator.userAgent),f=c.browser,p=c.os,l=c.device,h=(u.location.protocol||"").replace(":",""),d=u.screen,v=(null===(e=u.navigator.languages)||void 0===e?void 0:e[0])||"",y=v.split("-")[0],g=(null!==(r=l.type)&&void 0!==r?r:"pc").replace(/\b(mobile|smarttv)\b/g,(function(t,e){return"mobile"===e?"phone":"smarttv"===e?"tv":t})),m=p.name||"",E="",w="";try{m=null!==(i=null===(n=m.match(/\b(Mac|Windows|Linux|Android|iOS)\b/))||void 0===n?void 0:n[0])&&void 0!==i?i:m,E=null!==(s=null===(o=d.orientation.type.match(/\b(landscape|portrait)\b/))||void 0===o?void 0:o[0])&&void 0!==s?s:"",w=Intl.DateTimeFormat().resolvedOptions().timeZone||""}catch(t){}return{platform:"Web",browserName:f.name||"",browserMajorVersion:f.major||"",browserVersion:f.version||"",osName:m,osVersion:p.version||"",deviceModel:l.model||"",deviceType:g,deviceVendor:l.vendor||"",deviceBrand:l.vendor||"",locale:v,language:y,orientation:E,userAgent:u.navigator.userAgent||"",pagePath:u.location.pathname||"",pageTitle:u.document.title||"",host:u.location.host||"",url:u.location.href||"",protocol:h,referrer:u.document.referrer||"",queryParameter:u.location.search||"",screenWidth:d.width||"",screenHeight:d.height||"",timeZone:w}},t}(),lN=function(){function t(t,e,r,n,i,o,s){this.hackleDeviceId=t,this.storage=e,this.cohortFetcher=r,this.campaignParser=n,this.clock=i,this.userListeners=[],this.defaultUser={id:this.hackleDeviceId,deviceId:this.hackleDeviceId},this.context=this.initContext(o,s),this.storage.saveUser(this.context.user)}return t.prototype.initContext=function(t,e){var r,n=null!==(r=null!=e?e:t)&&void 0!==r?r:this.defaultUser;return dN.of(vN(n,this.hackleDeviceId),$b.empty())},t.prototype.addListener=function(t){this.userListeners.push(t)},Object.defineProperty(t.prototype,"currentUser",{get:function(){return this.context.user},enumerable:!1,configurable:!0}),t.prototype.resolve=function(t){var e=this.resolveContext(t);return this.hackleUser(e)},t.prototype.resolveContext=function(t){return void 0===t?this.context:"string"==typeof t?this.updateUser({id:t}):this.updateUser(t)},t.prototype.toHackleUser=function(t){var e=this.context.with(t);return this.hackleUser(e)},t.prototype.hackleUser=function(t){var r=(new V).addIdentifiers(t.user.identifiers||{}).add(L.ID,t.user.id||this.hackleDeviceId).add(L.DEVICE,t.user.deviceId||this.hackleDeviceId).add(L.HACKLE_DEVICE,this.hackleDeviceId);e.isNotNullOrUndefined(t.user.userId)&&r.add(L.USER,t.user.userId);var n=r.build(),i=this.campaignParser.parse();return{identifiers:n,properties:a(a({},i),t.user.properties),hackleProperties:this.hackleProperties(),cohorts:t.cohorts.rawCohorts}},t.prototype.hackleProperties=function(){var t;return"undefined"!=typeof window&&(t=pN.generate(window)),t||{}},t.prototype.setUser=function(t){return this.updateUser(t).user},t.prototype.setUserId=function(t){var e=a(a({},this.context.user),{userId:t});return this.setUser(e)},t.prototype.setDeviceId=function(t){var e=a(a({},this.context.user),{deviceId:t});return this.setUser(e)},t.prototype.updateUserProperties=function(t){return this.operateProperties(t).user},t.prototype.resetUser=function(){var t=this;return this.updateContext((function(){return t.defaultUser})).user},t.prototype.changeUser=function(t,e,r){this.userListeners.forEach((function(n){n.onUserUpdated(t,e,r)}))},t.prototype.saveUser=function(t){this.storage.saveUser(t)},t.prototype.updateContext=function(t){var e=this.context.user,r=t(e),n=this.context.with(r);return this.context=n,Wb(e,r)||(this.changeUser(e,r,this.clock.currentMillis()),this.saveUser(r)),n},t.prototype.updateUser=function(t){var e=this;return this.updateContext((function(r){return n=r,i=vN(t,e.hackleDeviceId),Wb(n,i)?a(a({},i),{properties:a(a({},n.properties),i.properties)}):i;var n,i}))},t.prototype.operateProperties=function(t){return this.updateContext((function(r){var n,i=null!==(n=r.properties)&&void 0!==n?n:{},o=t.operate(new Map(Object.entries(i)));return a(a({},r),{properties:e.fromMap(o)})}))},t.prototype.sync=function(){return c(this,void 0,void 0,(function(){var t,e;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.cohortFetcher.fetch(this.currentUser)];case 1:return t=r.sent(),this.context=this.context.update(t),[3,3];case 2:return e=r.sent(),i.log.error("Failed to sync cohorts: ".concat(e)),[3,3];case 3:return[2]}}))}))},t.prototype.close=function(){return c(this,void 0,void 0,(function(){return f(this,(function(t){return[2]}))}))},t}(),hN=function(){function t(t){this.storage=t}return t.prototype.getUser=function(){var t=this.deviceId||void 0,e=this.userId||void 0;return void 0!==t||void 0!==e?{deviceId:t,userId:e}:null},t.prototype.saveUser=function(t){this.setDeviceId(t.deviceId||null),this.setUserId(t.userId||null)},Object.defineProperty(t.prototype,"deviceId",{get:function(){return this.storage.getItem(ie)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this.storage.getItem(ne)},enumerable:!1,configurable:!0}),t.prototype.setDeviceId=function(t){this.setId(ie,t)},t.prototype.setUserId=function(t){this.setId(ne,t)},t.prototype.setId=function(t,r){e.isNotNullOrUndefined(r)?this.storage.setItem(t,r):this.storage.removeItem(t)},t}(),dN=function(){function t(t,e){this.user=t,this.cohorts=e}return t.of=function(e,r){return new t(e,r.filterBy(e))},t.prototype.with=function(e){return t.of(e,this.cohorts.filterBy(e))},t.prototype.update=function(e){var r=e.filterBy(this.user),n=this.cohorts.toBuilder().putAll(r).build();return t.of(this.user,n)},t}(),vN=function(t,e){return a(a({},t),{id:t.id||e,deviceId:t.deviceId||e})},yN=function(){function t(t,e){this.sessionTimeoutMillis=t,this.storage=e,this.sessionListeners=[],this._currentSessionId=null,this._lastEventTime=null,this.loadSession(),this.loadLastEventTime()}return Object.defineProperty(t.prototype,"currentSessionId",{get:function(){return this._currentSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){var e;return null!==(e=this._currentSessionId)&&void 0!==e?e:t.EMPTY_SESSION_ID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},enumerable:!1,configurable:!0}),t.prototype.addListener=function(t){this.sessionListeners.push(t)},t.prototype.startNewSession=function(t,e,r){return t&&this.endSession(t),this.newSession(e,r)},t.prototype.startNewSessionIfNeeded=function(t,e){var r=this._lastEventTime;return null===r?this.startNewSession(t,t,e):null!==this._currentSessionId&&e-r<this.sessionTimeoutMillis?(this.updateLastEventTime(e),this._currentSessionId):this.startNewSession(t,t,e)},t.prototype.updateLastEventTime=function(t){this._lastEventTime=t,this.storage.setItem(te,"".concat(t))},t.prototype.endSession=function(t){var e=this._currentSessionId,r=this._lastEventTime;null!==e&&null!==r&&this.sessionListeners.forEach((function(n){return n.onSessionEnded(e,t,r)}))},t.prototype.newSession=function(t,e){var r=function(t){return"".concat(t,".").concat(Ne().slice(0,8))}(e);return this.saveSession(r),this.updateLastEventTime(e),this.sessionListeners.forEach((function(n){n.onSessionStarted(r,t,e)})),r},t.prototype.saveSession=function(t){this._currentSessionId=t,this.storage.setItem(Qt,t)},t.prototype.loadSession=function(){this._currentSessionId=this.storage.getItem(Qt)},t.prototype.loadLastEventTime=function(){var t=this.storage.getItem(te);if(null!==t){var e=Number.parseFloat(t);e>0&&(this._lastEventTime=e)}},t.prototype.onUserUpdated=function(t,e,r){this.endSession(t),this.newSession(e,r)},t.prototype.onVisibilityChanged=function(t,e){switch(t){case"visible":return;case"hidden":return void this.updateLastEventTime(e)}},t.EMPTY_SESSION_ID="0.ffffffff",t}(),gN=function(){function t(){this.storage=window.localStorage}return t.prototype.getItem=function(t){var e,r;return null!==(r=null===(e=this.storage)||void 0===e?void 0:e.getItem(t))&&void 0!==r?r:null},t.prototype.removeItem=function(t){var e;null===(e=this.storage)||void 0===e||e.removeItem(t)},t.prototype.setItem=function(t,e){var r;null===(r=this.storage)||void 0===r||r.setItem(t,e)},t.prototype.clear=function(){var t;null===(t=this.storage)||void 0===t||t.clear()},t}(),mN=function(){function t(t,e){this.delegate=t,this.transform=e}return t.postfix=function(e,r){return new t(e,(function(t){return"".concat(t).concat(r)}))},t.prefix=function(e,r){return new t(e,(function(t){return"".concat(r).concat(t)}))},t.prototype.getItem=function(t){return this.delegate.getItem(this.transform(t))},t.prototype.removeItem=function(t){this.delegate.removeItem(this.transform(t))},t.prototype.setItem=function(t,e){this.delegate.setItem(this.transform(t),e)},t}(),EN=function(){function t(t,e,r){void 0===r&&(r=4096);var n=this;this.delegate=t,this.listKey=e,this.encodedListCharLen=6,this.resolveMaxLength=function(t){var e=t-n.encodedListCharLen;return e<0?0:e},this.maxLength=this.resolveMaxLength(r)}return t.prototype.isEqualItem=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.prototype.getRemainListSize=function(){try{return this.maxLength-JSON.stringify(this.getList()).length}catch(t){return 0}},t.prototype.isAddableItem=function(t){try{return this.getRemainListSize()>JSON.stringify(t).length}catch(t){return!1}},t.prototype.getVictimIndex=function(t){var e=this.getRemainListSize();try{var r=JSON.stringify(t),n=this.getList(),i=0;return n.findIndex((function(t){return(i+=JSON.stringify(t).length)+e>=r.length}))}catch(t){return-1}},t.prototype.getList=function(){try{var t=this.delegate.getItem(this.listKey);if(!t)return[];var e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(t){return[]}},t.prototype.entries=function(){return this.getList().flatMap(Object.entries)},t.prototype.setItem=function(t,e){var r;try{this.removeItem(t);var n=this.getList(),i=((r={})[t]=e,r);if(!this.isAddableItem(i)){var o=this.getVictimIndex(i);if(o<0)return;n=n.slice(o+1)}var s=JSON.stringify(n.concat(i));this.delegate.setItem(this.listKey,s)}catch(t){}},t.prototype.getItem=function(t){var e=this,r=this.getList().find((function(r){return e.isEqualItem(r,t)}));if(r&&r[t])return r[t]},t.prototype.removeItem=function(t){var e=this,r=this.getList();try{var n=r.filter((function(r){return!e.isEqualItem(r,t)})),i=JSON.stringify(n);this.delegate.setItem(this.listKey,i)}catch(t){}},t.prototype.clear=function(){this.delegate.removeItem(this.listKey)},t}(),wN=function(){function t(t,e,r,n){this.core=t,this.userManager=e,this.abOverrideStorage=r,this.ffOverrideStorage=n}return t.prototype.currentUser=function(){return this.userManager.resolve()},t.prototype.getAbTestDecisions=function(){return this.core.experiments(this.currentUser()).entries()},t.prototype.getAbTestOverrides=function(){return this.abOverrideStorage.getAll()},t.prototype.setAbTestOverride=function(t,e){this.abOverrideStorage.set(t,e),this.increment("AB_TEST","set")},t.prototype.resetAbTestOverride=function(t){this.abOverrideStorage.remove(t),this.increment("AB_TEST","reset")},t.prototype.resetAllAbTestOverride=function(){this.abOverrideStorage.clear(),this.increment("AB_TEST","reset.all")},t.prototype.getFeatureFlagDecisions=function(){return this.core.featureFlags(this.currentUser()).entries()},t.prototype.getFeatureFlagOverrides=function(){return this.ffOverrideStorage.getAll()},t.prototype.setFeatureFlagOverride=function(t,e){this.ffOverrideStorage.set(t,e),this.increment("FEATURE_FLAG","set")},t.prototype.resetFeatureFlagOverride=function(t){this.ffOverrideStorage.remove(t),this.increment("FEATURE_FLAG","reset")},t.prototype.resetAllFeatureFlagOverride=function(){this.ffOverrideStorage.clear(),this.increment("FEATURE_FLAG","reset.all")},t.prototype.increment=function(t,e){Ke.counter("experiment.manual.override",{"experiment.type":t,operation:e}).increment()},t}(),TN=function(){function t(){}return t.serverFetch=function(t,e){return"".concat(t,"/api/v2/workspaces/").concat(e,"/config")},t.clientFetch=function(t,e){return"".concat(t,"/api/v2/workspaces/").concat(e,"/config")},t.userCohorts=function(t){return"".concat(t,"/api/v1/cohorts")},t.serverDispatch=function(t){return"".concat(t,"/api/v2/events")},t.clientDispatch=function(t){return"".concat(t,"/api/v2/w/events")},t.beaconDispatch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/events")},t.inAppMessageRenderer=function(t,e){return"".concat(t,"/sdk/iam-renderer/").concat(e,"/iam-renderer.js")},t.monitoring=function(t){return"".concat(t,"/metrics")},t}(),IN=function(){function t(t){this.storage=t}return t.prototype.exist=function(t,r){var n=this.key(t),i=this.storage.getItem(n);if(e.isNullOrUndefined(i))return!1;var o=Number.parseInt(i,10);return Number.isNaN(o)?(this.storage.removeItem(n),!1):r<=o||(this.storage.removeItem(n),!1)},t.prototype.put=function(t,e){this.storage.setItem(this.key(t),"".concat(e))},t.prototype.key=function(t){return"".concat(t.key)},t}(),_N=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find((function(e){return e.supports(t)}))},t}(),AN=function(){function t(){}return t.prototype.handle=function(t,e){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),bN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){i.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"WEB_LINK"===t.type},t}(),NN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){i.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_AND_CLOSE"===t.type},t}(),ON=function(){function t(t,e){this.storage=t,this.clock=e}return t.prototype.handle=function(e,r){var n=this.clock.currentMillis()+t.HIDE_EXPIRATION;this.storage.put(e.context.inAppMessage,n),e.close()},t.prototype.supports=function(t){return"HIDDEN"===t.type},t.HIDE_EXPIRATION=864e5,t}(),RN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){i.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_WINDOW"===t.type},t}(),MN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){i.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_WINDOW_AND_CLOSE"===t.type},t}(),SN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){i.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_TAB"===t.type},t}(),CN=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){i.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_TAB_AND_CLOSE"===t.type},t}(),xN=function(){function t(t){this.core=t}return t.prototype.track=function(t,e,r){var n=this.createTrackEvent(e,t);this.core.track(n,t.user,r)},t.prototype.createTrackEvent=function(t,e){var r,n,i,o;switch(t.type){case"IMPRESSION":return{key:"$in_app_impression",properties:a(a({},e.properties),{in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key,title_text:null===(n=null===(r=e.message.text)||void 0===r?void 0:r.title)||void 0===n?void 0:n.text,body_text:null===(o=null===(i=e.message.text)||void 0===i?void 0:i.body)||void 0===o?void 0:o.text,button_text:e.message.buttons.map((function(t){return t.text})),image_url:e.message.images.map((function(t){return t.imagePath}))})};case"CLOSE":return{key:"$in_app_close",properties:a(a({},e.properties),{in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key})};case"ACTION":var s=t;return{key:"$in_app_action",properties:a(a({},e.properties),{in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key,action_type:s.action.type,action_area:s.area,action_value:s.action.value,button_text:s.text})}}},t}(),UN=function(){function t(t,e,r){this.messageViewFactory=t,this.eventHandler=e,this.interactionHandlerFactory=r,this.currentMessageView=null,this.opening=!1}return t.prototype.present=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:if(this.currentMessageView)return[2];if(this.opening)return[2];this.opening=!0,e=null,r.label=1;case 1:return r.trys.push([1,3,4,5]),e=this.messageViewFactory.create(t,this),this.currentMessageView=e,[4,e.open()];case 2:return r.sent(),[3,5];case 3:return r.sent(),null==e||e.close(),[3,5];case 4:return this.opening=!1,[7];case 5:return[2]}}))}))},t}(),PN=function(){function t(t,e,r){var n=this;this.userEventEmitter=t,this.determiner=e,this.presenter=r,this.onEvent=function(t){var e=n.determiner.determineOrNull(t);e&&n.presenter.present(e)},this.initialize()}return t.prototype.initialize=function(){this.userEventEmitter.on("event",this.onEvent)},t.prototype.destroy=function(){this.userEventEmitter.off("event",this.onEvent)},t}(),kN=function(t,e,r,n){this.inAppMessage=t,this.message=e,this.user=r,this.properties=n},DN=function(){function t(t,e,r){this.workspaceFetcher=t,this.eventMatcher=e,this.core=r}return t.prototype.determineOrNull=function(t){var e=this.workspaceFetcher.get();if(e)for(var r=0,n=e.getInAppMessages();r<n.length;r++){var i=n[r];if(this.eventMatcher.matches(e,i,t)){var o=this.context(i,t);if(!o)continue;return o}}},t.prototype.context=function(t,e){var r=this.core.tryInAppMessage(t.key,e.user);if(r.inAppMessage&&r.message){var n=a(a({},r.properties),{decision_reason:r.reason});return new kN(r.inAppMessage,r.message,e.user,v.sanitize(n))}},t}(),LN=function(){function t(e,r,n){var i=this;this.scriptLoader=e,this.context=r,this.ui=n,this.container=null,this.renderer=null,this.handleInAppMessageInteraction=function(e){if(e instanceof CustomEvent&&e.type===t.HACKLE_IAM_INTERACTION_EVENT_TYPE){var r=e.detail;i.handleInteraction(r)}}}return t.prototype.open=function(){return c(this,void 0,void 0,(function(){var e,r,n;return f(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),window.addEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),[4,this.scriptLoader.load()];case 1:return i.sent(),(e=this.addContainer()).style.display="none",e.classList.add("".concat(t.CONTAINER_CLASS_NAME,"--loading")),r=window.HackleInAppMessageRenderer,this.renderer=new r.HackleInAppMessageRenderer(e),n=this.context.user.hackleProperties.deviceType,[4,this.renderer.render({messageId:this.context.inAppMessage.id,message:this.context.message.toJson(),deviceType:n?String(n):null})];case 2:return i.sent(),e.classList.remove("".concat(t.CONTAINER_CLASS_NAME,"--loading")),e.style.display="block",this.handleEvent({type:"IMPRESSION"}),[3,4];case 3:return i.sent(),this.close(),[3,4];case 4:return[2]}}))}))},t.prototype.close=function(){var e;this.handleEvent({type:"CLOSE"}),window.removeEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),null===(e=this.renderer)||void 0===e||e.destroy(),this.renderer=null,this.removeContainer(),this.ui.currentMessageView=null},t.prototype.addContainer=function(){if(!this.container){var e=document.createElement("div");e.classList.add(t.CONTAINER_CLASS_NAME),this.container=e}return this.container.parentNode||document.body.appendChild(this.container),this.container},t.prototype.removeContainer=function(){var t;this.container&&(null===(t=this.container.parentNode)||void 0===t||t.removeChild(this.container),this.container=null)},t.prototype.handleInteraction=function(t){var e=this.ui.interactionHandlerFactory.get(t);e&&e.handle(this,t)},t.prototype.handleEvent=function(t){this.ui.eventHandler.handle(this,t)},t.HACKLE_IAM_INTERACTION_EVENT_TYPE="hackle-iam-interaction",t.CONTAINER_CLASS_NAME="hackle-iam",t}(),FN=function(){function t(t){this.scriptLoader=t}return t.create=function(e){return new t(e)},t.prototype.create=function(t,e){return new LN(this.scriptLoader,t,e)},t}(),VN=function(){function t(t){this.scriptUrl=t}return t.prototype.load=function(){return c(this,void 0,void 0,(function(){var t;return f(this,(function(e){switch(e.label){case 0:return window.HackleInAppMessageRenderer?[2]:(t=this.createScript(),document.head.appendChild(t),[4,this.waitForLoad(t)]);case 1:return[2,e.sent()]}}))}))},t.prototype.createScript=function(){var t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.src=this.scriptUrl,t},t.prototype.waitForLoad=function(t){return new Promise((function(e,r){var n=function(){o(),e(t)},i=function(t){o(),r(t.message)},o=function(){t.removeEventListener("error",i),t.removeEventListener("load",n)};t.addEventListener("load",n),t.addEventListener("error",i)}))},t}(),GN=function(){function t(t){this.targetMatcher=t}return t.prototype.isTriggerTarget=function(t,e,r){var n=this;return e.eventTrigger.rules.some((function(i){return n.ruleMatches(t,r,e,i)}))},t.prototype.ruleMatches=function(t,e,r,n){if(e.event.key!==n.eventKey)return!1;var i=jN.of(t,e,r);return this.targetMatcher.anyMatches(i,TA.create(),n.targets)},t}(),jN=function(){function t(t,e,r,n){this.key=t,this.workspace=e,this.user=r,this.event=n}return t.of=function(e,r,n){return new t(new wA("IN_APP_MESSAGE",n.id),e,r.user,r)},t}(),HN=function(){function t(t){this.storage=t}return t.prototype.isTriggerTarget=function(t,e,r){if(!e.eventTrigger.frequencyCap)return!0;var n=this.createMatchContexts(e.eventTrigger.frequencyCap);if(0===n.length)return!0;for(var i=0,o=this.storage.get(e);i<o.length;i++)for(var s=o[i],u=0,a=n;u<a.length;u++){if(a[u].matches(r,s))return!1}return!0},t.prototype.createMatchContexts=function(t){for(var e=[],r=0,n=t.identifierCaps;r<n.length;r++){var i=n[r];e.push(new BN(new zN(i)))}return t.durationCap&&e.push(new BN(new KN(t.durationCap))),e},t}(),BN=function(){function t(t){this.matchCount=0,this.predicate=t}return t.prototype.matches=function(t,e){return this.predicate.matches(t,e)&&(this.matchCount+=1),this.matchCount>=this.predicate.thresholdCount},t}(),zN=function(){function t(t){this.identifierCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.identifierCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,r){var n=t.user.identifiers[this.identifierCap.identifierType];if(e.isNullOrUndefined(n))return!1;var i=r.identifiers[this.identifierCap.identifierType];return!e.isNullOrUndefined(i)&&n===i},t}(),KN=function(){function t(t){this.durationCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.durationCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,e){return t.timestamp-e.timestamp<=this.durationCap.durationMillis},t}(),JN=function(){function t(t){this.storage=t}return t.prototype.get=function(t){var r=this.storage.getItem(t.id.toString());return e.isNullOrUndefined(r)?[]:JSON.parse(r)},t.prototype.set=function(t,e){this.storage.setItem(t.id.toString(),JSON.stringify(e))},t}(),YN=function(){function t(t){this.processors=t}return t.prototype.get=function(t){return this.processors.find((function(e){return e.supports(t)}))},t}(),qN=function(){function t(t){this.impressionStorage=t}return t.prototype.process=function(t,e,r){this.saveImpression(t.context.inAppMessage,t.context.user,r)},t.prototype.saveImpression=function(e,r,n){var i=this.impressionStorage.get(e),o={identifiers:r.identifiers,timestamp:n};i.push(o),i.length>t.IMPRESSION_MAX_SIZE&&i.splice(0,i.length-t.IMPRESSION_MAX_SIZE),this.impressionStorage.set(e,i)},t.prototype.supports=function(t){return"IMPRESSION"===t.type},t.IMPRESSION_MAX_SIZE=100,t}(),XN=function(){function t(){}return t.prototype.process=function(t,e,r){},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),WN=function(){function t(t){this.actionHandlerFactory=t}return t.prototype.process=function(t,e,r){var n=this.actionHandlerFactory.get(e.action);n&&n.handle(t,e.action)},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),$N=function(){function t(t,e,r){this.clock=t,this.eventTracker=e,this.eventProcessorFactory=r}return t.prototype.handle=function(t,e){var r=this.clock.currentMillis();this.eventTracker.track(t.context,e,r);var n=this.eventProcessorFactory.get(e);n&&n.process(t,e,r)},t}(),ZN=function(){function t(t,e){this.ruleDeterminer=t,this.frequencyCapDeterminer=e}return t.prototype.matches=function(t,e,r){return!!aA.isTrackEvent(r)&&(!!this.ruleDeterminer.isTriggerTarget(t,e,r)&&this.frequencyCapDeterminer.isTriggerTarget(t,e,r))},t}(),QN=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find((function(e){return e.supports(t)}))},t}(),tO=function(){function t(){}return t.prototype.handle=function(t,e){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),eO=function(){function t(t){this.eventHandler=t}return t.prototype.handle=function(t,e){var r=Bt.fromJson(e.action);if(r){var n={type:"ACTION",action:r,area:e.area,text:e.text};this.eventHandler.handle(t,n)}},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),rO=function(){function t(){}return t.prototype.open=function(t){window.location.href=t.href},t}(),nO=function(){function t(){}return t.prototype.open=function(t){window.open(t.href,"Hackle","resizable:true")},t}(),iO=function(){function t(){}return t.prototype.open=function(t){window.open(t.href)},t}(),oO=function(){function t(){}return t.prototype.open=function(t){window.location.replace(t)},t}(),sO={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,gclid:void 0,fbclid:void 0},uO={current:void 0,referrer:void 0},aO=function(t,e){return Object.keys(sO).every((function(r){return t[r]===e[r]}))},cO=function(t,e,r){return null===t||(!aO(e,sO)||r.current!==r.referrer)&&!aO(t,e)},fO=function(){function t(t,e,r,n){this.storage=t,this.parser=e,this.core=r,this.userManager=n}return t.prototype.startNewCampaign=function(t,e,r){for(var n=a(a({},sO),e),i=new gr,o=0,s=Object.entries(n);o<s.length;o++){var u=s[o],c=u[0],f=u[1];f?i.set(c,f):i.unset(c)}var p=i.build(),l=p.toEvent(),h=this.userManager.toHackleUser(t);this.core.track(l,h,r),this.userManager.updateUserProperties(p)},t.prototype.startNewCampaignIfNeeded=function(t,e){var r=this.storage.get(),n=this.parser.parse(),i=this.parser.parseDomain();cO(r,n,i)&&(this.storage.set(n),this.startNewCampaign(t,n,e))},t.prototype.onSessionEnded=function(t,e,r){},t.prototype.onSessionStarted=function(t,e,r){this.startNewCampaignIfNeeded(e,r)},t}(),pO=function(){function t(t){this.storage=t}return t.prototype.get=function(){var t=this.storage.getItem(oe);return t?JSON.parse(t):null},t.prototype.set=function(t){this.storage.setItem(oe,JSON.stringify(t))},t}(),lO=function(){function t(t){this.search=t}return t.prototype.getQueryParam=function(t){return this.getQueryParams((function(){return!0}))[t]||""},t.prototype.getQueryParams=function(t){for(var e={},r=0,n=this.search.substring(1).split("&");r<n.length;r++){var i=n[r].split("="),o=i[0],s=i[1];if(!t||t(o,s)){var u=br.tryDecodeURIComponent(s);u&&(e[o]=u)}}return e},t.getQueryParams=function(e){return"undefined"==typeof window?{}:new t(window.location.search).getQueryParams(e)},t}(),hO=function(){function t(){}return t.extractDomain=function(t){var e=this.DOMAIN_MATCH_REGEX,r=t.split("."),n=r[r.length-1];(n.length>4||"com"===n||"org"===n)&&(e=this.SIMPLE_DOMAIN_MATCH_REGEX);var i=t.match(e);return i?i[0]:t},t.DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,t.SIMPLE_DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i,t}(),dO=function(){function t(){}return t.prototype.parse=function(t){var e=this.params(t);return this.resolve(e)},t.prototype.params=function(r){return e.isNullOrUndefined(r)?lO.getQueryParams(t.CAMPAIGN_QUERY_CONDITION):new lO(r).getQueryParams(t.CAMPAIGN_QUERY_CONDITION)},t.prototype.resolve=function(t){return{utm_campaign:t[vO],utm_content:t[yO],utm_id:t[gO],utm_medium:t[mO],utm_source:t[EO],utm_term:t[wO],gclid:t[TO],fbclid:t[IO]}},t.prototype.parseDomain=function(){if("undefined"==typeof window)return uO;return{current:hO.extractDomain(window.document.location.hostname),referrer:function(){var t=window.document.referrer;if(t){var e=new URL(t).hostname;return hO.extractDomain(e)}}()}},t.CAMPAIGN_QUERY_CONDITION=function(t,e){return Je.isNotEmptyString(e)},t}(),vO="utm_campaign",yO="utm_content",gO="utm_id",mO="utm_medium",EO="utm_source",wO="utm_term",TO="gclid",IO="fbclid",_O=function(){function t(t,e){var r=this;this.userEventEmitter=t,this.determiner=e,this.onEvent=function(t){var e=r.determiner.determineTargetExposureOrNull(t);e&&r.send(e)},this.initialize()}return t.prototype.initialize=function(){this.userEventEmitter.on("event",this.onEvent)},t.prototype.send=function(t){var e=t.experiment.key,r=t.variationKey,n="HACKLE-EXPERIMENT_".concat(e,"_V").concat(t.experiment.version,"-").concat(r);try{window.gtag("event","experience_impression",{exp_variant_string:n})}catch(t){i.log.error("Unexpected exception while sending an event to Google Analytics with gtag: ".concat(t))}},t}(),AO=function(){function t(t){this.workspaceFetcher=t}return t.prototype.determineTargetExposureOrNull=function(t){var e=this.workspaceFetcher.get();return e&&e.getAttributes().integration_ga_experiment&&aA.isExposureEvent(t)?"RUNNING"!==t.experiment.status||t.decisionReason!==S.TRAFFIC_ALLOCATED?null:t:null},t}(),bO={user:void 0,debug:!1,log_disabled:!1,auto_track_page_view:!0,pollingIntervalMillis:ee,exposureEventDedupIntervalMillis:re,sessionTimeoutMillis:18e5,autoOpenDevTool:!1,sdkUrl:"https://client-sdk.hackle.io",eventUrl:"https://event.hackle.io",monitoringUrl:"https://monitoring.hackle.io",cdnUrl:"https://static.hackle.io",sameSiteCookie:"LAX",secureCookie:!1,SDK_NAME_HEADER:"javascript-sdk_browser",SDK_VERSION_HEADER:"11.32.1",IAM_RENDERER_VERSION_HEADER:"0.0.6"},NO=function(){function t(){}return t.config=function(t){return a(a({},bO),t)},t.logging=function(t){i.initCounter((function(t){return Ke.counter("log",{level:t})})),i.setLogLevel(n.INFO),t.log_disabled?i.setLogLevel(n.DISABLE):t.debug&&i.setLogLevel(n.DEBUG)},t.sdk=function(t,e){return i.log.debug("SDK key: ".concat(t)),t||i.log.error("invalid sdk key: '".concat(t,"' (expected: not null, not undefined and not empty string)")),{key:t,name:e.SDK_NAME_HEADER,version:e.SDK_VERSION_HEADER}},t.isBeaconSupported=function(){var t=!1;return"undefined"!=typeof window&&(t=window&&window.navigator&&!!window.navigator.sendBeacon&&!0)&&i.log.debug("support sendBeacon API"),t},t.pollingIntervalMillis=function(t){return void 0===t.pollingIntervalMillis||"number"!=typeof t.pollingIntervalMillis||t.pollingIntervalMillis<=0?ee:Math.max(t.pollingIntervalMillis,3e4)},t.dedupIntervalMillis=function(t){return void 0===t.exposureEventDedupIntervalMillis||"number"!=typeof t.exposureEventDedupIntervalMillis?re:t.exposureEventDedupIntervalMillis<1e3||t.exposureEventDedupIntervalMillis>36e5?(i.log.warn("Exposure event dedup interval is outside allowed range[1_000ms..3_600_000ms]. Setting to default value[1m]."),re):t.exposureEventDedupIntervalMillis},t}(),OO=function(){function t(){this.synchronizations=[]}return t.prototype.add=function(t,e){this.synchronizations.push({type:t,synchronizer:e})},t.prototype.sync=function(){return c(this,void 0,void 0,(function(){var t=this;return f(this,(function(e){switch(e.label){case 0:return[4,Promise.all(this.synchronizations.map((function(e){return t.safe(e.synchronizer.sync())})))];case 1:return e.sent(),[2]}}))}))},t.prototype.syncOnly=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:if(!(e=this.synchronizations.find((function(e){return e.type===t}))))throw new Error("Unsupported SynchronizerType [".concat(t,"]"));return[4,e.synchronizer.sync()];case 1:return r.sent(),[2]}}))}))},t.prototype.close=function(){return c(this,void 0,void 0,(function(){var t=this;return f(this,(function(e){switch(e.label){case 0:return[4,Promise.all(this.synchronizations.map((function(e){return t.safe(e.synchronizer.close())})))];case 1:return e.sent(),[2]}}))}))},t.prototype.safe=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return r.sent(),[3,3];case 2:return e=r.sent(),i.log.error("Failed to sync: ".concat(e)),[3,3];case 3:return[2]}}))}))},t}(),RO=function(){function t(t,e,r){this.delegate=t,this.scheduler=e,this.intervalMillis=r,this.pollingJob=null}return t.prototype.sync=function(){return c(this,void 0,void 0,(function(){var t;return f(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.delegate.sync()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),i.log.error("Failed to sync: ".concat(t)),[3,3];case 3:return[2]}}))}))},t.prototype.syncOnly=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.delegate.syncOnly(t)];case 1:return r.sent(),[3,3];case 2:return e=r.sent(),i.log.error("Failed to sync: ".concat(e)),[3,3];case 3:return[2]}}))}))},t.prototype.start=function(){var t=this;this.intervalMillis!==ee&&null===this.pollingJob&&(this.pollingJob=this.scheduler.schedulePeriodically(this.intervalMillis,this.intervalMillis,(function(){return t.sync()})))},t.prototype.stop=function(){var t;this.intervalMillis!==ee&&(null===(t=this.pollingJob)||void 0===t||t.cancel(),this.pollingJob=null)},t.prototype.close=function(){return c(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return this.stop(),[4,this.delegate.close()];case 1:return t.sent(),[2]}}))}))},t}(),MO=function(){function t(){}return t.prototype.schedule=function(t,e){var r=new SO(t,e);return r.start(),r},t.prototype.schedulePeriodically=function(t,e,r){var n=new CO(t,e,r);return n.start(),n},t}(),SO=function(){function t(t,e){this.delayMillis=t,this.task=e,this.timeout=null}return t.prototype.start=function(){var t=this;this.timeout=setTimeout((function(){return t.task()}),this.delayMillis)},t.prototype.cancel=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t}(),CO=function(){function t(t,e,r){this.delayMillis=t,this.intervalMillis=e,this.task=r,this.timeout=null}return t.prototype.start=function(){var t=this;this.timeout=setTimeout((function(){return t.run()}),this.delayMillis)},t.prototype.run=function(){var t=this;this.task(),this.timeout=setTimeout((function(){return t.run()}),this.intervalMillis)},t.prototype.cancel=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t}(),xO=function(){function t(t,e){this.url=t,this.transport=e}return t.prototype.fetchIfModified=function(t){return c(this,void 0,void 0,(function(){var e,r;return f(this,(function(n){switch(n.label){case 0:return e=this.createRequest(t),[4,this.execute(e)];case 1:return r=n.sent(),[2,this.handleResponse(r)]}}))}))},t.prototype.createRequest=function(t){var e=Ye.builder().url(this.url).method("GET");return null!==t&&e.addHeader(We.IF_MODIFIED_SINCE,t),e.build()},t.prototype.execute=function(t){return c(this,void 0,void 0,(function(){var e,r,n;return f(this,(function(i){switch(i.label){case 0:e=ae.start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.transport.send(t)];case 2:return r=i.sent(),tr.record("get.workspace",e,r),[2,r];case 3:throw n=i.sent(),tr.record("get.workspace",e,null),n;case 4:return[2]}}))}))},t.prototype.handleResponse=function(t){if(t.isNotModified())return null;if(!t.isSuccessful())throw new Error("Http status code: ".concat(t.statusCode));if(null===t.body)throw new Error("Response body is empty");return{config:JSON.parse(t.body),lastModified:t.headers.get(We.LAST_MODIFIED)}},t}();const UO="function"==typeof btoa,PO="function"==typeof Buffer,kO=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),DO=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),LO=((t=>{let e={};t.forEach(((t,r)=>e[t]=r))})(DO),String.fromCharCode.bind(String)),FO=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_"))),VO=t=>{let e,r,n,i,o="";const s=t.length%3;for(let s=0;s<t.length;){if((r=t.charCodeAt(s++))>255||(n=t.charCodeAt(s++))>255||(i=t.charCodeAt(s++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|i,o+=DO[e>>18&63]+DO[e>>12&63]+DO[e>>6&63]+DO[63&e]}return s?o.slice(0,s-3)+"===".substring(s):o},GO=UO?t=>btoa(t):PO?t=>Buffer.from(t,"binary").toString("base64"):VO,jO=PO?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let r=0,n=t.length;r<n;r+=4096)e.push(LO.apply(null,t.subarray(r,r+4096)));return GO(e.join(""))},HO=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?LO(192|e>>>6)+LO(128|63&e):LO(224|e>>>12&15)+LO(128|e>>>6&63)+LO(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return LO(240|e>>>18&7)+LO(128|e>>>12&63)+LO(128|e>>>6&63)+LO(128|63&e)},BO=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,zO=t=>t.replace(BO,HO),KO=PO?t=>Buffer.from(t,"utf8").toString("base64"):kO?t=>jO(kO.encode(t)):t=>GO(zO(t)),JO=(t,e=!1)=>e?FO(KO(t)):KO(t),YO=t=>JO(t,!0),qO=YO;var XO=function(){function t(t,e){this.url=t,this.transport=e}return t.prototype.fetch=function(t){return c(this,void 0,void 0,(function(){var e,r;return f(this,(function(n){switch(n.label){case 0:return e=this.createRequest(t),[4,this.execute(e)];case 1:return r=n.sent(),[2,this.handleResponse(r)]}}))}))},t.prototype.createRequest=function(t){var e={identifiers:F(t)},r=qO(JSON.stringify(e));return Ye.builder().url(this.url).method("GET").addHeader("X-HACKLE-USER",r).build()},t.prototype.execute=function(t){return c(this,void 0,void 0,(function(){var e,r,n;return f(this,(function(i){switch(i.label){case 0:e=ae.start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.transport.send(t)];case 2:return r=i.sent(),tr.record("get.cohorts",e,r),[2,r];case 3:throw n=i.sent(),tr.record("get.cohorts",e,null),n;case 4:return[2]}}))}))},t.prototype.handleResponse=function(t){if(!t.isSuccessful())throw new Error("Http status code: ".concat(t.statusCode));if(null===t.body)throw new Error("Response body is null");var e=JSON.parse(t.body);return $b.fromDto(e)},t}(),WO=function(){function t(t,e,n,i,o,s,u,a,c,f,p){this.experiments=r.associateBy(t,(function(t){return t.key})),this.splitUrlExperiments=r.associateBy(e,(function(t){return t.key})),this.featureFlags=r.associateBy(n,(function(t){return t.key})),this.buckets=r.associateBy(i,(function(t){return t.id})),this.eventTypes=r.associateBy(o,(function(t){return t.key})),this.segments=r.associateBy(s,(function(t){return t.key})),this.containers=r.associateBy(u,(function(t){return t.id})),this.parameterConfigurations=r.associateBy(a,(function(t){return t.id})),this.remoteConfigParameters=r.associateBy(c,(function(t){return t.key})),this.inAppMessages=r.associateBy(f,(function(t){return t.key})),this.attributes=p}return t.prototype.getExperiments=function(){return Array.from(this.experiments.values())},t.prototype.getSplitUrlExperiments=function(){return Array.from(this.splitUrlExperiments.values())},t.prototype.getFeatureFlags=function(){return Array.from(this.featureFlags.values())},t.prototype.getInAppMessages=function(){return Array.from(this.inAppMessages.values())},t.prototype.getExperimentOrNull=function(t){return this.experiments.get(t)},t.prototype.getFeatureFlagOrNull=function(t){return this.featureFlags.get(t)},t.prototype.getBucketOrNull=function(t){return this.buckets.get(t)},t.prototype.getEventTypeOrNull=function(t){return this.eventTypes.get(t)},t.prototype.getSegmentOrNull=function(t){return this.segments.get(t)},t.prototype.getContainerOrNull=function(t){return this.containers.get(t)},t.prototype.getParameterConfigurationOrNull=function(t){return this.parameterConfigurations.get(t)},t.prototype.getRemoteConfigParameterOrNull=function(t){return this.remoteConfigParameters.get(t)},t.prototype.getInAppMessageOrNull=function(t){return this.inAppMessages.get(t)},t.prototype.getAttributes=function(){return this.attributes},t.from=function(e){return new t(r.mapNotNullOrUndefined(e.experiments,(function(t){return x.fromJson("AB_TEST",t)})),r.mapNotNullOrUndefined(e.experiments,(function(t){return x.fromJson("AB_TEST",t)})).filter((function(t){return"SPLIT_URL"===t.implementationType})),r.mapNotNullOrUndefined(e.featureFlags,(function(t){return x.fromJson("FEATURE_FLAG",t)})),e.buckets.map(P.fromJson),e.events.map(D.fromJson),r.mapNotNullOrUndefined(e.segments,Y.fromJson),e.containers.map(q.fromJson),e.parameterConfigurations.map(M.fromJson),r.mapNotNullOrUndefined(e.remoteConfigParameters,W.fromJson),r.mapNotNullOrUndefined(e.inAppMessages,wt.fromJson),e.workspace.attributes)},t}(),$O=function(){function t(t,e){this.workspaceConfigStorage=t,this.workspaceFetcher=e,this.workspace=null,this.lastModified=null;var r=this.workspaceConfigStorage.get();r&&this.setConfig(r)}return t.prototype.setConfig=function(t){this.setWorkspace(t),this.lastModified=t.lastModified},t.prototype.setWorkspace=function(t){try{this.workspace=WO.from(t.config)}catch(t){i.log.error("Failed to set workspace: ".concat(t))}},t.prototype.get=function(){return this.workspace},t.prototype.sync=function(){return c(this,void 0,void 0,(function(){var t,e;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.workspaceFetcher.fetchIfModified(this.lastModified)];case 1:return(t=r.sent())&&(this.setConfig(t),this.workspaceConfigStorage.set(t)),[3,3];case 2:return e=r.sent(),i.log.error("Failed to sync workspace: ".concat(e)),[3,3];case 3:return[2]}}))}))},t.prototype.close=function(){return c(this,void 0,void 0,(function(){return f(this,(function(t){return[2]}))}))},t}(),ZO=function(){function t(t,e,r){this.transport=t,this.synchronousTransport=e,this.retryManager=r}return t.prototype.dispatch=function(t,e){var r=t.map((function(t){return t.toDto()}));return e?this.dispatchEventsSynchronously(r):this.dispatchEvents(r)},t.prototype.dispatchEventsSynchronously=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:return[4,this.retryManager.add(t)];case 1:return r.sent(),[4,this.synchronousTransport.send(t)];case 2:return(e=r.sent()).isSuccessful()||e.isClientError()?[4,this.retryManager.delete(t)]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype.dispatchEvents=function(t){return c(this,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:return[4,this.transport.send(t)];case 1:return(e=r.sent()).isSuccessful()||e.isClientError()?[2]:[4,this.retryManager.add(t)];case 2:return r.sent(),[2]}}))}))},t}();var QO=function(){function t(t,e){this.url=t,this.transport=e}return t.prototype.send=function(t){var e=this.createRequest(t);return this.execute(e)},t.prototype.createRequest=function(t){var e=function(t){var e=new Array,r=new Array,n=new Array;return t.forEach((function(t){t instanceof aA?aA.isExposureEvent(t)?e.push(t.toDto()):aA.isTrackEvent(t)?r.push(t.toDto()):aA.isRemoteConfigEvent(t)&&n.push(t.toDto()):aA.isExposureEventDto(t)?e.push(t):aA.isTrackEventDto(t)?r.push(t):aA.isRemoteConfigEventDto(t)&&n.push(t)})),{exposureEvents:e,trackEvents:r,remoteConfigEvents:n}}(t);return Ye.builder().url(this.url).method("POST").addHeader("Content-Type","application/json").body(JSON.stringify(e)).build()},t.prototype.execute=function(t){return c(this,void 0,void 0,(function(){var e,r,n;return f(this,(function(i){switch(i.label){case 0:e=ae.start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.transport.send(t)];case 2:return r=i.sent(),tr.record("post.events",e,r),[2,r];case 3:throw n=i.sent(),tr.record("post.events",e,null),n;case 4:return[2]}}))}))},t}(),tR=function(){function t(t,e){this.repository=t,this.transport=e}return t.prototype.add=function(t){return this.repository.add(t)},t.prototype.delete=function(t){return this.repository.delete(t)},t.prototype.flush=function(){return c(this,void 0,void 0,(function(){var t,e;return f(this,(function(r){switch(r.label){case 0:return[4,this.repository.read()];case 1:return 0===(t=r.sent()).length?[2]:[4,this.transport.send(t)];case 2:return(e=r.sent()).isSuccessful()||e.isClientError()?[4,this.delete(t)]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype.onVisibilityChanged=function(t,e){switch(t){case"visible":return void this.flush().catch((function(t){return i.log.warn("Failed to flush retry events: ".concat(t))}));case"hidden":return}},t}(),eR=function(){function t(){this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]=(this.listeners[t]||[]).concat(e)},t.prototype.off=function(t,e){this.listeners[t]=(this.listeners[t]||[]).filter((function(t){return t!==e}))},t.prototype.emit=function(t,e){(this.listeners[t]||[]).forEach((function(t){t(e)}))},t}(),rR=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(eR),nR=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.eventDispatcher=e,s.eventDispatchMaxSize=r,s.flushScheduler=n,s.flushIntervalMillis=i,s.autoTrackPageView=o,s.queue=[],s.flushingJob=null,s}return u(e,t),e.prototype.process=function(t){this.isEnqueueTarget(t)&&this.enqueue(t),this.emit("event",t)},e.prototype.enqueue=function(t){0===this.queue.length&&this.scheduleFlush(),this.queue.push(t),this.queue.length>=this.eventDispatchMaxSize&&this.flush()},e.prototype.scheduleFlush=function(){var t,e=this;null===(t=this.flushingJob)||void 0===t||t.cancel(),this.flushingJob=this.flushScheduler.schedule(this.flushIntervalMillis,(function(){return e.flush()}))},e.prototype.isPageViewEvent=function(t){return aA.isTrackEvent(t)&&"$page_view"===t.event.key},e.prototype.isEnqueueTarget=function(t){return!(this.isPageViewEvent(t)&&!this.autoTrackPageView)},e.prototype.flush=function(t){var e;void 0===t&&(t=!1),null===(e=this.flushingJob)||void 0===e||e.cancel(),0!==this.queue.length&&(this.eventDispatcher.dispatch(this.queue,t).catch((function(t){return i.log.warn("Failed to dispatch events: ".concat(t))})),this.queue=[])},e.prototype.close=function(){this.flush(!0)},e}(rR),iR=function(){function t(t,e,r){this.sdk=t,this.clock=e,this.delegate=r}return t.prototype.send=function(t){var e=t.toBuilder().addHeader(Yt,this.sdk.key).addHeader(qt,this.sdk.name).addHeader(Xt,this.sdk.version).addHeader(Wt,this.clock.currentMillis().toString()).build();return this.delegate.send(e)},t}(),oR=function(){function t(){}return t.intercept=function(t,e){return e instanceof iR?e:new iR(t,m.instance,e)},t}(),sR=function(){function t(){}return t.create=function(){return new t},t.prototype.send=function(t){return new Promise((function(e,r){var n=new XMLHttpRequest;t.options.timeoutMillis&&(n.timeout=t.options.timeoutMillis),n.open(t.method,t.url),n.onreadystatechange=function(){if(n.readyState===n.DONE)if(0!==n.status){var t=function(t){return new Xe(t.status,t.responseText,function(t){var e=We.builder(),r=t.getAllResponseHeaders();if(!r)return e.build();for(var n=0,i=r.split("\r\n");n<i.length;n++){var o=i[n],s=o.indexOf(": ");if(s>0){var u=o.slice(0,s),a=o.slice(s+2);e.add(u,a)}}return e.build()}(t))}(n);e(t)}else r(new Error("Request Error"))},function(t,e){var r=e.headers.raw();for(var n in r)r.hasOwnProperty(n)&&t.setRequestHeader(n,r[n])}(n,t),n.send(t.body)}))},t}();var uR,aR=function(){function t(){}return t.create=function(){return new t},t.prototype.send=function(t){var e=this;return new Promise((function(r,n){var i=!1;if("undefined"!=typeof window&&(i=window&&window.navigator&&!!window.navigator.sendBeacon&&!0),!i)throw new Error("BeaconTransport not supported.");var o=e.createBody(t);if(!window.navigator.sendBeacon(t.url,o))throw Error("Failed to sendBeacon");r(Xe.ok())}))},t.prototype.createBody=function(t){var e=new URLSearchParams,r=t.headers.get(Yt);r&&e.append("sdkKey",r),e.append("sdkName",t.headers.getOrDefault(qt,"unknown")),e.append("sdkVersion",t.headers.getOrDefault(Xt,"unknown"));var n=t.headers.get(Wt);return n&&e.append("sdkTime",n),t.body&&e.append("data",t.body),e},t}(),cR=function(){function t(t){this.invocationResponseResolver=t}return t.prototype.invoke=function(t){var e=window.prompt(JSON.stringify(t));return this.invocationResponseResolver.resolve(e)},t}(),fR=function(){function t(t){this.invocationResponseResolver=t}return t.prototype.invoke=function(t){var e;if(!(null===(e=window._hackleApp)||void 0===e?void 0:e.invoke))throw new Error("window._hackleApp.invoke is not implemented");var r=window._hackleApp.invoke(JSON.stringify(t));return this.invocationResponseResolver.resolve(r)},t}();!function(t){t.prompt="prompt",t.function="function"}(uR||(uR={}));var pR=function(){function t(){}return t.prototype.getInvocator=function(t,e){return t===uR.prompt?new cR(e):t===uR.function?new fR(e):null},t}(),lR=function(){function t(t,e,r,n){var i=this;this.userEventEmitter=t,this.determiner=e,this.redirector=r,this.core=n,this.onEvent=function(t){var e=i.determiner.determineOrNull(t);e&&(i.core.flush(!0),i.redirector.redirect(e))},this.initialize()}return t.prototype.initialize=function(){this.userEventEmitter.on("event",this.onEvent)},t.prototype.destroy=function(){this.userEventEmitter.off("event",this.onEvent)},t}(),hR=function(t,e,r,n){this.workspace=t,this.experiment=e,this.decision=r,this.event=n},dR=function(){function t(t,e,r,n){this.workspaceFetcher=t,this.splitUrlMatcher=e,this.splitUrlRedirectedCookieStorage=r,this.core=n}return t.prototype.determineOrNull=function(t){if(!aA.isTrackEvent(t))return null;if("$page_view"!==t.event.key)return null;if(this.splitUrlRedirectedCookieStorage.alreadyRedirected())return this.splitUrlRedirectedCookieStorage.clear(),null;var e=this.workspaceFetcher.get();if(!e)return null;for(var r=0,n=e.getSplitUrlExperiments();r<n.length;r++){var i=n[r];if(this.splitUrlMatcher.matches(e,i,t)){var o=this.core.experiment(i.key,t.user,"A");return new hR(e,i,o,t)}}return null},t}(),vR=function(){function t(t){this.targetMatcher=t}return t.prototype.matches=function(t,e,r){if("SPLIT_URL"!==e.implementationType)return!1;if(!e.splitUrlTargets)return!1;var n=e.splitUrlTargets,i=yR.of(t,r);return!(n.excludeTargets.length>0&&this.targetMatcher.anyMatches(i,TA.create(),n.excludeTargets))&&(n.includeTargets.length>0&&this.targetMatcher.anyMatches(i,TA.create(),n.includeTargets))},t}(),yR=function(){function t(t,e,r){this.key=t,this.user=e,this.workspace=r}return t.of=function(e,r){return new t(new wA("SPLIT_URL",r.insertId),r.user,e)},t}(),gR=function(){function t(t,e,r,n){this.urlResolver=t,this.urlHandler=e,this.splitUrlRedirectedCookieStorage=r,this.initializeEventDispatcher=n}return t.prototype.redirect=function(t){var e=this.urlResolver.resolveOrNull(t);e&&(this.initializeEventDispatcher.setNeedDispatch(!1),this.splitUrlRedirectedCookieStorage.setRedirected(!0),this.urlHandler.open(e))},t}(),mR=function(){function e(t){this.campaignParser=t}return e.prototype.resolveOrNull=function(t){try{var r=JSON.parse(t.decision.get(e.SPLIT_URL_CONFIG_KEY,"")),n=Kt.fromDto(r);return n.needRedirect?this.resolveByRedirectType(n.redirectType,n.redirectUrl,t):null}catch(t){return null}},e.prototype.resolveByRedirectType=function(e,r,n){return r&&e===t.SplitUrlRedirectType.MANUAL?this.resolveManualRedirectUrl(r,n):null},e.prototype.resolveManualRedirectUrl=function(t,e){var r=br.tryParse(t);return r?this.decorateCampaign(r,e):null},e.prototype.decorateCampaign=function(t,e){var r=e.event.user.hackleProperties.queryParameter;return Je.isNotEmptyString(r)?function(t,e){for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];Je.isNotEmptyString(s)&&e.searchParams.set(o,s)}return e}(this.campaignParser.parse(r),t):t},e.SPLIT_URL_CONFIG_KEY="redirectUrl",e}(),ER=function(){function t(t,e,r){this.storage=t,this.cookieKey=e,this.cookieStorageOptions=r}return t.prototype.alreadyRedirected=function(){try{var t=this.storage.getItem(this.cookieKey);return!e.isNullOrUndefined(t)&&Boolean(JSON.parse(t))}catch(t){return!1}},t.prototype.clear=function(){this.storage.removeItem(this.cookieKey)},t.prototype.setRedirected=function(t){this.storage.setItem(this.cookieKey,String(t),this.cookieStorageOptions)},t}(),wR=function(){function t(){this.needDispatch=!0}return t.prototype.setNeedDispatch=function(t){this.needDispatch=t},t.prototype.dispatchDoneEventIfNeeded=function(){this.needDispatch&&window.dispatchEvent(new CustomEvent(t.HACKLE_INITIALIZE_DONE_EVENT_TYPE))},t.HACKLE_INITIALIZE_DONE_EVENT_TYPE="hackle-initialize-done",t}(),TR=function(){function t(t,e){this.sdk=t,this.storage=e}return t.prototype.get=function(){var t=this.storage.getItem(se);if(e.isNullOrUndefined(t))return null;try{var r=JSON.parse(t);return this.sdk.version!==r.version?(this.clear(),null):r}catch(t){return this.clear(),null}},t.prototype.set=function(t){var e=a(a({},t),{version:this.sdk.version});this.storage.setItem(se,JSON.stringify(e))},t.prototype.clear=function(){this.storage.removeItem(se)},t}(),IR=function(){function t(t){void 0===t&&(t=m.instance),this.clock=t,this.listeners=[]}return t.prototype.addListener=function(t){this.listeners.push(t)},t.prototype.changeVisibility=function(t){var e=this.clock.currentMillis();this.listeners.forEach((function(r){r.onVisibilityChanged(t,e)}))},t}(),_R=function(){function t(t){this.limiter=t}return t.create=function(e,r,n){return void 0===n&&(n=m.instance),new t(new AR(n,e,r))},t.prototype.execute=function(t,e){return this.limiter.tryAcquire()?t():e()},t}(),AR=function(){function t(t,e,r){this.clock=t,this.intervalMillis=e,this.limit=r,this.currentScope=null}return t.prototype.tryAcquire=function(){var t=this.clock.currentMillis();return this.refreshScopeIfNeeded(t).tryAcquire()},t.prototype.refreshScopeIfNeeded=function(t){return(null==this.currentScope||this.currentScope.isExpired(t))&&(this.currentScope=new bR(t+this.intervalMillis,this.limit)),this.currentScope},t}(),bR=function(){function t(t,e){this.expirationTime=t,this.token=e}return t.prototype.isExpired=function(t){return this.expirationTime<t},t.prototype.tryAcquire=function(){return this.token>0&&(this.token-=1,!0)},t}(),NR=function(){function t(t){this.determiners=t}return t.prototype.isDedupTarget=function(t){var e=this.determiners.find((function(e){return e.supports(t)}));return!!e&&e.isDedupTarget(t)},t}(),OR=function(){function t(t,e){this.dedupIntervalMillis=t,this.clock=e,this.cache={},this.currentUser=null}return t.prototype.isDedupTarget=function(t){var e;if(-1===this.dedupIntervalMillis)return!1;h.isEquals(t.user.identifiers,null===(e=this.currentUser)||void 0===e?void 0:e.identifiers)||(this.currentUser=t.user,this.cache={});var r=this.cacheKey(t),n=this.clock.currentMillis(),i=this.cache[r];return void 0!==i&&n-i<=this.dedupIntervalMillis||(this.cache[r]=n,!1)},t}(),RR=function(t){function e(e,r){return void 0===r&&(r=m.instance),t.call(this,e,r)||this}return u(e,t),e.prototype.supports=function(t){return aA.isRemoteConfigEvent(t)},e.prototype.cacheKey=function(t){return[t.parameter.id,t.valueId,t.decisionReason].join("-")},e}(OR),MR=function(t){function e(e,r){return void 0===r&&(r=m.instance),t.call(this,e,r)||this}return u(e,t),e.prototype.supports=function(t){return aA.isExposureEvent(t)},e.prototype.cacheKey=function(t){return[t.experiment.id,t.variationId,t.variationKey,t.decisionReason].join("-")},e}(OR),SR=i.log,CR=null;function xR(t,e){var r,n,i,o,s,u,a=NO.config(e);NO.logging(a);try{if((u=window)&&"_hackleApp"in u&&null!==u._hackleApp&&"object"==typeof u._hackleApp&&"getAppSdkKey"in u._hackleApp&&"function"==typeof u._hackleApp.getAppSdkKey&&"getInvocationType"in u._hackleApp&&"function"==typeof u._hackleApp.getInvocationType&&t===window._hackleApp.getAppSdkKey()){var c=(i=window._hackleApp.getInvocationType(),o=new pR,null===(s=o.getInvocator(i,new Ar))?(Ur.error("Failed to get invocator with invocationType:".concat(i)),null):new Pr(new xr(s)));if(c)return c}}catch(t){SR.error("Unexpected exception while check WebApp client: ".concat(t))}var f=NO.sdk(t,a);if(CR)return SR.debug("use already exists hackleClient"),CR;var p=new Or;p.initialize();var l=new gN,h=Nr.getInstance({days:3650,isCrossSubdomain:!0,sameSite:a.sameSiteCookie,isSecure:a.secureCookie}),d=NO.isBeaconSupported(),v=oR.intercept(f,sR.create()),y=oR.intercept(f,aR.create()),g=v;d&&(g=y);var E=new OO,w=new RO(E,new MO,NO.pollingIntervalMillis(a)),T=new TR(f,mN.postfix(l,"_".concat(t.slice(0,8)))),I=new xO(TN.clientFetch(a.sdkUrl,f.key),v),_=new $O(T,I);E.add("workspace",_);var A=new XO(TN.userCohorts(a.sdkUrl),v),b=new dO,N=new hN(mN.postfix(h,"_".concat(t))),O=N.getUser(),R=a.user||null,M=new lN(Rr(),N,A,b,m.instance,O,R);E.add("cohort",M);var S=new yN(a.sessionTimeoutMillis,mN.postfix(h,"_".concat(t.slice(8))));M.addListener(S);var C=new Xb(l,"".concat("hackle-repository-storage","_").concat(t),100),x=new QO(TN.clientDispatch(a.eventUrl),v),U=x;d&&(U=new QO(TN.beaconDispatch(a.eventUrl,f.key),y));var P=new tR(C,x),k=new ZO(x,U,P),D=new NR([new RR(NO.dedupIntervalMillis(a)),new MR(NO.dedupIntervalMillis(a))]),L=new nR(k,100,new MO,500,a.auto_track_page_view),F=new hA(L,D,S,M),V=new wR,G=new NA(new EN(h,"".concat("hackle-manual-override_ab","_").concat(t.slice(0,8)))),j=new NA(new EN(h,"".concat("hackle-manual-override_ff","_").concat(t.slice(0,8)))),H=new IN(mN.prefix(l,"".concat("hackle-iam-hide","_").concat(t.slice(0,8),"_"))),B=new JN(mN.prefix(l,"".concat("hackle-iam-impression","_").concat(t.slice(0,8),"_"))),z=Bb.create(_,F,[G,j],H),K=new fO(new pO(mN.postfix(h,"_".concat(t.slice(0,8)))),b,z,M),J=new lA(M,z);S.addListener(K),S.addListener(J);var Y=new xN(z),q=new _N([new AN,new bN(new rO),new NN(new rO),new ON(H,m.instance),new RN(new nO),new MN(new nO),new SN(new iO),new CN(new iO)]),X=new YN([new qN(B),new WN(q),new XN]),W=new $N(m.instance,Y,X),$=new QN([new tO,new eO(W)]),Z=new VN(TN.inAppMessageRenderer(a.cdnUrl,a.IAM_RENDERER_VERSION_HEADER)),Q=new UN(FN.create(Z),W,$),tt=new ZN(new GN(Lb.get("targetMatcher")),new HN(B)),et=new DN(_,tt,z);new PN(L,et,Q);var rt=new AO(_);new _O(L,rt);var nt=new vR(Lb.get("targetMatcher")),it=new ER(h,"hackle-split-url-redirected",{days:3472222222222222e-20}),ot=new dR(_,nt,it,z),st=new gR(new mR(b),new oO,it,V);new lR(L,ot,st,z);var ut=new wN(z,M,G,j),at=(null===(r=a.devTool)||void 0===r?void 0:r.userExplorer)&&"function"==typeof(null===(n=a.devTool)||void 0===n?void 0:n.userExplorer),ct=a.devTool&&at?{manager:a.devTool,userExplorer:ut}:void 0,ft=new Ze(TN.monitoring(a.monitoringUrl),v,g,new MO,6e4);Ke.addRegistry(ft),w.start();var pt=_R.create(6e4,1),lt=new Tr(z,w,S,M,pt,ct);CR=lt;var ht=new IR;ht.addListener(F),ht.addListener(P),ht.addListener(S),ht.addListener(ft),ht.addListener(p),window.addEventListener("pageshow",(function(){return ht.changeVisibility("visible")})),window.addEventListener("pagehide",(function(){return ht.changeVisibility("hidden")})),document.addEventListener("visibilitychange",(function(){return ht.changeVisibility(document.visibilityState)}));var dt,vt,yt;return a.autoOpenDevTool&&(a.devTool?lt.showUserExplorer():SR.error("DevTool is not provided")),dt=Date.now(),vt=M.currentUser,yt=S.currentSessionId,(Wb(O,vt)?S.startNewSessionIfNeeded(vt,dt):S.startNewSession(O,vt,dt))===yt&&K.startNewCampaignIfNeeded(vt,dt),ht.changeVisibility("visible"),lt.onReady((function(){(new Kb).install(z,M),function(t){function e(t){if("function"==typeof window.Event)return new Event(t);var e={bubbles:!1,cancelable:!1,detail:void 0},r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}try{history.pushState=function(t){return function(){try{var r=t.apply(this,arguments);return window.dispatchEvent(e("locationchange")),r}catch(t){if(t instanceof Error)SR.error(t);else try{SR.error(t)}catch(t){}}}}(history.pushState),history.replaceState=function(t){return function(){try{var r=t.apply(this,arguments);return window.dispatchEvent(e("locationchange")),r}catch(t){if(t instanceof Error)SR.error(t);else try{SR.error(t)}catch(t){}}}}(history.replaceState),window.addEventListener("popstate",(function(){try{window.dispatchEvent(e("locationchange"))}catch(t){if(t instanceof Error)SR.error(t);else try{SR.error(t)}catch(t){}}})),window.addEventListener("locationchange",(function(){try{t.trackPageView()}catch(t){if(t instanceof Error)SR.error(t);else try{SR.error(t)}catch(t){}}}))}catch(t){if(t instanceof Error)SR.error(t);else try{SR.error(t)}catch(t){}}}(lt),lt.trackPageView(),V.dispatchDoneEventIfNeeded()})),lt}var UR={createInstance:xR,getUserId:Rr,setUserId:Mr,removeUserId:Sr,Logger:i};t.Bucket=P,t.Cohort=zt,t.Container=q,t.ContainerGroup=X,t.CoreVersion=et,t.Decision=N,t.DecisionReason=S,t.EXPERIMENT_IMPLEMENTATION_TYPE=C,t.EmptyHackleRemoteConfig=R,t.EmptyParameterConfig=E,t.EventType=D,t.Experiment=x,t.FeatureFlagDecision=O,t.IAM_ACTION_AREA=["BUTTON","IMAGE","X_BUTTON"],t.IAM_ACTION_TYPE=gt,t.IAM_BEHAVIOR=yt,t.IAM_DISPLAY_TYPE=ht,t.IAM_HORIZONTAL_ALIGNMENT=Et,t.IAM_LAYOUT_TYPE=dt,t.IAM_ORIENTATION=vt,t.IAM_PLATFORM_TYPE=pt,t.IAM_STATUS=ft,t.IAM_TIMEUNIT=lt,t.IAM_VERTICAL_ALIGNMENT=mt,t.IdentifierType=L,t.IdentifiersBuilder=V,t.InAppMessage=wt,t.InAppMessageAction=Bt,t.InAppMessageAlignment=Pt,t.InAppMessageBackground=Ht,t.InAppMessageButton=Vt,t.InAppMessageButtonStyle=jt,t.InAppMessageContext=St,t.InAppMessageContextLayout=Ut,t.InAppMessageContextMessage=xt,t.InAppMessageDecision=b,t.InAppMessageDurationCap=Ot,t.InAppMessageEventFrequencyCap=bt,t.InAppMessageEventTrigger=_t,t.InAppMessageEventTriggerRule=At,t.InAppMessageExperimentContext=Ct,t.InAppMessageIdentifierCap=Nt,t.InAppMessageImage=kt,t.InAppMessagePeriodAlways=Tt,t.InAppMessagePeriodCustom=It,t.InAppMessagePositionalButton=Gt,t.InAppMessageTargetContext=Rt,t.InAppMessageText=Dt,t.InAppMessageTextAttribute=Lt,t.InAppMessageTextStyle=Ft,t.InAppMessageUserOverride=Mt,t.Logger=i,t.MATCH_OPERATORS=ot,t.MATCH_TYPES=nt,t.MATCH_VALUE_TYPES=it,t.MetaVersion=rt,t.ParameterConfiguration=M,t.PropertyOperations=mr,t.PropertyOperationsBuilder=gr,t.RemoteConfigDecision=A,t.RemoteConfigParameter=W,t.RemoteConfigParameterValue=Z,t.RemoteConfigTargetRule=$,t.SEGMENT_TYPES=at,t.Segment=Y,t.Slot=k,t.SplitUrlConfig=Kt,t.SplitUrlTargets=Jt,t.TARGET_ACTION_TYPES=st,t.TARGET_KEY_TYPES=ut,t.Target=j,t.TargetAction=K,t.TargetCondition=H,t.TargetKey=B,t.TargetMatch=z,t.TargetRule=J,t.TargetingType=ct,t.Variation=U,t.Version=tt,t.createInstance=xR,t.default=UR,t.getUserId=Rr,t.removeUserId=Sr,t.resolveIdentifiers=F,t.sanitizeUser=G,t.setUserId=Mr,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.browser.umd.min.js.map
